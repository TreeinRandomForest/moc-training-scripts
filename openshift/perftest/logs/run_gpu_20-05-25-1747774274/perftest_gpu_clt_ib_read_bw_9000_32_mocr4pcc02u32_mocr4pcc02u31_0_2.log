initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 5518, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
using DMA-BUF for GPU buffer address at 0x7efde0000000 aligned at 0x7efde0000000 with aligned size 536870912
allocated GPU buffer of a 536870912 address at 0x78b7e0 for type CUDA_MEM_DEVICE
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7efde0000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x05d0 PSN 0xf793fd
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05d1 PSN 0x62baa3
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05d2 PSN 0x6d6ab1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05d3 PSN 0xc412ac
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05d4 PSN 0x44314f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05d5 PSN 0xc24e05
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05d6 PSN 0x597780
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05d7 PSN 0x3a1d79
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05d8 PSN 0x941c29
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05d9 PSN 0xef50f7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05da PSN 0x6898cf
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05db PSN 0xe1cab6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05dc PSN 0x13c16a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05dd PSN 0x327fcf
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05de PSN 0xa7e9e1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05df PSN 0x548a91
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05e0 PSN 0x4dc0d2
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05e1 PSN 0x535d24
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05e2 PSN 0x403f2f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05e3 PSN 0xb589f0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05e4 PSN 0x43b491
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05e5 PSN 0xa3238c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05e6 PSN 0x2b6200
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05e7 PSN 0x606f08
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05e8 PSN 0xd7a769
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05e9 PSN 0xc5d180
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05ea PSN 0xd32ba1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05eb PSN 0x960d0f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05ec PSN 0xde8382
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05ed PSN 0x4cd15c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05ee PSN 0xb4da42
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x05ef PSN 0x3b6109
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05f0 PSN 0xcc7923
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05f1 PSN 0x66e308
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05f2 PSN 0x22e87c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05f3 PSN 0xbc90e4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05f4 PSN 0x8eb25e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05f5 PSN 0xcc4832
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05f6 PSN 0x62f773
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05f7 PSN 0xc776ba
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05f8 PSN 0x690fa0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05f9 PSN 0x95716b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05fa PSN 0xb31569
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05fb PSN 0xf9a77f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05fc PSN 0x6ee5c9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05fd PSN 0xcbe30b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05fe PSN 0xe585a3
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x05ff PSN 0xce9b61
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0600 PSN 0x983c99
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0601 PSN 0x3c67a8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0602 PSN 0x12c49a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0603 PSN 0x640748
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0604 PSN 0xc2963f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0605 PSN 0x4a01d9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0606 PSN 0x76c393
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0607 PSN 0x309969
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0608 PSN 0x826580
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0609 PSN 0xfef815
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x060a PSN 0xb803dc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x060b PSN 0x38acf8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x060c PSN 0x1d7c80
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x060d PSN 0x6f7cb9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x060e PSN 0xb2eba4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x060f PSN 0xd546fa
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.037775            0.036269            2.266801
 4          32000           0.068506            0.068180            2.130630
 8          32000            0.14               0.14   		     2.123210
 16         32000            0.27               0.27   		     2.122058
 32         32000            0.55               0.54   		     2.128751
 64         32000            1.26               1.24   		     2.424913
 128        32000            2.17               2.16   		     2.112741
 256        32000            4.37               4.32   		     2.109606
 512        32000            15.78              14.16  		     3.456979
 1024       32000            31.08              30.79  		     3.757990
 2048       32000            45.57              45.53  		     2.778651
 4096       32000            66.72              65.22  		     1.990349
 8192       32000            69.69              69.68  		     1.063199
 16384      32000            71.70              71.69  		     0.546940
 32768      32000            73.76              73.75  		     0.281325
 65536      32000            74.91              74.91  		     0.142871
 131072     32000            75.19              75.19  		     0.071703
 262144     32000            75.12              75.12  		     0.035818
 524288     32000            75.09              75.09  		     0.017902
 1048576    32000            74.92              74.92  		     0.008931
 2097152    32000            74.63              74.63  		     0.004448
 4194304    32000            74.71              74.71  		     0.002227
 8388608    32000            74.76              74.59  		     0.001111
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007efde0000000
destroying current CUDA Ctx
