initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 7672, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
using DMA-BUF for GPU buffer address at 0x7fc2e0000000 aligned at 0x7fc2e0000000 with aligned size 536870912
allocated GPU buffer of a 536870912 address at 0xd9a7e0 for type CUDA_MEM_DEVICE
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fc2e0000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0d5c PSN 0xb3c2da
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d5d PSN 0x593cbc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d5e PSN 0x514556
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d5f PSN 0x5468ed
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d60 PSN 0x2350fc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d61 PSN 0xb438ae
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d62 PSN 0xfa3775
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d63 PSN 0xfdf6ca
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d64 PSN 0xe269a6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d65 PSN 0x209d30
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d66 PSN 0x6d4314
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d67 PSN 0x744817
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d68 PSN 0x8449b7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d69 PSN 0x8db698
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d6a PSN 0x2d376
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d6b PSN 0x41dd02
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d6c PSN 0x9760ef
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d6d PSN 0x42977d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d6e PSN 0x940d14
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d6f PSN 0x7bf271
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d70 PSN 0x8e197e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d71 PSN 0x790a75
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d72 PSN 0x800935
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d73 PSN 0x813e99
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d74 PSN 0xf84e26
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d75 PSN 0xb69df9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d76 PSN 0x9af126
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d77 PSN 0xb6a4b0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d78 PSN 0x65b90f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d79 PSN 0xf74c65
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d7a PSN 0x215317
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0d7b PSN 0x5631ba
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d7c PSN 0xcfc7c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d7d PSN 0x7652b6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d7e PSN 0xea3cc8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d7f PSN 0xde3077
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d80 PSN 0x4b42be
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d81 PSN 0xc27448
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d82 PSN 0x8df407
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d83 PSN 0xe86cf4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d84 PSN 0x987588
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d85 PSN 0xa8b86a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d86 PSN 0x4ef6c6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d87 PSN 0x17b6e1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d88 PSN 0xdbf1b9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d89 PSN 0xaa0b72
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d8a PSN 0x46d048
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d8b PSN 0xf12e6c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d8c PSN 0x1a4711
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d8d PSN 0x191ff7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d8e PSN 0x1c506
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d8f PSN 0x8eb07b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d90 PSN 0x7dffc0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d91 PSN 0x55608f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d92 PSN 0xa40e47
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d93 PSN 0xfd9343
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d94 PSN 0xb11688
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d95 PSN 0xc3fbb3
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d96 PSN 0xf8f558
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d97 PSN 0x9b59fa
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d98 PSN 0xdf6591
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d99 PSN 0x9a8bbf
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d9a PSN 0x862869
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0d9b PSN 0x84b1a4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.061644            0.060684            3.792772
 4          32000            0.13               0.13   		     3.992738
 8          32000            0.26               0.26   		     3.990876
 16         32000            0.51               0.51   		     3.987623
 32         32000            1.02               1.02   		     3.985527
 64         32000            2.06               2.05   		     3.997097
 128        32000            4.11               4.09   		     3.991349
 256        32000            8.39               8.33   		     4.067785
 512        32000            16.79              16.70  		     4.078075
 1024       32000            33.39              33.28  		     4.062997
 2048       32000            64.34              59.47  		     3.629838
 4096       32000            91.93              87.08  		     2.657353
 8192       32000            94.28              94.21  		     1.437497
 16384      32000            98.89              98.89  		     0.754442
 32768      32000            103.71             103.71 		     0.395623
 65536      32000            105.32             105.31 		     0.200858
 131072     32000            107.12             107.12 		     0.102158
 262144     32000            107.23             107.23 		     0.051131
 524288     32000            107.14             107.14 		     0.025545
 1048576    32000            106.74             106.62 		     0.012710
 2097152    32000            105.18             104.69 		     0.006240
 4194304    32000            104.52             104.52 		     0.003115
 8388608    32000            104.64             104.49 		     0.001557
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fc2e0000000
destroying current CUDA Ctx
