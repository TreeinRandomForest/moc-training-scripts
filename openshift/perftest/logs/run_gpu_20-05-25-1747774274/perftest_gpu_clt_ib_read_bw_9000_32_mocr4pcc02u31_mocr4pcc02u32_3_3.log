initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 14036, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
using DMA-BUF for GPU buffer address at 0x7f0880000000 aligned at 0x7f0880000000 with aligned size 536870912
allocated GPU buffer of a 536870912 address at 0xddf7e0 for type CUDA_MEM_DEVICE
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f0880000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x2414 PSN 0x9c3e9a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2415 PSN 0x846d7c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2416 PSN 0x818716
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2417 PSN 0xf2e7ad
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2418 PSN 0x7fc8bc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2419 PSN 0xa9b56e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x241a PSN 0x94d535
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x241b PSN 0x8da18a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x241c PSN 0x769d66
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x241d PSN 0xb925f0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x241e PSN 0x3bfcd4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x241f PSN 0x5bded7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2420 PSN 0x8ff977
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2421 PSN 0x6e0b58
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2422 PSN 0xab6936
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2423 PSN 0x941fc2
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2424 PSN 0x964caf
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2425 PSN 0x9b783d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2426 PSN 0x583ed4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2427 PSN 0xb7a131
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2428 PSN 0xf8013e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2429 PSN 0xc73735
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x242a PSN 0xfd96f5
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x242b PSN 0x511959
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x242c PSN 0xf1e6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x242d PSN 0x82d6b9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x242e PSN 0x8b9ae6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x242f PSN 0xb16b70
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2430 PSN 0xbcd8cf
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2431 PSN 0x965125
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2432 PSN 0x1ad8d7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x2433 PSN 0xbea47a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2434 PSN 0xb92fa5
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2435 PSN 0x8af12b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2436 PSN 0xead299
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2437 PSN 0x63c074
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2438 PSN 0xc2df77
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2439 PSN 0xa650d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x243a PSN 0x1c75e8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x243b PSN 0xb1dfc1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x243c PSN 0x7e84d1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x243d PSN 0xa4d07f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x243e PSN 0xa415b7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x243f PSN 0x4e697e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2440 PSN 0x5b0c92
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2441 PSN 0xf36fd7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2442 PSN 0xd54d49
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2443 PSN 0xd74dd9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2444 PSN 0xcd967a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2445 PSN 0x9645ac
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2446 PSN 0x77117
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2447 PSN 0x3c39b8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2448 PSN 0xea3cb9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2449 PSN 0xbf0c94
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x244a PSN 0xcaca68
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x244b PSN 0xed5350
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x244c PSN 0x4d8a11
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x244d PSN 0x7a4308
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x244e PSN 0x7b289
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x244f PSN 0x7edd7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2450 PSN 0xaee8aa
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2451 PSN 0xc9d364
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2452 PSN 0x21e7aa
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x2453 PSN 0x958651
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.056426            0.056164            3.510265
 4          32000            0.12               0.12   		     3.647657
 8          32000            0.24               0.23   		     3.662121
 16         32000            0.47               0.47   		     3.663654
 32         32000            0.94               0.94   		     3.658067
 64         32000            1.88               1.87   		     3.644078
 128        32000            3.76               3.73   		     3.643796
 256        32000            7.50               7.10   		     3.465968
 512        32000            14.96              14.91  		     3.639892
 1024       32000            29.87              29.43  		     3.592071
 2048       32000            46.48              41.68  		     2.543960
 4096       32000            61.54              58.86  		     1.796260
 8192       32000            64.36              64.07  		     0.977643
 16384      32000            65.71              65.70  		     0.501267
 32768      32000            67.27              67.27  		     0.256608
 65536      32000            68.33              68.33  		     0.130334
 131072     32000            68.83              68.82  		     0.065636
 262144     32000            68.78              68.78  		     0.032795
 524288     32000            68.84              68.84  		     0.016414
 1048576    32000            68.02              67.98  		     0.008103
 2097152    32000            68.57              68.57  		     0.004087
 4194304    32000            68.58              68.50  		     0.002041
 8388608    32000            68.48              68.44  		     0.001020
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f0880000000
destroying current CUDA Ctx
