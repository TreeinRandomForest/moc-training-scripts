initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 7059, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
using DMA-BUF for GPU buffer address at 0x7f7400000000 aligned at 0x7f7400000000 with aligned size 536870912
allocated GPU buffer of a 536870912 address at 0x1daf7e0 for type CUDA_MEM_DEVICE
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f7400000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0b34 PSN 0x814e7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b35 PSN 0x6a4d7c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b36 PSN 0x2b73e0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b37 PSN 0xcbc278
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b38 PSN 0x1c662
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b39 PSN 0x7765e6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b3a PSN 0xde5517
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b3b PSN 0x9fad8e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b3c PSN 0x2adfe4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b3d PSN 0xe8365f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b3e PSN 0xd4294d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b3f PSN 0x1df793
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b40 PSN 0x46f64d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b41 PSN 0x51833f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b42 PSN 0xa973c7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b43 PSN 0x5f58b5
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b44 PSN 0xc2515d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b45 PSN 0x7f571c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b46 PSN 0xa4f0fe
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b47 PSN 0xb2c5dc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b48 PSN 0xf2b343
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b49 PSN 0x87f48d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b4a PSN 0xd4d237
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b4b PSN 0x942d3d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b4c PSN 0x28cec4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b4d PSN 0x1ce209
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b4e PSN 0x95d8c0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b4f PSN 0x212a0c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b50 PSN 0xeab604
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b51 PSN 0x2d91ed
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b52 PSN 0x9eaac8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0b53 PSN 0x20014e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b54 PSN 0x928542
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b55 PSN 0x31e63b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b56 PSN 0x771733
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b57 PSN 0x40decf
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b58 PSN 0x89016d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b59 PSN 0x3b6b95
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b5a PSN 0xc3fa9a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b5b PSN 0xded855
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b5c PSN 0xf2e09f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b5d PSN 0x1c87fe
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b5e PSN 0x3c400
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b5f PSN 0x63a7ca
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b60 PSN 0xf867b8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b61 PSN 0x68efce
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b62 PSN 0xff26aa
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b63 PSN 0xd8755c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b64 PSN 0x58e78
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b65 PSN 0xea9d9b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b66 PSN 0xbc0f11
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b67 PSN 0x13a5f3
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b68 PSN 0xbac70e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b69 PSN 0xa4c3fc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b6a PSN 0xcade7a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b6b PSN 0x1f97c4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b6c PSN 0xae743f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b6d PSN 0x14d968
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b6e PSN 0xfd8633
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b6f PSN 0x1f5603
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b70 PSN 0x57582f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b71 PSN 0xc5403c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b72 PSN 0xa2dc6b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0b73 PSN 0xc595b5
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.034318            0.033864            2.116490
 4          32000           0.070519            0.069882            2.183822
 8          32000            0.14               0.14   		     2.190131
 16         32000            0.28               0.28   		     2.183503
 32         32000            0.56               0.55   		     2.158416
 64         32000            1.13               1.12   		     2.189995
 128        32000            2.25               2.23   		     2.178795
 256        32000            4.50               4.48   		     2.186275
 512        32000            9.04               8.96   		     2.188330
 1024       32000            18.07              17.98  		     2.195042
 2048       32000            42.28              39.22  		     2.393986
 4096       32000            87.56              80.96  		     2.470743
 8192       32000            93.62              90.64  		     1.383100
 16384      32000            96.72              96.71  		     0.737836
 32768      32000            99.68              99.67  		     0.380201
 65536      32000            101.25             101.24 		     0.193105
 131072     32000            103.06             103.06 		     0.098284
 262144     32000            102.94             102.94 		     0.049086
 524288     32000            103.46             103.46 		     0.024666
 1048576    32000            103.65             103.65 		     0.012357
 2097152    32000            103.27             103.17 		     0.006149
 4194304    32000            102.90             102.86 		     0.003065
 8388608    32000            103.33             103.04 		     0.001535
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f7400000000
destroying current CUDA Ctx
