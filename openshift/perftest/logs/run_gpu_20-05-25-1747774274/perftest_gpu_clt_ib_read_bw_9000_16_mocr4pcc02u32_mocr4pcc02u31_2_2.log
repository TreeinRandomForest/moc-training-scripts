initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 7959, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
using DMA-BUF for GPU buffer address at 0x7f97ec000000 aligned at 0x7f97ec000000 with aligned size 268435456
allocated GPU buffer of a 268435456 address at 0x2229000 for type CUDA_MEM_DEVICE
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f97ec000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0e4e PSN 0xe15415
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e4f PSN 0x9f14db
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e50 PSN 0xce2489
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e51 PSN 0xb43a4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e52 PSN 0x32dae7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e53 PSN 0xdf13bd
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e54 PSN 0xdcf6d8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e55 PSN 0xc065f1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e56 PSN 0x7cc741
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e57 PSN 0xd7ba2f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e58 PSN 0x85b5a7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e59 PSN 0x5122ae
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e5a PSN 0x250602
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e5b PSN 0x4d4487
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e5c PSN 0x6afc39
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0e5d PSN 0xfe6a09
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e5e PSN 0x80c3ba
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e5f PSN 0xebdc1c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e60 PSN 0x6f6136
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e61 PSN 0xb1874d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e62 PSN 0x937fdc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e63 PSN 0x156e0e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e64 PSN 0xd23155
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e65 PSN 0xf29b2a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e66 PSN 0x3aa686
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e67 PSN 0xe3c890
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e68 PSN 0xfefaf4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e69 PSN 0x32d277
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e6a PSN 0x777497
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e6b PSN 0x1c37f8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e6c PSN 0x6c2956
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0e6d PSN 0xc2ad62
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.033582            0.032782            2.048884
 4          16000           0.067416            0.066940            2.091861
 8          16000            0.14               0.13   		     2.093931
 16         16000            0.27               0.27   		     2.096365
 32         16000            0.54               0.54   		     2.110965
 64         16000            1.08               1.07   		     2.094107
 128        16000            2.16               2.14   		     2.093194
 256        16000            4.33               4.30   		     2.098772
 512        16000            8.63               8.59   		     2.096625
 1024       16000            17.34              17.20  		     2.099884
 2048       16000            39.64              35.14  		     2.144626
 4096       16000            63.61              54.31  		     1.657492
 8192       16000            64.45              60.99  		     0.930579
 16384      16000            64.74              63.99  		     0.488171
 32768      16000            66.32              66.31  		     0.252964
 65536      16000            68.37              68.36  		     0.130390
 131072     16000            68.81              68.81  		     0.065619
 262144     16000            69.22              69.22  		     0.033006
 524288     16000            69.41              69.41  		     0.016550
 1048576    16000            69.40              69.40  		     0.008273
 2097152    16000            69.43              69.43  		     0.004138
 4194304    16000            69.46              69.46  		     0.002070
 8388608    16000            69.46              69.45  		     0.001035
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f97ec000000
destroying current CUDA Ctx
