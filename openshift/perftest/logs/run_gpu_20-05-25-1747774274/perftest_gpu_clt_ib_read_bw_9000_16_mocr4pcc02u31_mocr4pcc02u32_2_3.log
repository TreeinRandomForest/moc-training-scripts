initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 12769, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
using DMA-BUF for GPU buffer address at 0x7fb85a000000 aligned at 0x7fb85a000000 with aligned size 268435456
allocated GPU buffer of a 268435456 address at 0x12e2000 for type CUDA_MEM_DEVICE
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7fb85a000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1fa2 PSN 0x77703e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1fa3 PSN 0x185b87
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1fa4 PSN 0x9508f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1fa5 PSN 0xdbf2fb
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1fa6 PSN 0x402029
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1fa7 PSN 0x2069a1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1fa8 PSN 0x92edb6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1fa9 PSN 0x378341
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1faa PSN 0xd3af1b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1fab PSN 0xa7daca
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1fac PSN 0xc94cdc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1fad PSN 0x449576
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1fae PSN 0xd621f4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1faf PSN 0x73235a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1fb0 PSN 0xb6e146
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1fb1 PSN 0x8b11c8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fb2 PSN 0x761d79
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fb3 PSN 0x8f1fa6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fb4 PSN 0x62abc2
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fb5 PSN 0xdb99b2
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fb6 PSN 0x968614
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fb7 PSN 0x1ef0b0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fb8 PSN 0x1de919
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fb9 PSN 0x837e68
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fba PSN 0xc6a8b6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fbb PSN 0x4163c9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fbc PSN 0x51bb6f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fbd PSN 0x37bc0d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fbe PSN 0x3d3a3f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fbf PSN 0x4fdd49
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fc0 PSN 0x12c609
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1fc1 PSN 0xf6aacf
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.033457            0.033024            2.064005
 4          16000           0.067989            0.067753            2.117270
 8          16000            0.14               0.13   		     2.104889
 16         16000            0.48               0.48   		     3.732736
 32         16000            0.97               0.96   		     3.735176
 64         16000            1.94               1.92   		     3.747043
 128        16000            3.88               3.82   		     3.733921
 256        16000            7.76               7.64   		     3.730230
 512        16000            8.71               8.41   		     2.054427
 1024       16000            17.50              17.42  		     2.126025
 2048       16000            40.20              35.17  		     2.146808
 4096       16000            64.67              57.24  		     1.746927
 8192       16000            66.18              62.29  		     0.950457
 16384      16000            69.74              69.29  		     0.528634
 32768      16000            71.52              71.52  		     0.272814
 65536      16000            71.84              71.84  		     0.137017
 131072     16000            73.68              73.68  		     0.070270
 262144     16000            74.07              74.07  		     0.035317
 524288     16000            74.09              74.09  		     0.017664
 1048576    16000            74.21              74.21  		     0.008847
 2097152    16000            74.19              74.16  		     0.004420
 4194304    16000            74.52              74.52  		     0.002221
 8388608    16000            74.35              74.34  		     0.001108
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fb85a000000
destroying current CUDA Ctx
