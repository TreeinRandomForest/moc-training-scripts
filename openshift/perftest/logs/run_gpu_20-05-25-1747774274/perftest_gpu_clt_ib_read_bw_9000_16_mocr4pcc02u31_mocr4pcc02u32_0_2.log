initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 9959, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
using DMA-BUF for GPU buffer address at 0x7f7814000000 aligned at 0x7f7814000000 with aligned size 268435456
allocated GPU buffer of a 268435456 address at 0x1410000 for type CUDA_MEM_DEVICE
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f7814000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x15ee PSN 0x1e29f5
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15ef PSN 0x2d653b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15f0 PSN 0x1c9d69
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15f1 PSN 0x8dfb04
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15f2 PSN 0x1b2ec7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15f3 PSN 0xa60a1d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15f4 PSN 0x6e1db8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15f5 PSN 0xfb3351
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15f6 PSN 0x8a7921
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15f7 PSN 0xfbb68f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15f8 PSN 0x166a87
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15f9 PSN 0xef660e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15fa PSN 0x8ff5e2
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15fb PSN 0xd8a6e7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15fc PSN 0xa61f19
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x15fd PSN 0x18369
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x15fe PSN 0xbd8969
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x15ff PSN 0xbb419f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1600 PSN 0xb54bfd
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1601 PSN 0xd94808
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1602 PSN 0xc917b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1603 PSN 0xac8c1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1604 PSN 0xcaa18c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1605 PSN 0x3fcc95
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1606 PSN 0x22d315
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1607 PSN 0x9b3b73
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1608 PSN 0x96d79b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1609 PSN 0xdcf92
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x160a PSN 0xff7b16
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x160b PSN 0xf1160b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x160c PSN 0x17c96d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x160d PSN 0xde812d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.033272            0.032086            2.005357
 4          16000           0.066605            0.066254            2.070426
 8          16000            0.13               0.13   		     2.059752
 16         16000            0.27               0.26   		     2.068034
 32         16000            0.53               0.53   		     2.075938
 64         16000            1.06               1.05   		     2.052548
 128        16000            2.13               2.12   		     2.068006
 256        16000            4.23               4.19   		     2.043859
 512        16000            8.52               8.47   		     2.067352
 1024       16000            16.88              16.75  		     2.045105
 2048       16000            38.52              34.20  		     2.087642
 4096       16000            66.66              59.14  		     1.804891
 8192       16000            70.38              67.32  		     1.027188
 16384      16000            71.17              71.14  		     0.542780
 32768      16000            74.12              74.11  		     0.282702
 65536      16000            75.57              75.56  		     0.144124
 131072     16000            76.16              76.16  		     0.072629
 262144     16000            76.34              76.34  		     0.036404
 524288     16000            76.50              76.50  		     0.018238
 1048576    16000            76.47              76.47  		     0.009116
 2097152    16000            75.89              75.89  		     0.004524
 4194304    16000            76.34              76.34  		     0.002275
 8388608    16000            76.46              76.43  		     0.001139
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f7814000000
destroying current CUDA Ctx
