initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 5803, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
using DMA-BUF for GPU buffer address at 0x7f55e0000000 aligned at 0x7f55e0000000 with aligned size 268435456
allocated GPU buffer of a 268435456 address at 0x8e9000 for type CUDA_MEM_DEVICE
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f55e0000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x06c2 PSN 0x4ef0d7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06c3 PSN 0xf91f75
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06c4 PSN 0xa3041b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06c5 PSN 0x23a0ce
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06c6 PSN 0xfe41c9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06c7 PSN 0x40edf7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06c8 PSN 0xefd8a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06c9 PSN 0x292bbb
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06ca PSN 0x47a43
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06cb PSN 0x4abe09
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06cc PSN 0xec3579
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06cd PSN 0x643b18
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06ce PSN 0xeda724
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06cf PSN 0xd66c01
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06d0 PSN 0xc0672b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x06d1 PSN 0x8a5f13
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06d2 PSN 0x763a89
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06d3 PSN 0x16c3f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06d4 PSN 0x61321d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06d5 PSN 0x4b03a8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06d6 PSN 0x8b349b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06d7 PSN 0x4fd61
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06d8 PSN 0x1ac9ac
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06d9 PSN 0xeda235
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06da PSN 0x948835
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06db PSN 0x401a13
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06dc PSN 0x4d61bb
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06dd PSN 0x5f5f32
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06de PSN 0x436236
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06df PSN 0x13eab
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06e0 PSN 0xf8d58d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x06e1 PSN 0x156acd
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.058252            0.056692            3.543241
 4          16000            0.12               0.12   		     3.664018
 8          16000            0.24               0.24   		     3.678440
 16         16000            0.47               0.47   		     3.656366
 32         16000            0.95               0.94   		     3.671350
 64         16000            1.89               1.87   		     3.652318
 128        16000            3.78               3.76   		     3.675415
 256        16000            7.53               7.46   		     3.643767
 512        16000            15.06              14.94  		     3.647913
 1024       16000            29.07              28.60  		     3.490889
 2048       16000            57.96              46.01  		     2.808058
 4096       16000            65.65              58.77  		     1.793623
 8192       16000            68.07              64.92  		     0.990673
 16384      16000            71.44              71.21  		     0.543276
 32768      16000            74.56              74.55  		     0.284400
 65536      16000            75.63              75.63  		     0.144245
 131072     16000            75.98              75.98  		     0.072456
 262144     16000            76.31              76.31  		     0.036387
 524288     16000            76.59              76.59  		     0.018261
 1048576    16000            76.81              76.81  		     0.009156
 2097152    16000            76.52              76.51  		     0.004560
 4194304    16000            76.58              76.58  		     0.002282
 8388608    16000            76.79              76.68  		     0.001143
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f55e0000000
destroying current CUDA Ctx
