initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 11523, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
using DMA-BUF for GPU buffer address at 0x7f4c18000000 aligned at 0x7f4c18000000 with aligned size 268435456
allocated GPU buffer of a 268435456 address at 0x1f5e000 for type CUDA_MEM_DEVICE
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f4c18000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1b52 PSN 0x71f45
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b53 PSN 0xfa2b82
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b54 PSN 0x6e606e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b55 PSN 0xba0eee
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b56 PSN 0xf258a0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b57 PSN 0x715e4c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b58 PSN 0x80bc85
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b59 PSN 0x1a8b64
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b5a PSN 0x119802
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b5b PSN 0x378f25
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b5c PSN 0xe6d99b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b5d PSN 0x611cc9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b5e PSN 0x14524b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b5f PSN 0x8fe265
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b60 PSN 0xbc1af5
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1b61 PSN 0xebdb4b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b62 PSN 0x4c2575
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b63 PSN 0xb67abb
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b64 PSN 0xcbc4e9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b65 PSN 0x9ecc84
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b66 PSN 0x7d6247
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b67 PSN 0xbaf79d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b68 PSN 0xb83d38
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b69 PSN 0xd79cd1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b6a PSN 0x2c64a1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b6b PSN 0x81fc0f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b6c PSN 0xb30207
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b6d PSN 0xb8e78e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b6e PSN 0xb51962
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b6f PSN 0x8dc467
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b70 PSN 0x44ae99
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1b71 PSN 0x719ce9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.040444            0.039383            2.461412
 4          16000           0.070727            0.070301            2.196921
 8          16000            0.14               0.14   		     2.184208
 16         16000            0.28               0.28   		     2.170601
 32         16000            0.55               0.55   		     2.147767
 64         16000            1.30               1.29   		     2.525626
 128        16000            2.59               2.56   		     2.503293
 256        16000            4.48               4.46   		     2.179857
 512        16000            8.97               8.94   		     2.181789
 1024       16000            18.05              17.95  		     2.191355
 2048       16000            41.80              36.85  		     2.249074
 4096       16000            87.77              71.07  		     2.168994
 8192       16000            96.37              86.63  		     1.321917
 16384      16000            97.72              93.55  		     0.713725
 32768      16000            99.81              99.81  		     0.380733
 65536      16000            100.72             100.72 		     0.192109
 131072     16000            103.05             103.05 		     0.098275
 262144     16000            104.53             104.53 		     0.049843
 524288     16000            104.87             104.87 		     0.025003
 1048576    16000            104.57             104.36 		     0.012440
 2097152    16000            104.85             104.73 		     0.006242
 4194304    16000            104.78             104.78 		     0.003123
 8388608    16000            104.94             104.12 		     0.001552
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f4c18000000
destroying current CUDA Ctx
