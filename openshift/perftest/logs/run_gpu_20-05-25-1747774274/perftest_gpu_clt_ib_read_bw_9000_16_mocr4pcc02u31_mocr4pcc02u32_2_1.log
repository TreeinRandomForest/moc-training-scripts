initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 12147, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
using DMA-BUF for GPU buffer address at 0x7fc414000000 aligned at 0x7fc414000000 with aligned size 268435456
allocated GPU buffer of a 268435456 address at 0x833000 for type CUDA_MEM_DEVICE
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7fc414000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1d7a PSN 0xe2ea08
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d7b PSN 0x7eb289
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d7c PSN 0xa02869
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d7d PSN 0xfbb6cd
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d7e PSN 0x4d2c93
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d7f PSN 0x8deec3
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d80 PSN 0x292930
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d81 PSN 0x167233
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d82 PSN 0x84d825
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d83 PSN 0x2d500c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d84 PSN 0xcd85f6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d85 PSN 0x564188
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d86 PSN 0x8c919e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d87 PSN 0x2b6abc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d88 PSN 0xa75200
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x1d89 PSN 0xaa2cfa
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d8a PSN 0x9b7c75
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d8b PSN 0x1ef8f2
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d8c PSN 0xec791e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d8d PSN 0xd8b1de
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d8e PSN 0xa158d0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d8f PSN 0x5f92bc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d90 PSN 0x49b035
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d91 PSN 0xda6d54
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d92 PSN 0x26b32
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d93 PSN 0xbe9a95
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d94 PSN 0xed584b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d95 PSN 0x372db9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d96 PSN 0xb1287b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d97 PSN 0x634d5
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d98 PSN 0x6dd4a5
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x1d99 PSN 0xac0b3b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.056604            0.054246            3.390369
 4          16000            0.12               0.12   		     3.640526
 8          16000            0.24               0.23   		     3.644580
 16         16000            0.48               0.47   		     3.702572
 32         16000            0.96               0.92   		     3.604261
 64         16000            1.91               1.86   		     3.637364
 128        16000            3.82               3.79   		     3.696584
 256        16000            7.74               7.56   		     3.690173
 512        16000            15.52              15.25  		     3.723918
 1024       16000            16.71              16.18  		     1.975204
 2048       16000            40.96              35.56  		     2.170430
 4096       16000            70.08              65.38  		     1.995348
 8192       16000            101.90             93.96  		     1.433689
 16384      16000            104.10             102.44 		     0.781532
 32768      16000            106.48             106.48 		     0.406180
 65536      16000            109.71             109.71 		     0.209257
 131072     16000            110.82             110.82 		     0.105687
 262144     16000            111.50             111.50 		     0.053166
 524288     16000            111.94             111.94 		     0.026689
 1048576    16000            111.77             111.77 		     0.013324
 2097152    16000            111.22             111.22 		     0.006629
 4194304    16000            109.83             109.83 		     0.003273
 8388608    16000            109.94             109.88 		     0.001637
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fc414000000
destroying current CUDA Ctx
