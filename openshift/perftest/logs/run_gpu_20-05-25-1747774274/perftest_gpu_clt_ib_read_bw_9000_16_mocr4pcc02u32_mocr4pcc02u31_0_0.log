initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 4882, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
using DMA-BUF for GPU buffer address at 0x7f3838000000 aligned at 0x7f3838000000 with aligned size 268435456
allocated GPU buffer of a 268435456 address at 0x16e5000 for type CUDA_MEM_DEVICE
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f3838000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0386 PSN 0x14f258
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0387 PSN 0x8da962
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0388 PSN 0x48ac04
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0389 PSN 0x537503
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x038a PSN 0xdf3a5a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x038b PSN 0x909b4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x038c PSN 0x6a9b03
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x038d PSN 0x31ee40
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x038e PSN 0x1ecae4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x038f PSN 0x5bb896
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0390 PSN 0x3d9182
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0391 PSN 0x480ed
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0392 PSN 0x44c0d5
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0393 PSN 0x2d625e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0394 PSN 0xdadac4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 local address: LID 0000 QPN 0x0395 PSN 0xb50d38
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0396 PSN 0xc6bbc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0397 PSN 0x2c30f6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0398 PSN 0x75e08
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x0399 PSN 0x24d8b7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x039a PSN 0x8a65fe
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x039b PSN 0x4ff688
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x039c PSN 0xd3e947
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x039d PSN 0x95934
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x039e PSN 0xde8cc8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x039f PSN 0x641eaa
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x03a0 PSN 0xf70006
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x03a1 PSN 0xf32721
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x03a2 PSN 0x243cf9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x03a3 PSN 0xd95b2
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x03a4 PSN 0xde2d88
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
 remote address: LID 0000 QPN 0x03a5 PSN 0x2b62ac
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:226
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.039173            0.033820            2.113729
 4          16000           0.066421            0.065890            2.059048
 8          16000            0.13               0.13   		     2.061073
 16         16000            0.26               0.26   		     2.042121
 32         16000            0.53               0.53   		     2.055527
 64         16000            1.06               1.03   		     2.011668
 128        16000            2.11               2.10   		     2.050538
 256        16000            4.21               4.20   		     2.048944
 512        16000            8.42               8.39   		     2.049099
 1024       16000            16.82              16.77  		     2.047099
 2048       16000            33.82              33.68  		     2.055488
 4096       16000            67.82              67.44  		     2.058068
 8192       16000            134.79             134.47 		     2.051856
 16384      16000            165.86             165.81 		     1.265064
 32768      16000            166.99             166.96 		     0.636905
 65536      16000            166.73             166.73 		     0.318009
 131072     16000            167.47             167.46 		     0.159704
 262144     16000            166.96             166.96 		     0.079611
 524288     16000            166.92             166.92 		     0.039796
 1048576    16000            154.00             154.00 		     0.018358
 2097152    16000            146.66             146.56 		     0.008736
 4194304    16000            146.96             146.92 		     0.004379
 8388608    16000            146.98             146.86 		     0.002188
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f3838000000
destroying current CUDA Ctx
