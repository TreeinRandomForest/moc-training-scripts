initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 13703, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
using DMA-BUF for GPU buffer address at 0x7fd25c000000 aligned at 0x7fd25c000000 with aligned size 268435456
allocated GPU buffer of a 268435456 address at 0x6b9000 for type CUDA_MEM_DEVICE
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7fd25c000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x22de PSN 0x447a84
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22df PSN 0x289f55
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22e0 PSN 0xc94345
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22e1 PSN 0x6dce79
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22e2 PSN 0xb5c8cf
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22e3 PSN 0xc65c4f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22e4 PSN 0xab95cc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22e5 PSN 0x2d89f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22e6 PSN 0xc17c21
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22e7 PSN 0xa38a58
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22e8 PSN 0x94a052
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22e9 PSN 0x9b22b4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22ea PSN 0xbdf95a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22eb PSN 0xb77dc8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22ec PSN 0x78361c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 local address: LID 0000 QPN 0x22ed PSN 0x5c74e6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22ee PSN 0x5b0058
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22ef PSN 0xf59f62
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22f0 PSN 0x906a04
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22f1 PSN 0x935b03
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22f2 PSN 0xb8285a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22f3 PSN 0x3a5fb4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22f4 PSN 0xb03903
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22f5 PSN 0xca3440
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22f6 PSN 0xd898e4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22f7 PSN 0x8c6e96
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22f8 PSN 0x7f0f82
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22f9 PSN 0x1b26ed
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22fa PSN 0xd6ed5
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22fb PSN 0xf3785e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22fc PSN 0xf638c4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
 remote address: LID 0000 QPN 0x22fd PSN 0xd01338
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:03:225
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.054135            0.053317            3.332285
 4          16000            0.12               0.12   		     3.624657
 8          16000            0.23               0.23   		     3.621483
 16         16000            0.47               0.46   		     3.617651
 32         16000            0.94               0.93   		     3.646840
 64         16000            1.87               1.86   		     3.631585
 128        16000            3.75               3.72   		     3.628793
 256        16000            7.43               7.33   		     3.580588
 512        16000            14.94              14.84  		     3.623455
 1024       16000            16.61              15.84  		     1.933579
 2048       16000            39.26              34.89  		     2.129563
 4096       16000            66.01              55.60  		     1.696725
 8192       16000            67.70              65.26  		     0.995789
 16384      16000            69.87              69.56  		     0.530729
 32768      16000            72.38              72.38  		     0.276089
 65536      16000            73.22              73.22  		     0.139651
 131072     16000            73.99              73.99  		     0.070566
 262144     16000            73.93              73.93  		     0.035251
 524288     16000            74.31              74.31  		     0.017717
 1048576    16000            74.70              74.59  		     0.008892
 2097152    16000            74.52              74.47  		     0.004439
 4194304    16000            74.48              74.48  		     0.002220
 8388608    16000            74.62              74.52  		     0.001110
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fd25c000000
destroying current CUDA Ctx
