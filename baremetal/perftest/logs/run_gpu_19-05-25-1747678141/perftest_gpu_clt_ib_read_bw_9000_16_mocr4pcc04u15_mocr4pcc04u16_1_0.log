initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 22375, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f57ae000000 pointer=0x7f57ae000000
using DMA-BUF for GPU buffer address at 0x7f57ae000000 aligned at 0x7f57ae000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f57ae000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x04bd PSN 0x9a012c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04be PSN 0x6de4dd
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04bf PSN 0x200e2d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04c0 PSN 0x8ea341
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04c1 PSN 0x3c11f7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04c2 PSN 0x8d7257
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04c3 PSN 0x9b2734
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04c4 PSN 0x8731e7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04c5 PSN 0xb22fc9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04c6 PSN 0x68f8e0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04c7 PSN 0x52e03a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04c8 PSN 0xe6c87c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04c9 PSN 0x453f82
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04ca PSN 0x384cd0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04cb PSN 0xb18c84
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04cc PSN 0x47af2e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04bd PSN 0x590f34
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04be PSN 0x4b9b0e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04bf PSN 0xd91a40
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04c0 PSN 0x2c4c8f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04c1 PSN 0xeac8f6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04c2 PSN 0xe4ea20
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04c3 PSN 0x3a30ff
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04c4 PSN 0xa5328c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04c5 PSN 0x9f2740
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04c6 PSN 0xcdb3c2
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04c7 PSN 0xff0b3e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04c8 PSN 0x143df9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04c9 PSN 0xe106f1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04ca PSN 0x84644a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04cb PSN 0x30b440
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04cc PSN 0xf80f04
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.060600            0.058949            3.684310
 4          16000            0.12               0.12   		     3.853026
 8          16000            0.25               0.24   		     3.826150
 16         16000            0.49               0.49   		     3.828786
 32         16000            0.99               0.98   		     3.841592
 64         16000            1.98               1.96   		     3.831326
 128        16000            3.95               3.92   		     3.827101
 256        16000            7.88               7.83   		     3.825167
 512        16000            15.78              15.66  		     3.824055
 1024       16000            30.98              30.52  		     3.726008
 2048       16000            62.80              62.53  		     3.816776
 4096       16000            127.56             127.19 		     3.881394
 8192       16000            200.89             200.72 		     3.062754
 16384      16000            202.41             202.32 		     1.543585
 32768      16000            202.68             202.63 		     0.772975
 65536      16000            202.83             202.79 		     0.386799
 131072     16000            202.86             202.86 		     0.193459
 262144     16000            202.88             202.88 		     0.096739
 524288     16000            202.90             202.90 		     0.048375
 1048576    16000            202.93             202.93 		     0.024192
 2097152    16000            189.26             189.26 		     0.011280
 4194304    16000            169.83             169.83 		     0.005061
 8388608    16000            169.87             169.87 		     0.002531
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f57ae000000
destroying current CUDA Ctx
