initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 27258, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f12f0000000 pointer=0x7f12f0000000
using DMA-BUF for GPU buffer address at 0x7f12f0000000 aligned at 0x7f12f0000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f12f0000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0883 PSN 0xdc8f0f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0884 PSN 0xbcd4d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0885 PSN 0xe71913
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0886 PSN 0x975e66
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0887 PSN 0xbc8b81
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0888 PSN 0x21a14f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0889 PSN 0xfc6a02
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x088a PSN 0x542ad3
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x088b PSN 0xa2a77b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x088c PSN 0xe44ee1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x088d PSN 0x90f171
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x088e PSN 0x913b0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x088f PSN 0xd66fdc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0890 PSN 0xe93259
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0891 PSN 0x11eaa3
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0892 PSN 0xfd292b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0883 PSN 0xc5886f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0884 PSN 0xca3b2d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0885 PSN 0x332173
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0886 PSN 0xfd2f46
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0887 PSN 0x3fbae1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0888 PSN 0xd0d2f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0889 PSN 0xa49862
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x088a PSN 0x1a29b3
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x088b PSN 0x6d6cdb
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x088c PSN 0xe98c1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x088d PSN 0x71a5d1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x088e PSN 0x442090
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x088f PSN 0xc2b3c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0890 PSN 0xa23a39
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0891 PSN 0x6d8503
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0892 PSN 0x30240b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.030151            0.030001            1.875091
 4          16000           0.063492            0.063299            1.978083
 8          16000            0.13               0.13   		     1.978658
 16         16000            0.25               0.25   		     1.973654
 32         16000            0.51               0.50   		     1.970968
 64         16000            1.01               1.01   		     1.970630
 128        16000            2.02               2.01   		     1.967749
 256        16000            4.05               4.03   		     1.970191
 512        16000            8.06               8.03   		     1.960759
 1024       16000            16.10              16.07  		     1.962088
 2048       16000            37.73              33.55  		     2.047937
 4096       16000            74.55              60.60  		     1.849467
 8192       16000            72.57              64.21  		     0.979749
 16384      16000            76.62              72.29  		     0.551523
 32768      16000            79.33              77.97  		     0.297423
 65536      16000            80.99              80.63  		     0.153790
 131072     16000            82.70              82.70  		     0.078867
 262144     16000            83.35              83.35  		     0.039744
 524288     16000            83.07              83.07  		     0.019805
 1048576    16000            84.44              84.44  		     0.010067
 2097152    16000            84.59              84.59  		     0.005042
 4194304    16000            84.66              84.66  		     0.002523
 8388608    16000            84.68              84.68  		     0.001262
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f12f0000000
destroying current CUDA Ctx
