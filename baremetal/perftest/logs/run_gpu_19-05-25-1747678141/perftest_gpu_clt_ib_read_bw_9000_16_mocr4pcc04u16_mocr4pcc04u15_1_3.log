initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 36203, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f36d8000000 pointer=0x7f36d8000000
using DMA-BUF for GPU buffer address at 0x7f36d8000000 aligned at 0x7f36d8000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f36d8000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0eeb PSN 0xcfaea7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0eec PSN 0x12d105
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0eed PSN 0xdafe6b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0eee PSN 0x9d14de
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0eef PSN 0xbb0c99
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ef0 PSN 0x9a2887
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ef1 PSN 0x6a4cda
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ef2 PSN 0xbd0cb
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ef3 PSN 0x912213
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ef4 PSN 0xb31199
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ef5 PSN 0x2b29c9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ef6 PSN 0x722128
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ef7 PSN 0x4afbf4
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ef8 PSN 0x866891
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ef9 PSN 0x58507b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0efa PSN 0x969623
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0eea PSN 0x40909d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0eeb PSN 0xee0ac3
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0eec PSN 0x3b4851
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0eed PSN 0x92fcc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0eee PSN 0x5c57ef
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0eef PSN 0x3e8025
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ef0 PSN 0xc38f20
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ef1 PSN 0x1fec99
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ef2 PSN 0x40cc9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ef3 PSN 0x488517
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ef4 PSN 0xb88a6f
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ef5 PSN 0x816bd6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ef6 PSN 0x4e1c0a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ef7 PSN 0xf6d5ef
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ef8 PSN 0x215581
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ef9 PSN 0x391db1
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.030457            0.029805            1.862817
 4          16000           0.061069            0.060796            1.899861
 8          16000            0.12               0.12   		     1.901656
 16         16000            0.24               0.24   		     1.902108
 32         16000            0.49               0.49   		     1.913157
 64         16000            0.98               0.97   		     1.903108
 128        16000            1.96               1.95   		     1.905774
 256        16000            3.90               3.89   		     1.900475
 512        16000            7.80               7.78   		     1.898269
 1024       16000            15.45              15.34  		     1.872140
 2048       16000            36.50              32.23  		     1.966972
 4096       16000            72.00              60.55  		     1.847895
 8192       16000            72.78              65.44  		     0.998570
 16384      16000            76.18              73.07  		     0.557457
 32768      16000            79.47              78.21  		     0.298348
 65536      16000            81.37              81.37  		     0.155193
 131072     16000            82.33              82.33  		     0.078513
 262144     16000            83.78              83.78  		     0.039950
 524288     16000            84.30              84.30  		     0.020099
 1048576    16000            84.52              84.52  		     0.010075
 2097152    16000            84.57              84.57  		     0.005041
 4194304    16000            84.64              84.64  		     0.002522
 8388608    16000            84.67              84.59  		     0.001260
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f36d8000000
destroying current CUDA Ctx
