initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 35505, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f4a9e000000 pointer=0x7f4a9e000000
using DMA-BUF for GPU buffer address at 0x7f4a9e000000 aligned at 0x7f4a9e000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f4a9e000000, fd=58) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : ON
 Data ex. method : rdma_cm 	TOS    : 41
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0e61 PSN 0xa608e0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e62 PSN 0xf2714a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e63 PSN 0xac39cc
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e64 PSN 0x78832b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e65 PSN 0x3e3162
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e66 PSN 0xc9681c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e67 PSN 0x43d4b
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e68 PSN 0xc8b6e8
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e69 PSN 0x792a6c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e6a PSN 0xa957e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e6b PSN 0xa104a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e6c PSN 0x5e2c15
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e6d PSN 0x1890dd
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e6e PSN 0xa425c6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e6f PSN 0xdb7e0c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e70 PSN 0xd42e0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0e60 PSN 0xaf92fa
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e61 PSN 0xd9a5c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e62 PSN 0xbae276
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e63 PSN 0xf70f8d
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e64 PSN 0x98031c
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e65 PSN 0xecd04e
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e66 PSN 0xcc8695
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e67 PSN 0x20676a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e68 PSN 0x3c1dc6
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e69 PSN 0xa70ed0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e6a PSN 0x416434
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e6b PSN 0x922b7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e6c PSN 0xd11fd7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e6d PSN 0x25a238
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e6e PSN 0xe3e696
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e6f PSN 0xc5c1a2
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.031084            0.030444            1.902753
 4          16000           0.062392            0.062218            1.944310
 8          16000            0.12               0.12   		     1.937227
 16         16000            0.25               0.25   		     1.943259
 32         16000            0.50               0.50   		     1.939518
 64         16000            0.99               0.99   		     1.934813
 128        16000            1.99               1.98   		     1.934617
 256        16000            4.00               3.99   		     1.947923
 512        16000            7.98               7.96   		     1.942184
 1024       16000            15.75              15.61  		     1.905722
 2048       16000            37.16              32.89  		     2.007218
 4096       16000            73.51              60.97  		     1.860788
 8192       16000            72.78              64.14  		     0.978711
 16384      16000            75.81              68.96  		     0.526112
 32768      16000            79.60              78.84  		     0.300753
 65536      16000            81.06              81.06  		     0.154603
 131072     16000            82.43              82.43  		     0.078611
 262144     16000            83.85              83.85  		     0.039980
 524288     16000            84.20              84.20  		     0.020074
 1048576    16000            84.48              84.48  		     0.010070
 2097152    16000            84.57              84.57  		     0.005041
 4194304    16000            84.67              84.67  		     0.002523
 8388608    16000            84.69              84.69  		     0.001262
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f4a9e000000
destroying current CUDA Ctx
