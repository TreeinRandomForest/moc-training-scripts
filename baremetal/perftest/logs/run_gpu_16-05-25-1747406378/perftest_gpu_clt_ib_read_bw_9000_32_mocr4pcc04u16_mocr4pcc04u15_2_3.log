initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 64918, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007efd80000000 pointer=0x7efd80000000
using DMA-BUF for GPU buffer address at 0x7efd80000000 aligned at 0x7efd80000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7efd80000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x237c PSN 0x920619 OUT 0x10 RKey 0x183000 VAddr 0x007efd90000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x237d PSN 0x7a788f OUT 0x10 RKey 0x183000 VAddr 0x007efd90800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x237e PSN 0xbb502d OUT 0x10 RKey 0x183000 VAddr 0x007efd91000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x237f PSN 0x6c3078 OUT 0x10 RKey 0x183000 VAddr 0x007efd91800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2380 PSN 0xae292b OUT 0x10 RKey 0x183000 VAddr 0x007efd92000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2381 PSN 0x607eb1 OUT 0x10 RKey 0x183000 VAddr 0x007efd92800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2382 PSN 0xfeb8bc OUT 0x10 RKey 0x183000 VAddr 0x007efd93000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2383 PSN 0x82cc05 OUT 0x10 RKey 0x183000 VAddr 0x007efd93800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2384 PSN 0x6835c5 OUT 0x10 RKey 0x183000 VAddr 0x007efd94000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2385 PSN 0x106063 OUT 0x10 RKey 0x183000 VAddr 0x007efd94800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2386 PSN 0xe731cb OUT 0x10 RKey 0x183000 VAddr 0x007efd95000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2387 PSN 0x8b5602 OUT 0x10 RKey 0x183000 VAddr 0x007efd95800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2388 PSN 0x7a58c6 OUT 0x10 RKey 0x183000 VAddr 0x007efd96000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2389 PSN 0xad99fb OUT 0x10 RKey 0x183000 VAddr 0x007efd96800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x238a PSN 0x25969d OUT 0x10 RKey 0x183000 VAddr 0x007efd97000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x238b PSN 0x57fe9d OUT 0x10 RKey 0x183000 VAddr 0x007efd97800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x238c PSN 0x18f1ee OUT 0x10 RKey 0x183000 VAddr 0x007efd98000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x238d PSN 0xc66e10 OUT 0x10 RKey 0x183000 VAddr 0x007efd98800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x238e PSN 0x27bab OUT 0x10 RKey 0x183000 VAddr 0x007efd99000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x238f PSN 0x10b2bc OUT 0x10 RKey 0x183000 VAddr 0x007efd99800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2390 PSN 0xcb5b6d OUT 0x10 RKey 0x183000 VAddr 0x007efd9a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2391 PSN 0x1ed738 OUT 0x10 RKey 0x183000 VAddr 0x007efd9a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2392 PSN 0xd36a3c OUT 0x10 RKey 0x183000 VAddr 0x007efd9b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2393 PSN 0xa1d894 OUT 0x10 RKey 0x183000 VAddr 0x007efd9b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2394 PSN 0x956005 OUT 0x10 RKey 0x183000 VAddr 0x007efd9c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2395 PSN 0x3993ec OUT 0x10 RKey 0x183000 VAddr 0x007efd9c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2396 PSN 0x59fb9d OUT 0x10 RKey 0x183000 VAddr 0x007efd9d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2397 PSN 0x29035b OUT 0x10 RKey 0x183000 VAddr 0x007efd9d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2398 PSN 0xc9a9de OUT 0x10 RKey 0x183000 VAddr 0x007efd9e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2399 PSN 0xb2ce88 OUT 0x10 RKey 0x183000 VAddr 0x007efd9e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x239a PSN 0x272dfe OUT 0x10 RKey 0x183000 VAddr 0x007efd9f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x239b PSN 0x73f015 OUT 0x10 RKey 0x183000 VAddr 0x007efd9f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x237c PSN 0xffec6c OUT 0x10 RKey 0x183100 VAddr 0x007f9470000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x237d PSN 0x2e8f1d OUT 0x10 RKey 0x183100 VAddr 0x007f9470800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x237e PSN 0x1e0b6d OUT 0x10 RKey 0x183100 VAddr 0x007f9471000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x237f PSN 0x3af781 OUT 0x10 RKey 0x183100 VAddr 0x007f9471800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2380 PSN 0x4d7137 OUT 0x10 RKey 0x183100 VAddr 0x007f9472000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2381 PSN 0x868097 OUT 0x10 RKey 0x183100 VAddr 0x007f9472800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2382 PSN 0x73b874 OUT 0x10 RKey 0x183100 VAddr 0x007f9473000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2383 PSN 0x3c8a27 OUT 0x10 RKey 0x183100 VAddr 0x007f9473800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2384 PSN 0x324309 OUT 0x10 RKey 0x183100 VAddr 0x007f9474000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2385 PSN 0x3cab20 OUT 0x10 RKey 0x183100 VAddr 0x007f9474800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2386 PSN 0x9b457a OUT 0x10 RKey 0x183100 VAddr 0x007f9475000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2387 PSN 0xb164bc OUT 0x10 RKey 0x183100 VAddr 0x007f9475800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2388 PSN 0xeb46c2 OUT 0x10 RKey 0x183100 VAddr 0x007f9476000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2389 PSN 0x6ce310 OUT 0x10 RKey 0x183100 VAddr 0x007f9476800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x238a PSN 0x1305c4 OUT 0x10 RKey 0x183100 VAddr 0x007f9477000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x238b PSN 0xb7cf6e OUT 0x10 RKey 0x183100 VAddr 0x007f9477800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x238c PSN 0xa31422 OUT 0x10 RKey 0x183100 VAddr 0x007f9478000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x238d PSN 0xcb42fd OUT 0x10 RKey 0x183100 VAddr 0x007f9478800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x238e PSN 0x5085cb OUT 0x10 RKey 0x183100 VAddr 0x007f9479000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x238f PSN 0x6d4f25 OUT 0x10 RKey 0x183100 VAddr 0x007f9479800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2390 PSN 0x2bd58 OUT 0x10 RKey 0x183100 VAddr 0x007f947a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2391 PSN 0xc71d7e OUT 0x10 RKey 0x183100 VAddr 0x007f947a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2392 PSN 0xadc6d4 OUT 0x10 RKey 0x183100 VAddr 0x007f947b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2393 PSN 0x756216 OUT 0x10 RKey 0x183100 VAddr 0x007f947b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2394 PSN 0x934529 OUT 0x10 RKey 0x183100 VAddr 0x007f947c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2395 PSN 0xec090a OUT 0x10 RKey 0x183100 VAddr 0x007f947c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2396 PSN 0xc05a2d OUT 0x10 RKey 0x183100 VAddr 0x007f947d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2397 PSN 0xfe3375 OUT 0x10 RKey 0x183100 VAddr 0x007f947d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2398 PSN 0x480db9 OUT 0x10 RKey 0x183100 VAddr 0x007f947e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2399 PSN 0x9487fe OUT 0x10 RKey 0x183100 VAddr 0x007f947e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x239a PSN 0x34b605 OUT 0x10 RKey 0x183100 VAddr 0x007f947f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x239b PSN 0x579847 OUT 0x10 RKey 0x183100 VAddr 0x007f947f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.055556            0.055311            3.456915
 4          32000            0.11               0.11   		     3.515541
 8          32000            0.23               0.22   		     3.512303
 16         32000            0.45               0.45   		     3.505102
 32         32000            0.90               0.90   		     3.521503
 64         32000            1.81               1.80   		     3.516553
 128        32000            3.61               3.60   		     3.517067
 256        32000            7.19               7.16   		     3.496832
 512        32000            14.49              14.44  		     3.525642
 1024       32000            28.94              28.81  		     3.516410
 2048       32000            56.71              56.42  		     3.443571
 4096       32000            115.02             90.65  		     2.766472
 8192       32000            180.71             137.43 		     2.097039
 16384      32000            197.93             197.80 		     1.509104
 32768      32000            196.94             196.89 		     0.751057
 65536      32000            197.83             197.82 		     0.377305
 131072     32000            197.70             197.69 		     0.188529
 262144     32000            195.57             195.57 		     0.093256
 524288     32000            196.64             196.64 		     0.046881
 1048576    32000            178.26             178.26 		     0.021250
 2097152    32000            163.78             163.78 		     0.009762
 4194304    32000            163.83             163.83 		     0.004882
 8388608    32000            163.77             163.77 		     0.002440
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007efd80000000
destroying current CUDA Ctx
