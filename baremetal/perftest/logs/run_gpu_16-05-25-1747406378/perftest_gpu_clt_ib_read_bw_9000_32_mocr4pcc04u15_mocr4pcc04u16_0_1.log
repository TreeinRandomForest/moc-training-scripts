initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 46066, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f9340000000 pointer=0x7f9340000000
using DMA-BUF for GPU buffer address at 0x7f9340000000 aligned at 0x7f9340000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f9340000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x16b0 PSN 0x4c9bae OUT 0x10 RKey 0x183100 VAddr 0x007f9350000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16b1 PSN 0xac0700 OUT 0x10 RKey 0x183100 VAddr 0x007f9350800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16b2 PSN 0xfa7c4a OUT 0x10 RKey 0x183100 VAddr 0x007f9351000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16b3 PSN 0xb006d1 OUT 0x10 RKey 0x183100 VAddr 0x007f9351800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16b4 PSN 0x306310 OUT 0x10 RKey 0x183100 VAddr 0x007f9352000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16b5 PSN 0xf2e332 OUT 0x10 RKey 0x183100 VAddr 0x007f9352800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16b6 PSN 0x8b69a9 OUT 0x10 RKey 0x183100 VAddr 0x007f9353000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16b7 PSN 0xdb0eee OUT 0x10 RKey 0x183100 VAddr 0x007f9353800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16b8 PSN 0xe608fa OUT 0x10 RKey 0x183100 VAddr 0x007f9354000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16b9 PSN 0x40ebf4 OUT 0x10 RKey 0x183100 VAddr 0x007f9354800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16ba PSN 0xa2e488 OUT 0x10 RKey 0x183100 VAddr 0x007f9355000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16bb PSN 0x483e7b OUT 0x10 RKey 0x183100 VAddr 0x007f9355800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16bc PSN 0x520a4b OUT 0x10 RKey 0x183100 VAddr 0x007f9356000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16bd PSN 0x9dad9c OUT 0x10 RKey 0x183100 VAddr 0x007f9356800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16be PSN 0x6c982a OUT 0x10 RKey 0x183100 VAddr 0x007f9357000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16bf PSN 0xf455a6 OUT 0x10 RKey 0x183100 VAddr 0x007f9357800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16c0 PSN 0x2816c3 OUT 0x10 RKey 0x183100 VAddr 0x007f9358000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16c1 PSN 0xac7ac1 OUT 0x10 RKey 0x183100 VAddr 0x007f9358800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16c2 PSN 0x88e908 OUT 0x10 RKey 0x183100 VAddr 0x007f9359000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16c3 PSN 0x4ad155 OUT 0x10 RKey 0x183100 VAddr 0x007f9359800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16c4 PSN 0x13d892 OUT 0x10 RKey 0x183100 VAddr 0x007f935a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16c5 PSN 0x875df9 OUT 0x10 RKey 0x183100 VAddr 0x007f935a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16c6 PSN 0x523069 OUT 0x10 RKey 0x183100 VAddr 0x007f935b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16c7 PSN 0x24a7bd OUT 0x10 RKey 0x183100 VAddr 0x007f935b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16c8 PSN 0x326a7a OUT 0x10 RKey 0x183100 VAddr 0x007f935c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16c9 PSN 0x5825bd OUT 0x10 RKey 0x183100 VAddr 0x007f935c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16ca PSN 0xbd79a OUT 0x10 RKey 0x183100 VAddr 0x007f935d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16cb PSN 0xc4fc14 OUT 0x10 RKey 0x183100 VAddr 0x007f935d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16cc PSN 0x34c6a3 OUT 0x10 RKey 0x183100 VAddr 0x007f935e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16cd PSN 0xc30c69 OUT 0x10 RKey 0x183100 VAddr 0x007f935e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16ce PSN 0x15accb OUT 0x10 RKey 0x183100 VAddr 0x007f935f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x16cf PSN 0xe81b5e OUT 0x10 RKey 0x183100 VAddr 0x007f935f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x16b0 PSN 0x8a046e OUT 0x10 RKey 0x183000 VAddr 0x007fb070000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16b1 PSN 0xee20c0 OUT 0x10 RKey 0x183000 VAddr 0x007fb070800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16b2 PSN 0x41f30a OUT 0x10 RKey 0x183000 VAddr 0x007fb071000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16b3 PSN 0xce1691 OUT 0x10 RKey 0x183000 VAddr 0x007fb071800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16b4 PSN 0x2397d0 OUT 0x10 RKey 0x183000 VAddr 0x007fb072000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16b5 PSN 0xe4d8f2 OUT 0x10 RKey 0x183000 VAddr 0x007fb072800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16b6 PSN 0x5b8c69 OUT 0x10 RKey 0x183000 VAddr 0x007fb073000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16b7 PSN 0xb25aae OUT 0x10 RKey 0x183000 VAddr 0x007fb073800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16b8 PSN 0x9fc9ba OUT 0x10 RKey 0x183000 VAddr 0x007fb074000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16b9 PSN 0x847db4 OUT 0x10 RKey 0x183000 VAddr 0x007fb074800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16ba PSN 0x5a7348 OUT 0x10 RKey 0x183000 VAddr 0x007fb075000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16bb PSN 0xb0863b OUT 0x10 RKey 0x183000 VAddr 0x007fb075800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16bc PSN 0x2f170b OUT 0x10 RKey 0x183000 VAddr 0x007fb076000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16bd PSN 0x309b5c OUT 0x10 RKey 0x183000 VAddr 0x007fb076800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16be PSN 0x9652ea OUT 0x10 RKey 0x183000 VAddr 0x007fb077000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16bf PSN 0x815966 OUT 0x10 RKey 0x183000 VAddr 0x007fb077800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16c0 PSN 0x912f83 OUT 0x10 RKey 0x183000 VAddr 0x007fb078000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16c1 PSN 0xa88481 OUT 0x10 RKey 0x183000 VAddr 0x007fb078800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16c2 PSN 0x9b8fc8 OUT 0x10 RKey 0x183000 VAddr 0x007fb079000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16c3 PSN 0xc5115 OUT 0x10 RKey 0x183000 VAddr 0x007fb079800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16c4 PSN 0x3dbd52 OUT 0x10 RKey 0x183000 VAddr 0x007fb07a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16c5 PSN 0xe243b9 OUT 0x10 RKey 0x183000 VAddr 0x007fb07a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16c6 PSN 0x708329 OUT 0x10 RKey 0x183000 VAddr 0x007fb07b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16c7 PSN 0x66637d OUT 0x10 RKey 0x183000 VAddr 0x007fb07b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16c8 PSN 0xdddb3a OUT 0x10 RKey 0x183000 VAddr 0x007fb07c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16c9 PSN 0xa3a77d OUT 0x10 RKey 0x183000 VAddr 0x007fb07c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16ca PSN 0xc4965a OUT 0x10 RKey 0x183000 VAddr 0x007fb07d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16cb PSN 0xceb3d4 OUT 0x10 RKey 0x183000 VAddr 0x007fb07d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16cc PSN 0x6e8363 OUT 0x10 RKey 0x183000 VAddr 0x007fb07e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16cd PSN 0xecea29 OUT 0x10 RKey 0x183000 VAddr 0x007fb07e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16ce PSN 0x23978b OUT 0x10 RKey 0x183000 VAddr 0x007fb07f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x16cf PSN 0xbd8f1e OUT 0x10 RKey 0x183000 VAddr 0x007fb07f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.057508            0.057303            3.581413
 4          32000            0.12               0.12   		     3.642904
 8          32000            0.23               0.23   		     3.632488
 16         32000            0.47               0.47   		     3.639254
 32         32000            0.94               0.93   		     3.629908
 64         32000            1.88               1.87   		     3.647892
 128        32000            3.76               3.75   		     3.663868
 256        32000            7.55               7.52   		     3.673537
 512        32000            15.23              15.21  		     3.712999
 1024       32000            30.52              30.45  		     3.716462
 2048       32000            61.44              61.38  		     3.746603
 4096       32000            128.22             127.51 		     3.891282
 8192       32000            208.27             208.18 		     3.176649
 16384      32000            209.01             208.97 		     1.594327
 32768      32000            208.94             208.92 		     0.796975
 65536      32000            209.04             209.03 		     0.398684
 131072     32000            209.18             209.17 		     0.199477
 262144     32000            208.86             208.86 		     0.099593
 524288     32000            209.26             209.26 		     0.049892
 1048576    32000            186.58             186.58 		     0.022242
 2097152    32000            171.28             171.28 		     0.010209
 4194304    32000            171.24             171.24 		     0.005103
 8388608    32000            171.21             171.21 		     0.002551
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f9340000000
destroying current CUDA Ctx
