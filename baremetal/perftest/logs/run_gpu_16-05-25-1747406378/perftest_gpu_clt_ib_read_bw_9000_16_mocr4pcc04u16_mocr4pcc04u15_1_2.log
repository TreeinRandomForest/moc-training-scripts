initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 61442, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f3644000000 pointer=0x7f3644000000
using DMA-BUF for GPU buffer address at 0x7f3644000000 aligned at 0x7f3644000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f3644000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x20f6 PSN 0x9e019b OUT 0x10 RKey 0x182f00 VAddr 0x007f364c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x20f7 PSN 0x635ae9 OUT 0x10 RKey 0x182f00 VAddr 0x007f364c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x20f8 PSN 0x388c7f OUT 0x10 RKey 0x182f00 VAddr 0x007f364d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x20f9 PSN 0x888b62 OUT 0x10 RKey 0x182f00 VAddr 0x007f364d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x20fa PSN 0x271acd OUT 0x10 RKey 0x182f00 VAddr 0x007f364e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x20fb PSN 0x4eecab OUT 0x10 RKey 0x182f00 VAddr 0x007f364e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x20fc PSN 0xca282e OUT 0x10 RKey 0x182f00 VAddr 0x007f364f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x20fd PSN 0x59ab8f OUT 0x10 RKey 0x182f00 VAddr 0x007f364f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x20fe PSN 0xf35f87 OUT 0x10 RKey 0x182f00 VAddr 0x007f3650000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x20ff PSN 0xad73fd OUT 0x10 RKey 0x182f00 VAddr 0x007f3650800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2100 PSN 0x5ce65d OUT 0x10 RKey 0x182f00 VAddr 0x007f3651000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2101 PSN 0x7c642c OUT 0x10 RKey 0x182f00 VAddr 0x007f3651800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2102 PSN 0x8f1ca8 OUT 0x10 RKey 0x182f00 VAddr 0x007f3652000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2103 PSN 0xda0d35 OUT 0x10 RKey 0x182f00 VAddr 0x007f3652800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2104 PSN 0x10c24f OUT 0x10 RKey 0x182f00 VAddr 0x007f3653000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2105 PSN 0xd38567 OUT 0x10 RKey 0x182f00 VAddr 0x007f3653800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x20f6 PSN 0xf34dc1 OUT 0x10 RKey 0x183000 VAddr 0x007f2ed8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x20f7 PSN 0x26eb17 OUT 0x10 RKey 0x183000 VAddr 0x007f2ed8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x20f8 PSN 0x6e4415 OUT 0x10 RKey 0x183000 VAddr 0x007f2ed9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x20f9 PSN 0xa07a40 OUT 0x10 RKey 0x183000 VAddr 0x007f2ed9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x20fa PSN 0x9b4353 OUT 0x10 RKey 0x183000 VAddr 0x007f2eda000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x20fb PSN 0xb491b9 OUT 0x10 RKey 0x183000 VAddr 0x007f2eda800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x20fc PSN 0x440324 OUT 0x10 RKey 0x183000 VAddr 0x007f2edb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x20fd PSN 0xbcea4d OUT 0x10 RKey 0x183000 VAddr 0x007f2edb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x20fe PSN 0xbbca6d OUT 0x10 RKey 0x183000 VAddr 0x007f2edc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x20ff PSN 0x159beb OUT 0x10 RKey 0x183000 VAddr 0x007f2edc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2100 PSN 0xfdbab3 OUT 0x10 RKey 0x183000 VAddr 0x007f2edd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2101 PSN 0x410ca OUT 0x10 RKey 0x183000 VAddr 0x007f2edd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2102 PSN 0x118fee OUT 0x10 RKey 0x183000 VAddr 0x007f2ede000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2103 PSN 0x7e0603 OUT 0x10 RKey 0x183000 VAddr 0x007f2ede800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2104 PSN 0x52c605 OUT 0x10 RKey 0x183000 VAddr 0x007f2edf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2105 PSN 0xc9de5 OUT 0x10 RKey 0x183000 VAddr 0x007f2edf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.056250            0.055221            3.451318
 4          16000            0.11               0.11   		     3.537678
 8          16000            0.23               0.23   		     3.523950
 16         16000            0.46               0.45   		     3.549395
 32         16000            0.91               0.91   		     3.539353
 64         16000            1.82               1.82   		     3.550640
 128        16000            3.63               3.63   		     3.540340
 256        16000            7.29               7.27   		     3.551003
 512        16000            14.51              14.51  		     3.541601
 1024       16000            29.07              28.98  		     3.537929
 2048       16000            57.33              56.97  		     3.476991
 4096       16000            116.47             116.37 		     3.551396
 8192       16000            200.62             200.37 		     3.057409
 16384      16000            200.62             200.56 		     1.530137
 32768      16000            201.03             200.99 		     0.766719
 65536      16000            202.41             202.38 		     0.386005
 131072     16000            202.44             202.43 		     0.193054
 262144     16000            201.99             201.99 		     0.096315
 524288     16000            199.15             199.15 		     0.047480
 1048576    16000            199.93             199.93 		     0.023834
 2097152    16000            187.57             187.56 		     0.011180
 4194304    16000            169.00             167.11 		     0.004980
 8388608    16000            167.66             166.85 		     0.002486
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f3644000000
destroying current CUDA Ctx
