initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 49639, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f4960000000 pointer=0x7f4960000000
using DMA-BUF for GPU buffer address at 0x7f4960000000 aligned at 0x7f4960000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f4960000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1926 PSN 0xc8805e OUT 0x10 RKey 0x183100 VAddr 0x007f4970000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1927 PSN 0x2285f0 OUT 0x10 RKey 0x183100 VAddr 0x007f4970800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1928 PSN 0xba287a OUT 0x10 RKey 0x183100 VAddr 0x007f4971000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1929 PSN 0x3f7741 OUT 0x10 RKey 0x183100 VAddr 0x007f4971800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x192a PSN 0x87e2c0 OUT 0x10 RKey 0x183100 VAddr 0x007f4972000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x192b PSN 0x2c6122 OUT 0x10 RKey 0x183100 VAddr 0x007f4972800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x192c PSN 0x6ba8d9 OUT 0x10 RKey 0x183100 VAddr 0x007f4973000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x192d PSN 0x5b165e OUT 0x10 RKey 0x183100 VAddr 0x007f4973800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x192e PSN 0x57d3aa OUT 0x10 RKey 0x183100 VAddr 0x007f4974000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x192f PSN 0xe58e4 OUT 0x10 RKey 0x183100 VAddr 0x007f4974800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1930 PSN 0x39e6b8 OUT 0x10 RKey 0x183100 VAddr 0x007f4975000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1931 PSN 0xcb4ceb OUT 0x10 RKey 0x183100 VAddr 0x007f4975800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1932 PSN 0x57cffb OUT 0x10 RKey 0x183100 VAddr 0x007f4976000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1933 PSN 0xeef98c OUT 0x10 RKey 0x183100 VAddr 0x007f4976800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1934 PSN 0x838d5a OUT 0x10 RKey 0x183100 VAddr 0x007f4977000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1935 PSN 0x43db16 OUT 0x10 RKey 0x183100 VAddr 0x007f4977800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1936 PSN 0x268773 OUT 0x10 RKey 0x183100 VAddr 0x007f4978000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1937 PSN 0x8095b1 OUT 0x10 RKey 0x183100 VAddr 0x007f4978800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1938 PSN 0x4c0138 OUT 0x10 RKey 0x183100 VAddr 0x007f4979000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1939 PSN 0x573dc5 OUT 0x10 RKey 0x183100 VAddr 0x007f4979800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x193a PSN 0xaa442 OUT 0x10 RKey 0x183100 VAddr 0x007f497a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x193b PSN 0xdc37e9 OUT 0x10 RKey 0x183100 VAddr 0x007f497a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x193c PSN 0x809b99 OUT 0x10 RKey 0x183100 VAddr 0x007f497b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x193d PSN 0x756b2d OUT 0x10 RKey 0x183100 VAddr 0x007f497b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x193e PSN 0x6c412a OUT 0x10 RKey 0x183100 VAddr 0x007f497c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x193f PSN 0x1aaead OUT 0x10 RKey 0x183100 VAddr 0x007f497c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1940 PSN 0x27c5ca OUT 0x10 RKey 0x183100 VAddr 0x007f497d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1941 PSN 0xe88684 OUT 0x10 RKey 0x183100 VAddr 0x007f497d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1942 PSN 0xf75853 OUT 0x10 RKey 0x183100 VAddr 0x007f497e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1943 PSN 0xbf3459 OUT 0x10 RKey 0x183100 VAddr 0x007f497e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1944 PSN 0x944dfb OUT 0x10 RKey 0x183100 VAddr 0x007f497f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1945 PSN 0xe3dcce OUT 0x10 RKey 0x183100 VAddr 0x007f497f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1926 PSN 0xa87f9e OUT 0x10 RKey 0x183000 VAddr 0x007ff050000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1927 PSN 0xd5b430 OUT 0x10 RKey 0x183000 VAddr 0x007ff050800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1928 PSN 0x9259ba OUT 0x10 RKey 0x183000 VAddr 0x007ff051000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1929 PSN 0x8bef81 OUT 0x10 RKey 0x183000 VAddr 0x007ff051800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x192a PSN 0x209600 OUT 0x10 RKey 0x183000 VAddr 0x007ff052000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x192b PSN 0x3c3362 OUT 0x10 RKey 0x183000 VAddr 0x007ff052800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x192c PSN 0xdae19 OUT 0x10 RKey 0x183000 VAddr 0x007ff053000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x192d PSN 0xed29e OUT 0x10 RKey 0x183000 VAddr 0x007ff053800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x192e PSN 0x7aea OUT 0x10 RKey 0x183000 VAddr 0x007ff054000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x192f PSN 0x210f24 OUT 0x10 RKey 0x183000 VAddr 0x007ff054800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1930 PSN 0xeefff8 OUT 0x10 RKey 0x183000 VAddr 0x007ff055000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1931 PSN 0x968d2b OUT 0x10 RKey 0x183000 VAddr 0x007ff055800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1932 PSN 0x9bab3b OUT 0x10 RKey 0x183000 VAddr 0x007ff056000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1933 PSN 0xced3cc OUT 0x10 RKey 0x183000 VAddr 0x007ff056800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1934 PSN 0xe8fa9a OUT 0x10 RKey 0x183000 VAddr 0x007ff057000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1935 PSN 0x9adf56 OUT 0x10 RKey 0x183000 VAddr 0x007ff057800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1936 PSN 0x4d6b3 OUT 0x10 RKey 0x183000 VAddr 0x007ff058000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1937 PSN 0x5bd3f1 OUT 0x10 RKey 0x183000 VAddr 0x007ff058800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1938 PSN 0x930278 OUT 0x10 RKey 0x183000 VAddr 0x007ff059000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1939 PSN 0xb24605 OUT 0x10 RKey 0x183000 VAddr 0x007ff059800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x193a PSN 0x36a782 OUT 0x10 RKey 0x183000 VAddr 0x007ff05a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x193b PSN 0x851a29 OUT 0x10 RKey 0x183000 VAddr 0x007ff05a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x193c PSN 0xae70d9 OUT 0x10 RKey 0x183000 VAddr 0x007ff05b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x193d PSN 0x90b76d OUT 0x10 RKey 0x183000 VAddr 0x007ff05b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x193e PSN 0x8d386a OUT 0x10 RKey 0x183000 VAddr 0x007ff05c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x193f PSN 0x4774ed OUT 0x10 RKey 0x183000 VAddr 0x007ff05c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1940 PSN 0x55af0a OUT 0x10 RKey 0x183000 VAddr 0x007ff05d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1941 PSN 0x456c4 OUT 0x10 RKey 0x183000 VAddr 0x007ff05d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1942 PSN 0xe88393 OUT 0x10 RKey 0x183000 VAddr 0x007ff05e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1943 PSN 0x4a1e99 OUT 0x10 RKey 0x183000 VAddr 0x007ff05e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1944 PSN 0x2f8b3b OUT 0x10 RKey 0x183000 VAddr 0x007ff05f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1945 PSN 0x4710e OUT 0x10 RKey 0x183000 VAddr 0x007ff05f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.078947            0.077973            4.873339
 4          32000            0.16               0.16   		     5.054491
 8          32000            0.33               0.32   		     5.054462
 16         32000            0.65               0.65   		     5.058713
 32         32000            1.30               1.30   		     5.072176
 64         32000            2.61               2.60   		     5.079889
 128        32000            5.20               5.17   		     5.052706
 256        32000            10.43              10.37  		     5.061849
 512        32000            20.76              20.65  		     5.042562
 1024       32000            41.51              41.22  		     5.031478
 2048       32000            82.65              82.33  		     5.025197
 4096       32000            146.00             129.73 		     3.958985
 8192       32000            201.72             201.54 		     3.075306
 16384      32000            202.55             202.53 		     1.545179
 32768      32000            202.69             202.67 		     0.773108
 65536      32000            202.65             202.65 		     0.386529
 131072     32000            202.71             202.70 		     0.193309
 262144     32000            202.80             202.79 		     0.096700
 524288     32000            202.80             202.79 		     0.048350
 1048576    32000            184.37             184.36 		     0.021978
 2097152    32000            170.19             170.19 		     0.010144
 4194304    32000            170.13             170.13 		     0.005070
 8388608    32000            170.14             170.14 		     0.002535
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f4960000000
destroying current CUDA Ctx
