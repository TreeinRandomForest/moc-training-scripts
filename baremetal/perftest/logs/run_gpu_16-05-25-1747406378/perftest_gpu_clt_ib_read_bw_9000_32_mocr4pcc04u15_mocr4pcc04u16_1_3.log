initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 50329, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f1520000000 pointer=0x7f1520000000
using DMA-BUF for GPU buffer address at 0x7f1520000000 aligned at 0x7f1520000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f1520000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x19a4 PSN 0x48f5f1 OUT 0x10 RKey 0x183100 VAddr 0x007f1530000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19a5 PSN 0x711abe OUT 0x10 RKey 0x183100 VAddr 0x007f1530800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19a6 PSN 0x5224fa OUT 0x10 RKey 0x183100 VAddr 0x007f1531000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19a7 PSN 0x5a868a OUT 0x10 RKey 0x183100 VAddr 0x007f1531800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19a8 PSN 0x8b6e0c OUT 0x10 RKey 0x183100 VAddr 0x007f1532000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19a9 PSN 0x6e8548 OUT 0x10 RKey 0x183100 VAddr 0x007f1532800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19aa PSN 0xa0bdd1 OUT 0x10 RKey 0x183100 VAddr 0x007f1533000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19ab PSN 0xf560c0 OUT 0x10 RKey 0x183100 VAddr 0x007f1533800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19ac PSN 0xbf182e OUT 0x10 RKey 0x183100 VAddr 0x007f1534000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19ad PSN 0xcea9e1 OUT 0x10 RKey 0x183100 VAddr 0x007f1534800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19ae PSN 0x9223a7 OUT 0x10 RKey 0x183100 VAddr 0x007f1535000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19af PSN 0xe66be5 OUT 0x10 RKey 0x183100 VAddr 0x007f1535800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19b0 PSN 0xba2937 OUT 0x10 RKey 0x183100 VAddr 0x007f1536000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19b1 PSN 0xd46ce1 OUT 0x10 RKey 0x183100 VAddr 0x007f1536800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19b2 PSN 0xa679c1 OUT 0x10 RKey 0x183100 VAddr 0x007f1537000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19b3 PSN 0xf18027 OUT 0x10 RKey 0x183100 VAddr 0x007f1537800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19b4 PSN 0x8588e7 OUT 0x10 RKey 0x183100 VAddr 0x007f1538000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19b5 PSN 0xbbf8de OUT 0x10 RKey 0x183100 VAddr 0x007f1538800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19b6 PSN 0xa21c98 OUT 0x10 RKey 0x183100 VAddr 0x007f1539000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19b7 PSN 0xa2b26e OUT 0x10 RKey 0x183100 VAddr 0x007f1539800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19b8 PSN 0x3d996d OUT 0x10 RKey 0x183100 VAddr 0x007f153a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19b9 PSN 0xedb06f OUT 0x10 RKey 0x183100 VAddr 0x007f153a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19ba PSN 0x4add71 OUT 0x10 RKey 0x183100 VAddr 0x007f153b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19bb PSN 0x6510ef OUT 0x10 RKey 0x183100 VAddr 0x007f153b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19bc PSN 0xc3ad8e OUT 0x10 RKey 0x183100 VAddr 0x007f153c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19bd PSN 0x6f3a0b OUT 0x10 RKey 0x183100 VAddr 0x007f153c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19be PSN 0x8f1d9a OUT 0x10 RKey 0x183100 VAddr 0x007f153d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19bf PSN 0x1756de OUT 0x10 RKey 0x183100 VAddr 0x007f153d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19c0 PSN 0x98776e OUT 0x10 RKey 0x183100 VAddr 0x007f153e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19c1 PSN 0xa6280f OUT 0x10 RKey 0x183100 VAddr 0x007f153e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19c2 PSN 0x312342 OUT 0x10 RKey 0x183100 VAddr 0x007f153f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x19c3 PSN 0x32e940 OUT 0x10 RKey 0x183100 VAddr 0x007f153f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x19a4 PSN 0x11064c OUT 0x10 RKey 0x183000 VAddr 0x007f39f0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19a5 PSN 0x35d37d OUT 0x10 RKey 0x183000 VAddr 0x007f39f0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19a6 PSN 0x24684d OUT 0x10 RKey 0x183000 VAddr 0x007f39f1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19a7 PSN 0xe1c2e1 OUT 0x10 RKey 0x183000 VAddr 0x007f39f1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19a8 PSN 0x8a4917 OUT 0x10 RKey 0x183000 VAddr 0x007f39f2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19a9 PSN 0xe1aaf7 OUT 0x10 RKey 0x183000 VAddr 0x007f39f2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19aa PSN 0xd70354 OUT 0x10 RKey 0x183000 VAddr 0x007f39f3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19ab PSN 0x48ab87 OUT 0x10 RKey 0x183000 VAddr 0x007f39f3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19ac PSN 0xd8b8e9 OUT 0x10 RKey 0x183000 VAddr 0x007f39f4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19ad PSN 0x841b80 OUT 0x10 RKey 0x183000 VAddr 0x007f39f4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19ae PSN 0x7c5e5a OUT 0x10 RKey 0x183000 VAddr 0x007f39f5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19af PSN 0x623c1c OUT 0x10 RKey 0x183000 VAddr 0x007f39f5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19b0 PSN 0x373aa2 OUT 0x10 RKey 0x183000 VAddr 0x007f39f6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19b1 PSN 0x5ef970 OUT 0x10 RKey 0x183000 VAddr 0x007f39f6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19b2 PSN 0xc0cca4 OUT 0x10 RKey 0x183000 VAddr 0x007f39f7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19b3 PSN 0xe2bcce OUT 0x10 RKey 0x183000 VAddr 0x007f39f7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19b4 PSN 0xae6602 OUT 0x10 RKey 0x183000 VAddr 0x007f39f8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19b5 PSN 0xac5f5d OUT 0x10 RKey 0x183000 VAddr 0x007f39f8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19b6 PSN 0x27daab OUT 0x10 RKey 0x183000 VAddr 0x007f39f9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19b7 PSN 0xddb285 OUT 0x10 RKey 0x183000 VAddr 0x007f39f9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19b8 PSN 0xa54d38 OUT 0x10 RKey 0x183000 VAddr 0x007f39fa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19b9 PSN 0xc19fde OUT 0x10 RKey 0x183000 VAddr 0x007f39fa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19ba PSN 0xf989b4 OUT 0x10 RKey 0x183000 VAddr 0x007f39fb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19bb PSN 0x4c9b76 OUT 0x10 RKey 0x183000 VAddr 0x007f39fb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19bc PSN 0x42f309 OUT 0x10 RKey 0x183000 VAddr 0x007f39fc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19bd PSN 0x70516a OUT 0x10 RKey 0x183000 VAddr 0x007f39fc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19be PSN 0x996b0d OUT 0x10 RKey 0x183000 VAddr 0x007f39fd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19bf PSN 0x13a2d5 OUT 0x10 RKey 0x183000 VAddr 0x007f39fd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19c0 PSN 0xf8b999 OUT 0x10 RKey 0x183000 VAddr 0x007f39fe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19c1 PSN 0xb8f65e OUT 0x10 RKey 0x183000 VAddr 0x007f39fe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19c2 PSN 0x61f4e5 OUT 0x10 RKey 0x183000 VAddr 0x007f39ff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x19c3 PSN 0x989da7 OUT 0x10 RKey 0x183000 VAddr 0x007f39ff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.057878            0.057719            3.607463
 4          32000            0.12               0.12   		     3.672555
 8          32000            0.24               0.24   		     3.680424
 16         32000            0.47               0.47   		     3.682055
 32         32000            0.94               0.94   		     3.684535
 64         32000            1.89               1.89   		     3.688183
 128        32000            3.75               3.74   		     3.656516
 256        32000            7.55               7.52   		     3.672833
 512        32000            15.08              15.06  		     3.675558
 1024       32000            30.07              29.97  		     3.658552
 2048       32000            60.14              60.02  		     3.663553
 4096       32000            120.87             120.41 		     3.674668
 8192       32000            201.44             201.26 		     3.070961
 16384      32000            202.41             202.39 		     1.544124
 32768      32000            202.69             202.67 		     0.773123
 65536      32000            202.69             202.66 		     0.386534
 131072     32000            202.74             202.73 		     0.193336
 262144     32000            202.75             202.75 		     0.096678
 524288     32000            202.80             202.79 		     0.048350
 1048576    32000            184.45             184.45 		     0.021988
 2097152    32000            170.15             170.15 		     0.010142
 4194304    32000            170.11             170.11 		     0.005070
 8388608    32000            170.13             170.13 		     0.002535
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f1520000000
destroying current CUDA Ctx
