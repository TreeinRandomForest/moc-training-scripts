initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 52398, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f51c0000000 pointer=0x7f51c0000000
using DMA-BUF for GPU buffer address at 0x7f51c0000000 aligned at 0x7f51c0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f51c0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1b1e PSN 0x8d15c9 OUT 0x10 RKey 0x183100 VAddr 0x007f51d0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b1f PSN 0xb8467f OUT 0x10 RKey 0x183100 VAddr 0x007f51d0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b20 PSN 0x519f5d OUT 0x10 RKey 0x183100 VAddr 0x007f51d1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b21 PSN 0xd107e8 OUT 0x10 RKey 0x183100 VAddr 0x007f51d1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b22 PSN 0x6c83db OUT 0x10 RKey 0x183100 VAddr 0x007f51d2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b23 PSN 0x273ba1 OUT 0x10 RKey 0x183100 VAddr 0x007f51d2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b24 PSN 0x9ccaec OUT 0x10 RKey 0x183100 VAddr 0x007f51d3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b25 PSN 0x67aa75 OUT 0x10 RKey 0x183100 VAddr 0x007f51d3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b26 PSN 0xf38b75 OUT 0x10 RKey 0x183100 VAddr 0x007f51d4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b27 PSN 0x9ffc53 OUT 0x10 RKey 0x183100 VAddr 0x007f51d4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b28 PSN 0x6636fb OUT 0x10 RKey 0x183100 VAddr 0x007f51d5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b29 PSN 0x89ab72 OUT 0x10 RKey 0x183100 VAddr 0x007f51d5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b2a PSN 0xc75976 OUT 0x10 RKey 0x183100 VAddr 0x007f51d6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b2b PSN 0x5504eb OUT 0x10 RKey 0x183100 VAddr 0x007f51d6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b2c PSN 0xc1becd OUT 0x10 RKey 0x183100 VAddr 0x007f51d7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b2d PSN 0x303b0d OUT 0x10 RKey 0x183100 VAddr 0x007f51d7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b2e PSN 0xb74d9e OUT 0x10 RKey 0x183100 VAddr 0x007f51d8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b2f PSN 0xd39800 OUT 0x10 RKey 0x183100 VAddr 0x007f51d8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b30 PSN 0x8af6db OUT 0x10 RKey 0x183100 VAddr 0x007f51d9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b31 PSN 0x1a462c OUT 0x10 RKey 0x183100 VAddr 0x007f51d9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b32 PSN 0x95c21d OUT 0x10 RKey 0x183100 VAddr 0x007f51da000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b33 PSN 0xceb028 OUT 0x10 RKey 0x183100 VAddr 0x007f51da800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b34 PSN 0xda686c OUT 0x10 RKey 0x183100 VAddr 0x007f51db000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b35 PSN 0x3b3304 OUT 0x10 RKey 0x183100 VAddr 0x007f51db800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b36 PSN 0x6181b5 OUT 0x10 RKey 0x183100 VAddr 0x007f51dc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b37 PSN 0xa80bdc OUT 0x10 RKey 0x183100 VAddr 0x007f51dc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b38 PSN 0x64accd OUT 0x10 RKey 0x183100 VAddr 0x007f51dd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b39 PSN 0x2794cb OUT 0x10 RKey 0x183100 VAddr 0x007f51dd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b3a PSN 0x18368e OUT 0x10 RKey 0x183100 VAddr 0x007f51de000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b3b PSN 0xcad578 OUT 0x10 RKey 0x183100 VAddr 0x007f51de800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b3c PSN 0xddc22e OUT 0x10 RKey 0x183100 VAddr 0x007f51df000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b3d PSN 0x942885 OUT 0x10 RKey 0x183100 VAddr 0x007f51df800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1b1e PSN 0xe174b2 OUT 0x10 RKey 0x183000 VAddr 0x007f5a50000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b1f PSN 0xb605b4 OUT 0x10 RKey 0x183000 VAddr 0x007f5a50800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b20 PSN 0x1a6ee OUT 0x10 RKey 0x183000 VAddr 0x007f5a51000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b21 PSN 0x3c86a5 OUT 0x10 RKey 0x183000 VAddr 0x007f5a51800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b22 PSN 0x4b4854 OUT 0x10 RKey 0x183000 VAddr 0x007f5a52000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b23 PSN 0x119926 OUT 0x10 RKey 0x183000 VAddr 0x007f5a52800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b24 PSN 0x81a8d OUT 0x10 RKey 0x183000 VAddr 0x007f5a53000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b25 PSN 0xf3802 OUT 0x10 RKey 0x183000 VAddr 0x007f5a53800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b26 PSN 0x737e7e OUT 0x10 RKey 0x183000 VAddr 0x007f5a54000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b27 PSN 0xc08d28 OUT 0x10 RKey 0x183000 VAddr 0x007f5a54800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b28 PSN 0xbf3fac OUT 0x10 RKey 0x183000 VAddr 0x007f5a55000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b29 PSN 0x6d64cf OUT 0x10 RKey 0x183000 VAddr 0x007f5a55800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b2a PSN 0x2d40f OUT 0x10 RKey 0x183000 VAddr 0x007f5a56000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b2b PSN 0xd9ae10 OUT 0x10 RKey 0x183000 VAddr 0x007f5a56800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b2c PSN 0x51018e OUT 0x10 RKey 0x183000 VAddr 0x007f5a57000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b2d PSN 0x150d3a OUT 0x10 RKey 0x183000 VAddr 0x007f5a57800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b2e PSN 0x7538c7 OUT 0x10 RKey 0x183000 VAddr 0x007f5a58000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b2f PSN 0xc38e75 OUT 0x10 RKey 0x183000 VAddr 0x007f5a58800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b30 PSN 0x04ac OUT 0x10 RKey 0x183000 VAddr 0x007f5a59000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b31 PSN 0x6ee29 OUT 0x10 RKey 0x183000 VAddr 0x007f5a59800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b32 PSN 0x8296d6 OUT 0x10 RKey 0x183000 VAddr 0x007f5a5a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b33 PSN 0x4f78ed OUT 0x10 RKey 0x183000 VAddr 0x007f5a5a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b34 PSN 0xace24d OUT 0x10 RKey 0x183000 VAddr 0x007f5a5b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b35 PSN 0xc53dd1 OUT 0x10 RKey 0x183000 VAddr 0x007f5a5b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b36 PSN 0xd848fe OUT 0x10 RKey 0x183000 VAddr 0x007f5a5c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b37 PSN 0x927bf1 OUT 0x10 RKey 0x183000 VAddr 0x007f5a5c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b38 PSN 0x4543be OUT 0x10 RKey 0x183000 VAddr 0x007f5a5d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b39 PSN 0x905f68 OUT 0x10 RKey 0x183000 VAddr 0x007f5a5d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b3a PSN 0x7b8967 OUT 0x10 RKey 0x183000 VAddr 0x007f5a5e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b3b PSN 0x9011dd OUT 0x10 RKey 0x183000 VAddr 0x007f5a5e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b3c PSN 0x37372f OUT 0x10 RKey 0x183000 VAddr 0x007f5a5f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b3d PSN 0xb5dff2 OUT 0x10 RKey 0x183000 VAddr 0x007f5a5f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.057878            0.057668            3.604257
 4          32000            0.12               0.12   		     3.671084
 8          32000            0.24               0.24   		     3.678241
 16         32000            0.47               0.47   		     3.655593
 32         32000            0.94               0.94   		     3.684365
 64         32000            1.89               1.88   		     3.679768
 128        32000            3.77               3.76   		     3.669636
 256        32000            7.55               7.54   		     3.682334
 512        32000            15.11              15.03  		     3.668320
 1024       32000            30.12              30.08  		     3.671464
 2048       32000            60.23              59.98  		     3.660927
 4096       32000            119.88             119.12 		     3.635128
 8192       32000            196.86             196.76 		     3.002382
 16384      32000            197.79             197.79 		     1.509009
 32768      32000            197.86             197.81 		     0.754580
 65536      32000            197.89             197.88 		     0.377429
 131072     32000            198.01             198.00 		     0.188830
 262144     32000            198.02             198.01 		     0.094419
 524288     32000            198.02             198.02 		     0.047211
 1048576    32000            178.63             178.63 		     0.021295
 2097152    32000            164.06             164.05 		     0.009778
 4194304    32000            163.98             163.98 		     0.004887
 8388608    32000            163.98             163.98 		     0.002444
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f51c0000000
destroying current CUDA Ctx
