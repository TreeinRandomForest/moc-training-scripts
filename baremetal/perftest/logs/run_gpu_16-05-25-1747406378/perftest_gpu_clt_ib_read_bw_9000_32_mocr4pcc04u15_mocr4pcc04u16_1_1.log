initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 48955, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007ff300000000 pointer=0x7ff300000000
using DMA-BUF for GPU buffer address at 0x7ff300000000 aligned at 0x7ff300000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7ff300000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x18a8 PSN 0xaa4a39 OUT 0x10 RKey 0x183100 VAddr 0x007ff310000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18a9 PSN 0xfaad66 OUT 0x10 RKey 0x183100 VAddr 0x007ff310800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18aa PSN 0x888682 OUT 0x10 RKey 0x183100 VAddr 0x007ff311000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18ab PSN 0x823d72 OUT 0x10 RKey 0x183100 VAddr 0x007ff311800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18ac PSN 0xa8bed4 OUT 0x10 RKey 0x183100 VAddr 0x007ff312000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18ad PSN 0xdd9a70 OUT 0x10 RKey 0x183100 VAddr 0x007ff312800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18ae PSN 0xceafd9 OUT 0x10 RKey 0x183100 VAddr 0x007ff313000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18af PSN 0x589e28 OUT 0x10 RKey 0x183100 VAddr 0x007ff313800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18b0 PSN 0xbad76 OUT 0x10 RKey 0x183100 VAddr 0x007ff314000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18b1 PSN 0xe8e989 OUT 0x10 RKey 0x183100 VAddr 0x007ff314800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18b2 PSN 0xd02e2f OUT 0x10 RKey 0x183100 VAddr 0x007ff315000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18b3 PSN 0x2717cd OUT 0x10 RKey 0x183100 VAddr 0x007ff315800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18b4 PSN 0x95caff OUT 0x10 RKey 0x183100 VAddr 0x007ff316000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18b5 PSN 0x11ff09 OUT 0x10 RKey 0x183100 VAddr 0x007ff316800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18b6 PSN 0xda4c9 OUT 0x10 RKey 0x183100 VAddr 0x007ff317000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18b7 PSN 0xe8028f OUT 0x10 RKey 0x183100 VAddr 0x007ff317800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18b8 PSN 0x847f2f OUT 0x10 RKey 0x183100 VAddr 0x007ff318000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18b9 PSN 0xef8586 OUT 0x10 RKey 0x183100 VAddr 0x007ff318800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18ba PSN 0xd3f020 OUT 0x10 RKey 0x183100 VAddr 0x007ff319000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18bb PSN 0x45f356 OUT 0x10 RKey 0x183100 VAddr 0x007ff319800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18bc PSN 0xf0ac35 OUT 0x10 RKey 0x183100 VAddr 0x007ff31a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18bd PSN 0x6c5f97 OUT 0x10 RKey 0x183100 VAddr 0x007ff31a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18be PSN 0x796179 OUT 0x10 RKey 0x183100 VAddr 0x007ff31b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18bf PSN 0x327857 OUT 0x10 RKey 0x183100 VAddr 0x007ff31b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18c0 PSN 0x24d6 OUT 0x10 RKey 0x183100 VAddr 0x007ff31c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18c1 PSN 0xb8b3b3 OUT 0x10 RKey 0x183100 VAddr 0x007ff31c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18c2 PSN 0x4da22 OUT 0x10 RKey 0x183100 VAddr 0x007ff31d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18c3 PSN 0xfaccc6 OUT 0x10 RKey 0x183100 VAddr 0x007ff31d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18c4 PSN 0x401b36 OUT 0x10 RKey 0x183100 VAddr 0x007ff31e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18c5 PSN 0x8c9437 OUT 0x10 RKey 0x183100 VAddr 0x007ff31e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18c6 PSN 0x59204a OUT 0x10 RKey 0x183100 VAddr 0x007ff31f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x18c7 PSN 0xeed5a8 OUT 0x10 RKey 0x183100 VAddr 0x007ff31f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x18a8 PSN 0x88674b OUT 0x10 RKey 0x183000 VAddr 0x007fecd0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18a9 PSN 0x433a10 OUT 0x10 RKey 0x183000 VAddr 0x007fecd0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18aa PSN 0x8526e4 OUT 0x10 RKey 0x183000 VAddr 0x007fecd1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18ab PSN 0x82932c OUT 0x10 RKey 0x183000 VAddr 0x007fecd1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18ac PSN 0x4a5b06 OUT 0x10 RKey 0x183000 VAddr 0x007fecd2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18ad PSN 0x1a07ba OUT 0x10 RKey 0x183000 VAddr 0x007fecd2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18ae PSN 0xf1b45b OUT 0x10 RKey 0x183000 VAddr 0x007fecd3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18af PSN 0x265582 OUT 0x10 RKey 0x183000 VAddr 0x007fecd3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18b0 PSN 0x559ac8 OUT 0x10 RKey 0x183000 VAddr 0x007fecd4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18b1 PSN 0x32a173 OUT 0x10 RKey 0x183000 VAddr 0x007fecd4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18b2 PSN 0x27b8d1 OUT 0x10 RKey 0x183000 VAddr 0x007fecd5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18b3 PSN 0x52aac7 OUT 0x10 RKey 0x183000 VAddr 0x007fecd5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18b4 PSN 0xa7fb71 OUT 0x10 RKey 0x183000 VAddr 0x007fecd6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18b5 PSN 0x6f0b93 OUT 0x10 RKey 0x183000 VAddr 0x007fecd6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18b6 PSN 0x27f78b OUT 0x10 RKey 0x183000 VAddr 0x007fecd7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18b7 PSN 0x4f8b29 OUT 0x10 RKey 0x183000 VAddr 0x007fecd7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18b8 PSN 0x4c04c1 OUT 0x10 RKey 0x183000 VAddr 0x007fecd8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18b9 PSN 0x7c90b0 OUT 0x10 RKey 0x183000 VAddr 0x007fecd8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18ba PSN 0xa16d02 OUT 0x10 RKey 0x183000 VAddr 0x007fecd9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18bb PSN 0x4f2b90 OUT 0x10 RKey 0x183000 VAddr 0x007fecd9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18bc PSN 0xd9b8e7 OUT 0x10 RKey 0x183000 VAddr 0x007fecda000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18bd PSN 0x26b361 OUT 0x10 RKey 0x183000 VAddr 0x007fecda800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18be PSN 0x4e8a7b OUT 0x10 RKey 0x183000 VAddr 0x007fecdb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18bf PSN 0xa4ba31 OUT 0x10 RKey 0x183000 VAddr 0x007fecdb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18c0 PSN 0xc80aa8 OUT 0x10 RKey 0x183000 VAddr 0x007fecdc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18c1 PSN 0xe83a1d OUT 0x10 RKey 0x183000 VAddr 0x007fecdc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18c2 PSN 0xbc5144 OUT 0x10 RKey 0x183000 VAddr 0x007fecdd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18c3 PSN 0x791240 OUT 0x10 RKey 0x183000 VAddr 0x007fecdd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18c4 PSN 0xe74c28 OUT 0x10 RKey 0x183000 VAddr 0x007fecde000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18c5 PSN 0xcdd741 OUT 0x10 RKey 0x183000 VAddr 0x007fecde800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18c6 PSN 0x95a78c OUT 0x10 RKey 0x183000 VAddr 0x007fecdf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x18c7 PSN 0x11b8c2 OUT 0x10 RKey 0x183000 VAddr 0x007fecdf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.082949            0.081875            5.117176
 4          32000            0.17               0.17   		     5.364915
 8          32000            0.35               0.34   		     5.372463
 16         32000            0.69               0.68   		     5.351058
 32         32000            1.38               1.37   		     5.368632
 64         32000            2.76               2.75   		     5.366390
 128        32000            5.51               5.48   		     5.353659
 256        32000            10.97              10.92  		     5.333004
 512        32000            22.00              21.88  		     5.341131
 1024       32000            45.29              45.09  		     5.504439
 2048       32000            94.28              93.67  		     5.717012
 4096       32000            128.22             122.50 		     3.738458
 8192       32000            201.99             201.78 		     3.078883
 16384      32000            202.69             202.55 		     1.545344
 32768      32000            202.69             202.68 		     0.773174
 65536      32000            202.76             202.74 		     0.386694
 131072     32000            202.76             202.75 		     0.193356
 262144     32000            202.78             202.77 		     0.096687
 524288     32000            202.81             202.81 		     0.048354
 1048576    32000            184.12             184.12 		     0.021948
 2097152    32000            170.20             170.20 		     0.010145
 4194304    32000            170.15             170.15 		     0.005071
 8388608    32000            170.17             170.17 		     0.002536
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007ff300000000
destroying current CUDA Ctx
