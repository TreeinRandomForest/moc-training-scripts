initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 58706, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f3808000000 pointer=0x7f3808000000
using DMA-BUF for GPU buffer address at 0x7f3808000000 aligned at 0x7f3808000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f3808000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1efe PSN 0x38f45c OUT 0x10 RKey 0x182f00 VAddr 0x007f3810000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1eff PSN 0x621d16 OUT 0x10 RKey 0x182f00 VAddr 0x007f3810800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f00 PSN 0xa1a7a8 OUT 0x10 RKey 0x182f00 VAddr 0x007f3811000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f01 PSN 0x7bf1d7 OUT 0x10 RKey 0x182f00 VAddr 0x007f3811800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f02 PSN 0xb2d89e OUT 0x10 RKey 0x182f00 VAddr 0x007f3812000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f03 PSN 0x484a8 OUT 0x10 RKey 0x182f00 VAddr 0x007f3812800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f04 PSN 0xe52ce7 OUT 0x10 RKey 0x182f00 VAddr 0x007f3813000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f05 PSN 0xa4e454 OUT 0x10 RKey 0x182f00 VAddr 0x007f3813800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f06 PSN 0x978968 OUT 0x10 RKey 0x182f00 VAddr 0x007f3814000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f07 PSN 0x9f6eca OUT 0x10 RKey 0x182f00 VAddr 0x007f3814800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f08 PSN 0xb4dda6 OUT 0x10 RKey 0x182f00 VAddr 0x007f3815000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f09 PSN 0x684441 OUT 0x10 RKey 0x182f00 VAddr 0x007f3815800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f0a PSN 0xac6399 OUT 0x10 RKey 0x182f00 VAddr 0x007f3816000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f0b PSN 0x39c7d2 OUT 0x10 RKey 0x182f00 VAddr 0x007f3816800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f0c PSN 0x384528 OUT 0x10 RKey 0x182f00 VAddr 0x007f3817000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f0d PSN 0x4131cc OUT 0x10 RKey 0x182f00 VAddr 0x007f3817800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1efe PSN 0x541a6d OUT 0x10 RKey 0x183000 VAddr 0x007fcb94000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1eff PSN 0xd09853 OUT 0x10 RKey 0x183000 VAddr 0x007fcb94800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f00 PSN 0xa0eea1 OUT 0x10 RKey 0x183000 VAddr 0x007fcb95000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f01 PSN 0x7cdfdc OUT 0x10 RKey 0x183000 VAddr 0x007fcb95800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f02 PSN 0x8caebf OUT 0x10 RKey 0x183000 VAddr 0x007fcb96000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f03 PSN 0x9256b5 OUT 0x10 RKey 0x183000 VAddr 0x007fcb96800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f04 PSN 0xfb4a70 OUT 0x10 RKey 0x183000 VAddr 0x007fcb97000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f05 PSN 0xe48da9 OUT 0x10 RKey 0x183000 VAddr 0x007fcb97800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f06 PSN 0x310099 OUT 0x10 RKey 0x183000 VAddr 0x007fcb98000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f07 PSN 0x3934a7 OUT 0x10 RKey 0x183000 VAddr 0x007fcb98800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f08 PSN 0xaeaabf OUT 0x10 RKey 0x183000 VAddr 0x007fcb99000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f09 PSN 0x150de6 OUT 0x10 RKey 0x183000 VAddr 0x007fcb99800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f0a PSN 0x847cda OUT 0x10 RKey 0x183000 VAddr 0x007fcb9a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f0b PSN 0xd8ee7f OUT 0x10 RKey 0x183000 VAddr 0x007fcb9a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f0c PSN 0x372ad1 OUT 0x10 RKey 0x183000 VAddr 0x007fcb9b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f0d PSN 0xead0c1 OUT 0x10 RKey 0x183000 VAddr 0x007fcb9b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.074074            0.071820            4.488746
 4          16000            0.16               0.16   		     5.011323
 8          16000            0.32               0.32   		     5.011511
 16         16000            0.64               0.64   		     4.984315
 32         16000            1.29               1.28   		     5.003628
 64         16000            2.57               2.56   		     4.991919
 128        16000            5.13               5.10   		     4.976548
 256        16000            10.24              10.23  		     4.994600
 512        16000            20.53              20.43  		     4.987982
 1024       16000            41.14              40.89  		     4.991265
 2048       16000            81.92              81.47  		     4.972280
 4096       16000            162.40             162.12 		     4.947617
 8192       16000            206.52             205.23 		     3.131520
 16384      16000            204.94             204.85 		     1.562918
 32768      16000            203.11             203.08 		     0.774703
 65536      16000            208.20             208.18 		     0.397071
 131072     16000            208.46             208.44 		     0.198785
 262144     16000            208.70             208.70 		     0.099514
 524288     16000            209.18             209.17 		     0.049871
 1048576    16000            209.33             209.33 		     0.024954
 2097152    16000            193.66             193.66 		     0.011543
 4194304    16000            171.13             171.13 		     0.005100
 8388608    16000            171.18             171.18 		     0.002551
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f3808000000
destroying current CUDA Ctx
