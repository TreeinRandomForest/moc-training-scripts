initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 46696, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007fc33c000000 pointer=0x7fc33c000000
using DMA-BUF for GPU buffer address at 0x7fc33c000000 aligned at 0x7fc33c000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7fc33c000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x171e PSN 0xe8b306 OUT 0x10 RKey 0x183000 VAddr 0x007fc344000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x171f PSN 0x3b0778 OUT 0x10 RKey 0x183000 VAddr 0x007fc344800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1720 PSN 0xe97f62 OUT 0x10 RKey 0x183000 VAddr 0x007fc345000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1721 PSN 0x5be809 OUT 0x10 RKey 0x183000 VAddr 0x007fc345800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1722 PSN 0x5797e8 OUT 0x10 RKey 0x183000 VAddr 0x007fc346000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1723 PSN 0x3e732a OUT 0x10 RKey 0x183000 VAddr 0x007fc346800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1724 PSN 0xb08641 OUT 0x10 RKey 0x183000 VAddr 0x007fc347000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1725 PSN 0x78cba6 OUT 0x10 RKey 0x183000 VAddr 0x007fc347800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1726 PSN 0x3cb352 OUT 0x10 RKey 0x183000 VAddr 0x007fc348000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1727 PSN 0x52836c OUT 0x10 RKey 0x183000 VAddr 0x007fc348800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1728 PSN 0xd632a0 OUT 0x10 RKey 0x183000 VAddr 0x007fc349000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1729 PSN 0x6a0eb3 OUT 0x10 RKey 0x183000 VAddr 0x007fc349800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x172a PSN 0x6a0223 OUT 0x10 RKey 0x183000 VAddr 0x007fc34a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x172b PSN 0x9e4494 OUT 0x10 RKey 0x183000 VAddr 0x007fc34a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x172c PSN 0xefafc2 OUT 0x10 RKey 0x183000 VAddr 0x007fc34b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x172d PSN 0x17f15e OUT 0x10 RKey 0x183000 VAddr 0x007fc34b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x171e PSN 0xd66ae8 OUT 0x10 RKey 0x182f00 VAddr 0x007f000c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x171f PSN 0xff5eb2 OUT 0x10 RKey 0x182f00 VAddr 0x007f000c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1720 PSN 0x58bf14 OUT 0x10 RKey 0x182f00 VAddr 0x007f000d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1721 PSN 0xbf2d3 OUT 0x10 RKey 0x182f00 VAddr 0x007f000d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1722 PSN 0x35abea OUT 0x10 RKey 0x182f00 VAddr 0x007f000e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1723 PSN 0x9ec404 OUT 0x10 RKey 0x182f00 VAddr 0x007f000e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1724 PSN 0x4ecf13 OUT 0x10 RKey 0x182f00 VAddr 0x007f000f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1725 PSN 0xe27910 OUT 0x10 RKey 0x182f00 VAddr 0x007f000f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1726 PSN 0xc0c574 OUT 0x10 RKey 0x182f00 VAddr 0x007f0010000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1727 PSN 0x30c7e6 OUT 0x10 RKey 0x182f00 VAddr 0x007f0010800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1728 PSN 0x76f692 OUT 0x10 RKey 0x182f00 VAddr 0x007f0011000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1729 PSN 0xe8bd OUT 0x10 RKey 0x182f00 VAddr 0x007f0011800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x172a PSN 0xc1d465 OUT 0x10 RKey 0x182f00 VAddr 0x007f0012000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x172b PSN 0xc216ae OUT 0x10 RKey 0x182f00 VAddr 0x007f0012800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x172c PSN 0xeb80d4 OUT 0x10 RKey 0x182f00 VAddr 0x007f0013000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x172d PSN 0xbe2208 OUT 0x10 RKey 0x182f00 VAddr 0x007f0013800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.058065            0.057830            3.614390
 4          16000            0.12               0.12   		     3.658949
 8          16000            0.24               0.23   		     3.659619
 16         16000            0.47               0.47   		     3.679557
 32         16000            0.94               0.94   		     3.677349
 64         16000            1.89               1.87   		     3.661537
 128        16000            3.72               3.71   		     3.624617
 256        16000            7.54               7.52   		     3.673457
 512        16000            15.08              14.98  		     3.656758
 1024       16000            30.12              30.06  		     3.668951
 2048       16000            59.46              59.08  		     3.606260
 4096       16000            119.49             119.31 		     3.641139
 8192       16000            207.10             207.03 		     3.159090
 16384      16000            208.86             208.75 		     1.592672
 32768      16000            209.23             209.18 		     0.797956
 65536      16000            209.31             209.29 		     0.399184
 131072     16000            209.34             209.33 		     0.199629
 262144     16000            209.40             209.40 		     0.099848
 524288     16000            209.44             209.43 		     0.049933
 1048576    16000            209.46             209.46 		     0.024969
 2097152    16000            192.08             192.08 		     0.011449
 4194304    16000            171.13             171.13 		     0.005100
 8388608    16000            171.09             171.09 		     0.002549
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fc33c000000
destroying current CUDA Ctx
