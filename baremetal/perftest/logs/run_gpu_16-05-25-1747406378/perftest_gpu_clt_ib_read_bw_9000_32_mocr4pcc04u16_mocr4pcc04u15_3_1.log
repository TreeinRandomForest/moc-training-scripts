initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 66275, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f5aa0000000 pointer=0x7f5aa0000000
using DMA-BUF for GPU buffer address at 0x7f5aa0000000 aligned at 0x7f5aa0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f5aa0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x2478 PSN 0xafa961 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2479 PSN 0x2bae37 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x247a PSN 0x4418b5 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x247b PSN 0x33c260 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x247c PSN 0x9db8f3 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x247d PSN 0xee66d9 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x247e PSN 0xde81c4 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x247f PSN 0xc8946d OUT 0x10 RKey 0x183000 VAddr 0x007f5ab3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2480 PSN 0xbfa0d OUT 0x10 RKey 0x183000 VAddr 0x007f5ab4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2481 PSN 0x83a30b OUT 0x10 RKey 0x183000 VAddr 0x007f5ab4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2482 PSN 0xbd8353 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2483 PSN 0x6c3cea OUT 0x10 RKey 0x183000 VAddr 0x007f5ab5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2484 PSN 0x91198e OUT 0x10 RKey 0x183000 VAddr 0x007f5ab6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2485 PSN 0xf15f23 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2486 PSN 0x278a5 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2487 PSN 0xd76c05 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2488 PSN 0x85f736 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2489 PSN 0x505db8 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x248a PSN 0xee7633 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x248b PSN 0x8ea4 OUT 0x10 RKey 0x183000 VAddr 0x007f5ab9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x248c PSN 0x5e6d35 OUT 0x10 RKey 0x183000 VAddr 0x007f5aba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x248d PSN 0x171960 OUT 0x10 RKey 0x183000 VAddr 0x007f5aba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x248e PSN 0xd78544 OUT 0x10 RKey 0x183000 VAddr 0x007f5abb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x248f PSN 0xa8afc OUT 0x10 RKey 0x183000 VAddr 0x007f5abb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2490 PSN 0x52c64d OUT 0x10 RKey 0x183000 VAddr 0x007f5abc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2491 PSN 0x22d094 OUT 0x10 RKey 0x183000 VAddr 0x007f5abc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2492 PSN 0x7bf25 OUT 0x10 RKey 0x183000 VAddr 0x007f5abd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2493 PSN 0x317443 OUT 0x10 RKey 0x183000 VAddr 0x007f5abd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2494 PSN 0xb22ca6 OUT 0x10 RKey 0x183000 VAddr 0x007f5abe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2495 PSN 0x922db0 OUT 0x10 RKey 0x183000 VAddr 0x007f5abe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2496 PSN 0xa0a206 OUT 0x10 RKey 0x183000 VAddr 0x007f5abf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2497 PSN 0xc9877d OUT 0x10 RKey 0x183000 VAddr 0x007f5abf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x2478 PSN 0x3a52ed OUT 0x10 RKey 0x183100 VAddr 0x007f34f0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2479 PSN 0x99a6d3 OUT 0x10 RKey 0x183100 VAddr 0x007f34f0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x247a PSN 0x431b21 OUT 0x10 RKey 0x183100 VAddr 0x007f34f1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x247b PSN 0x84d25c OUT 0x10 RKey 0x183100 VAddr 0x007f34f1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x247c PSN 0xcdef3f OUT 0x10 RKey 0x183100 VAddr 0x007f34f2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x247d PSN 0x4dcd35 OUT 0x10 RKey 0x183100 VAddr 0x007f34f2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x247e PSN 0x43bef0 OUT 0x10 RKey 0x183100 VAddr 0x007f34f3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x247f PSN 0x692829 OUT 0x10 RKey 0x183100 VAddr 0x007f34f3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2480 PSN 0x75c919 OUT 0x10 RKey 0x183100 VAddr 0x007f34f4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2481 PSN 0xa59327 OUT 0x10 RKey 0x183100 VAddr 0x007f34f4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2482 PSN 0xb9e73f OUT 0x10 RKey 0x183100 VAddr 0x007f34f5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2483 PSN 0x38d066 OUT 0x10 RKey 0x183100 VAddr 0x007f34f5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2484 PSN 0x7d4d5a OUT 0x10 RKey 0x183100 VAddr 0x007f34f6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2485 PSN 0x1cb4ff OUT 0x10 RKey 0x183100 VAddr 0x007f34f6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2486 PSN 0x69af51 OUT 0x10 RKey 0x183100 VAddr 0x007f34f7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2487 PSN 0x783b41 OUT 0x10 RKey 0x183100 VAddr 0x007f34f7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2488 PSN 0x7e1bc2 OUT 0x10 RKey 0x183100 VAddr 0x007f34f8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2489 PSN 0xddb554 OUT 0x10 RKey 0x183100 VAddr 0x007f34f8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x248a PSN 0xa2eb9f OUT 0x10 RKey 0x183100 VAddr 0x007f34f9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x248b PSN 0xe595a0 OUT 0x10 RKey 0x183100 VAddr 0x007f34f9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x248c PSN 0x78ce81 OUT 0x10 RKey 0x183100 VAddr 0x007f34fa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x248d PSN 0xcccebc OUT 0x10 RKey 0x183100 VAddr 0x007f34fa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x248e PSN 0xf66570 OUT 0x10 RKey 0x183100 VAddr 0x007f34fb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x248f PSN 0x2785b8 OUT 0x10 RKey 0x183100 VAddr 0x007f34fb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2490 PSN 0x3e7059 OUT 0x10 RKey 0x183100 VAddr 0x007f34fc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2491 PSN 0x50ffb0 OUT 0x10 RKey 0x183100 VAddr 0x007f34fc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2492 PSN 0xd4f611 OUT 0x10 RKey 0x183100 VAddr 0x007f34fd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2493 PSN 0x79debf OUT 0x10 RKey 0x183100 VAddr 0x007f34fd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2494 PSN 0x82eb72 OUT 0x10 RKey 0x183100 VAddr 0x007f34fe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2495 PSN 0xeeb28c OUT 0x10 RKey 0x183100 VAddr 0x007f34fe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2496 PSN 0x32dbb2 OUT 0x10 RKey 0x183100 VAddr 0x007f34ff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2497 PSN 0x6c9db9 OUT 0x10 RKey 0x183100 VAddr 0x007f34ff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.059801            0.059513            3.719589
 4          32000            0.12               0.12   		     3.760870
 8          32000            0.24               0.24   		     3.772402
 16         32000            0.48               0.48   		     3.772535
 32         32000            0.98               0.97   		     3.773278
 64         32000            1.94               1.93   		     3.764489
 128        32000            3.89               3.87   		     3.781755
 256        32000            7.72               7.71   		     3.764046
 512        32000            15.73              15.65  		     3.821197
 1024       32000            31.51              31.39  		     3.831289
 2048       32000            63.78              63.47  		     3.874134
 4096       32000            133.57             94.57  		     2.886084
 8192       32000            193.51             193.34 		     2.950168
 16384      32000            195.82             195.77 		     1.493571
 32768      32000            197.33             197.29 		     0.752607
 65536      32000            189.96             186.98 		     0.356636
 131072     32000            196.82             196.81 		     0.187689
 262144     32000            194.52             194.52 		     0.092753
 524288     32000            195.86             195.85 		     0.046695
 1048576    32000            177.91             177.91 		     0.021209
 2097152    32000            163.41             163.41 		     0.009740
 4194304    32000            163.46             163.46 		     0.004872
 8388608    32000            163.38             163.38 		     0.002435
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f5aa0000000
destroying current CUDA Ctx
