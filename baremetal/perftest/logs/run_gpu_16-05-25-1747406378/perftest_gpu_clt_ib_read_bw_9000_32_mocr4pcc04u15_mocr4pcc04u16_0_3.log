initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 47436, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fb2e0000000 pointer=0x7fb2e0000000
using DMA-BUF for GPU buffer address at 0x7fb2e0000000 aligned at 0x7fb2e0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fb2e0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x17ac PSN 0x252a28 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17ad PSN 0x5a4cf2 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17ae PSN 0x1db054 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17af PSN 0xa62b13 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17b0 PSN 0x691f2a OUT 0x10 RKey 0x183100 VAddr 0x007fb2f2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17b1 PSN 0x125644 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17b2 PSN 0xe99453 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17b3 PSN 0xfff550 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17b4 PSN 0xf02cb4 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17b5 PSN 0x233e26 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17b6 PSN 0xf0cfd2 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17b7 PSN 0x11e8fd OUT 0x10 RKey 0x183100 VAddr 0x007fb2f5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17b8 PSN 0x386fa5 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17b9 PSN 0xbdb0ee OUT 0x10 RKey 0x183100 VAddr 0x007fb2f6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17ba PSN 0xa1ae14 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17bb PSN 0xf6e648 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17bc PSN 0x8937bd OUT 0x10 RKey 0x183100 VAddr 0x007fb2f8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17bd PSN 0x202133 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17be PSN 0x693392 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17bf PSN 0xfa8a17 OUT 0x10 RKey 0x183100 VAddr 0x007fb2f9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17c0 PSN 0xbbcf2c OUT 0x10 RKey 0x183100 VAddr 0x007fb2fa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17c1 PSN 0x91b98b OUT 0x10 RKey 0x183100 VAddr 0x007fb2fa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17c2 PSN 0x985993 OUT 0x10 RKey 0x183100 VAddr 0x007fb2fb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17c3 PSN 0xb7ea9f OUT 0x10 RKey 0x183100 VAddr 0x007fb2fb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17c4 PSN 0x54f0b4 OUT 0x10 RKey 0x183100 VAddr 0x007fb2fc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17c5 PSN 0x1b686f OUT 0x10 RKey 0x183100 VAddr 0x007fb2fc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17c6 PSN 0x332964 OUT 0x10 RKey 0x183100 VAddr 0x007fb2fd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17c7 PSN 0x364b16 OUT 0x10 RKey 0x183100 VAddr 0x007fb2fd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17c8 PSN 0x47367d OUT 0x10 RKey 0x183100 VAddr 0x007fb2fe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17c9 PSN 0x12883b OUT 0x10 RKey 0x183100 VAddr 0x007fb2fe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17ca PSN 0xc41135 OUT 0x10 RKey 0x183100 VAddr 0x007fb2ff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17cb PSN 0x181880 OUT 0x10 RKey 0x183100 VAddr 0x007fb2ff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x17ac PSN 0x1c3a0c OUT 0x10 RKey 0x183000 VAddr 0x007f8530000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17ad PSN 0x795c3d OUT 0x10 RKey 0x183000 VAddr 0x007f8530800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17ae PSN 0xc2220d OUT 0x10 RKey 0x183000 VAddr 0x007f8531000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17af PSN 0xec59a1 OUT 0x10 RKey 0x183000 VAddr 0x007f8531800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17b0 PSN 0x7cf8d7 OUT 0x10 RKey 0x183000 VAddr 0x007f8532000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17b1 PSN 0x1cffb7 OUT 0x10 RKey 0x183000 VAddr 0x007f8532800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17b2 PSN 0x3e9914 OUT 0x10 RKey 0x183000 VAddr 0x007f8533000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17b3 PSN 0xedee47 OUT 0x10 RKey 0x183000 VAddr 0x007f8533800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17b4 PSN 0x2ea4a9 OUT 0x10 RKey 0x183000 VAddr 0x007f8534000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17b5 PSN 0xe7fc40 OUT 0x10 RKey 0x183000 VAddr 0x007f8534800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17b6 PSN 0xef901a OUT 0x10 RKey 0x183000 VAddr 0x007f8535000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17b7 PSN 0x20eadc OUT 0x10 RKey 0x183000 VAddr 0x007f8535800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17b8 PSN 0x682262 OUT 0x10 RKey 0x183000 VAddr 0x007f8536000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17b9 PSN 0x682630 OUT 0x10 RKey 0x183000 VAddr 0x007f8536800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17ba PSN 0xdd5a64 OUT 0x10 RKey 0x183000 VAddr 0x007f8537000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17bb PSN 0x65978e OUT 0x10 RKey 0x183000 VAddr 0x007f8537800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17bc PSN 0xee09c2 OUT 0x10 RKey 0x183000 VAddr 0x007f8538000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17bd PSN 0xe3981d OUT 0x10 RKey 0x183000 VAddr 0x007f8538800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17be PSN 0xa7846b OUT 0x10 RKey 0x183000 VAddr 0x007f8539000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17bf PSN 0xbb7945 OUT 0x10 RKey 0x183000 VAddr 0x007f8539800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17c0 PSN 0xa36cf8 OUT 0x10 RKey 0x183000 VAddr 0x007f853a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17c1 PSN 0x7ba49e OUT 0x10 RKey 0x183000 VAddr 0x007f853a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17c2 PSN 0x720f74 OUT 0x10 RKey 0x183000 VAddr 0x007f853b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17c3 PSN 0xc80e36 OUT 0x10 RKey 0x183000 VAddr 0x007f853b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17c4 PSN 0xeb4ec9 OUT 0x10 RKey 0x183000 VAddr 0x007f853c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17c5 PSN 0x8de22a OUT 0x10 RKey 0x183000 VAddr 0x007f853c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17c6 PSN 0x3c8ccd OUT 0x10 RKey 0x183000 VAddr 0x007f853d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17c7 PSN 0xdb8195 OUT 0x10 RKey 0x183000 VAddr 0x007f853d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17c8 PSN 0x331159 OUT 0x10 RKey 0x183000 VAddr 0x007f853e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17c9 PSN 0x66d31e OUT 0x10 RKey 0x183000 VAddr 0x007f853e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17ca PSN 0xbd72a5 OUT 0x10 RKey 0x183000 VAddr 0x007f853f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17cb PSN 0x87a867 OUT 0x10 RKey 0x183000 VAddr 0x007f853f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.077088            0.076181            4.761324
 4          32000            0.16               0.16   		     4.944124
 8          32000            0.32               0.32   		     4.946569
 16         32000            0.64               0.63   		     4.954373
 32         32000            1.27               1.27   		     4.962256
 64         32000            2.54               2.53   		     4.934305
 128        32000            5.09               5.06   		     4.940284
 256        32000            10.15              10.12  		     4.940078
 512        32000            20.34              20.27  		     4.948451
 1024       32000            40.60              40.44  		     4.936892
 2048       32000            80.84              80.63  		     4.921449
 4096       32000            140.70             126.46 		     3.859286
 8192       32000            207.98             207.77 		     3.170395
 16384      32000            209.01             208.87 		     1.593515
 32768      32000            209.22             209.17 		     0.797918
 65536      32000            209.12             209.11 		     0.398853
 131072     32000            209.21             209.21 		     0.199520
 262144     32000            209.25             209.24 		     0.099775
 524288     32000            209.23             209.23 		     0.049884
 1048576    32000            186.66             186.66 		     0.022251
 2097152    32000            171.30             171.30 		     0.010210
 4194304    32000            171.21             171.21 		     0.005103
 8388608    32000            171.23             171.23 		     0.002552
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fb2e0000000
destroying current CUDA Ctx
