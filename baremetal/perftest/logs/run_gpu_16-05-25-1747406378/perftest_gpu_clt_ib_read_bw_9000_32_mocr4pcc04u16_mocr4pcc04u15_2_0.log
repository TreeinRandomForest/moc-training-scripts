initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 62872, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f8080000000 pointer=0x7f8080000000
using DMA-BUF for GPU buffer address at 0x7f8080000000 aligned at 0x7f8080000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f8080000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x2202 PSN 0x99d1ba OUT 0x10 RKey 0x183000 VAddr 0x007f8090000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2203 PSN 0x2ad21c OUT 0x10 RKey 0x183000 VAddr 0x007f8090800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2204 PSN 0x421f36 OUT 0x10 RKey 0x183000 VAddr 0x007f8091000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2205 PSN 0x206d4d OUT 0x10 RKey 0x183000 VAddr 0x007f8091800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2206 PSN 0x6f6ddc OUT 0x10 RKey 0x183000 VAddr 0x007f8092000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2207 PSN 0x8dc40e OUT 0x10 RKey 0x183000 VAddr 0x007f8092800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2208 PSN 0x52cf55 OUT 0x10 RKey 0x183000 VAddr 0x007f8093000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2209 PSN 0xa9e12a OUT 0x10 RKey 0x183000 VAddr 0x007f8093800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x220a PSN 0x277486 OUT 0x10 RKey 0x183000 VAddr 0x007f8094000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x220b PSN 0xcb7e90 OUT 0x10 RKey 0x183000 VAddr 0x007f8094800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x220c PSN 0x2b78f4 OUT 0x10 RKey 0x183000 VAddr 0x007f8095000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x220d PSN 0x587877 OUT 0x10 RKey 0x183000 VAddr 0x007f8095800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x220e PSN 0xa32297 OUT 0x10 RKey 0x183000 VAddr 0x007f8096000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x220f PSN 0x94df8 OUT 0x10 RKey 0x183000 VAddr 0x007f8096800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2210 PSN 0x228756 OUT 0x10 RKey 0x183000 VAddr 0x007f8097000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2211 PSN 0xdcb362 OUT 0x10 RKey 0x183000 VAddr 0x007f8097800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2212 PSN 0x9ee7cf OUT 0x10 RKey 0x183000 VAddr 0x007f8098000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2213 PSN 0x2444dd OUT 0x10 RKey 0x183000 VAddr 0x007f8098800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2214 PSN 0xef1ef4 OUT 0x10 RKey 0x183000 VAddr 0x007f8099000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2215 PSN 0xd1ced1 OUT 0x10 RKey 0x183000 VAddr 0x007f8099800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2216 PSN 0x9b2e5e OUT 0x10 RKey 0x183000 VAddr 0x007f809a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2217 PSN 0x4c2dd5 OUT 0x10 RKey 0x183000 VAddr 0x007f809a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2218 PSN 0xae5915 OUT 0x10 RKey 0x183000 VAddr 0x007f809b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2219 PSN 0x7c80f9 OUT 0x10 RKey 0x183000 VAddr 0x007f809b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x221a PSN 0x15d106 OUT 0x10 RKey 0x183000 VAddr 0x007f809c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x221b PSN 0x5c9759 OUT 0x10 RKey 0x183000 VAddr 0x007f809c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x221c PSN 0xd25f06 OUT 0x10 RKey 0x183000 VAddr 0x007f809d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x221d PSN 0x87ad10 OUT 0x10 RKey 0x183000 VAddr 0x007f809d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x221e PSN 0x6c89ef OUT 0x10 RKey 0x183000 VAddr 0x007f809e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x221f PSN 0x77bc5 OUT 0x10 RKey 0x183000 VAddr 0x007f809e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2220 PSN 0x15bef7 OUT 0x10 RKey 0x183000 VAddr 0x007f809f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2221 PSN 0xd3601a OUT 0x10 RKey 0x183000 VAddr 0x007f809f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x2202 PSN 0xc5730c OUT 0x10 RKey 0x183100 VAddr 0x007f4430000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2203 PSN 0xbca13d OUT 0x10 RKey 0x183100 VAddr 0x007f4430800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2204 PSN 0x64830d OUT 0x10 RKey 0x183100 VAddr 0x007f4431000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2205 PSN 0x35a6a1 OUT 0x10 RKey 0x183100 VAddr 0x007f4431800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2206 PSN 0xe0c1d7 OUT 0x10 RKey 0x183100 VAddr 0x007f4432000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2207 PSN 0x2f94b7 OUT 0x10 RKey 0x183100 VAddr 0x007f4432800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2208 PSN 0x60a14 OUT 0x10 RKey 0x183100 VAddr 0x007f4433000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2209 PSN 0x5f0b47 OUT 0x10 RKey 0x183100 VAddr 0x007f4433800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x220a PSN 0x65fda9 OUT 0x10 RKey 0x183100 VAddr 0x007f4434000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x220b PSN 0x6ee140 OUT 0x10 RKey 0x183100 VAddr 0x007f4434800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x220c PSN 0x1d111a OUT 0x10 RKey 0x183100 VAddr 0x007f4435000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x220d PSN 0x66d7dc OUT 0x10 RKey 0x183100 VAddr 0x007f4435800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x220e PSN 0x1c0b62 OUT 0x10 RKey 0x183100 VAddr 0x007f4436000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x220f PSN 0x585b30 OUT 0x10 RKey 0x183100 VAddr 0x007f4436800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2210 PSN 0xc1eb64 OUT 0x10 RKey 0x183100 VAddr 0x007f4437000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2211 PSN 0xfd548e OUT 0x10 RKey 0x183100 VAddr 0x007f4437800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2212 PSN 0x5782c2 OUT 0x10 RKey 0x183100 VAddr 0x007f4438000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2213 PSN 0x821d1d OUT 0x10 RKey 0x183100 VAddr 0x007f4438800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2214 PSN 0xa4256b OUT 0x10 RKey 0x183100 VAddr 0x007f4439000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2215 PSN 0xf20645 OUT 0x10 RKey 0x183100 VAddr 0x007f4439800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2216 PSN 0x8b75f8 OUT 0x10 RKey 0x183100 VAddr 0x007f443a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2217 PSN 0x5d799e OUT 0x10 RKey 0x183100 VAddr 0x007f443a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2218 PSN 0xf7c074 OUT 0x10 RKey 0x183100 VAddr 0x007f443b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2219 PSN 0xba6b36 OUT 0x10 RKey 0x183100 VAddr 0x007f443b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x221a PSN 0xaae7c9 OUT 0x10 RKey 0x183100 VAddr 0x007f443c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x221b PSN 0x98072a OUT 0x10 RKey 0x183100 VAddr 0x007f443c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x221c PSN 0xcc4dcd OUT 0x10 RKey 0x183100 VAddr 0x007f443d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x221d PSN 0x76ae95 OUT 0x10 RKey 0x183100 VAddr 0x007f443d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x221e PSN 0xb33a59 OUT 0x10 RKey 0x183100 VAddr 0x007f443e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x221f PSN 0xce481e OUT 0x10 RKey 0x183100 VAddr 0x007f443e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2220 PSN 0xe843a5 OUT 0x10 RKey 0x183100 VAddr 0x007f443f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2221 PSN 0x88a567 OUT 0x10 RKey 0x183100 VAddr 0x007f443f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.055637            0.055504            3.469027
 4          32000            0.11               0.11   		     3.513715
 8          32000            0.23               0.23   		     3.534100
 16         32000            0.45               0.45   		     3.536842
 32         32000            0.91               0.90   		     3.534646
 64         32000            1.81               1.81   		     3.529192
 128        32000            3.62               3.59   		     3.505363
 256        32000            7.23               7.22   		     3.523651
 512        32000            14.49              14.45  		     3.526816
 1024       32000            28.89              28.82  		     3.518157
 2048       32000            57.07              56.79  		     3.466366
 4096       32000            115.92             97.62  		     2.979227
 8192       32000            179.82             136.03 		     2.075729
 16384      32000            186.77             160.03 		     1.220912
 32768      32000            197.99             197.97 		     0.755182
 65536      32000            197.96             197.95 		     0.377553
 131072     32000            197.98             197.97 		     0.188799
 262144     32000            195.18             195.18 		     0.093070
 524288     32000            196.77             196.77 		     0.046914
 1048576    32000            178.78             178.77 		     0.021312
 2097152    32000            163.88             163.88 		     0.009768
 4194304    32000            163.81             163.81 		     0.004882
 8388608    32000            163.78             163.78 		     0.002441
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f8080000000
destroying current CUDA Ctx
