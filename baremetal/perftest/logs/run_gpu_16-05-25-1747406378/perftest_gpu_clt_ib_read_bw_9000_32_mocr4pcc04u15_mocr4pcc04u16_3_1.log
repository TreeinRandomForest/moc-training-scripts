initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 54444, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fb6a0000000 pointer=0x7fb6a0000000
using DMA-BUF for GPU buffer address at 0x7fb6a0000000 aligned at 0x7fb6a0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fb6a0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1c98 PSN 0x40ddf8 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c99 PSN 0x72bc82 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c9a PSN 0x8090a4 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c9b PSN 0x78d23 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c9c PSN 0xba3ffa OUT 0x10 RKey 0x183100 VAddr 0x007fb6b2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c9d PSN 0xd82ed4 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c9e PSN 0x7829a3 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c9f PSN 0x9b6860 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ca0 PSN 0x408a84 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ca1 PSN 0x640fb6 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ca2 PSN 0x916a22 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ca3 PSN 0xd77d0d OUT 0x10 RKey 0x183100 VAddr 0x007fb6b5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ca4 PSN 0x1eda75 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ca5 PSN 0x900b7e OUT 0x10 RKey 0x183100 VAddr 0x007fb6b6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ca6 PSN 0x4f9d64 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ca7 PSN 0xc7ab58 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ca8 PSN 0x397f8d OUT 0x10 RKey 0x183100 VAddr 0x007fb6b8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ca9 PSN 0x7394c3 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1caa PSN 0x84c7e2 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1cab PSN 0xb89027 OUT 0x10 RKey 0x183100 VAddr 0x007fb6b9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1cac PSN 0xd6c3fc OUT 0x10 RKey 0x183100 VAddr 0x007fb6ba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1cad PSN 0xbed61b OUT 0x10 RKey 0x183100 VAddr 0x007fb6ba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1cae PSN 0x36e2e3 OUT 0x10 RKey 0x183100 VAddr 0x007fb6bb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1caf PSN 0x5641af OUT 0x10 RKey 0x183100 VAddr 0x007fb6bb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1cb0 PSN 0xb86284 OUT 0x10 RKey 0x183100 VAddr 0x007fb6bc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1cb1 PSN 0x73bdff OUT 0x10 RKey 0x183100 VAddr 0x007fb6bc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1cb2 PSN 0x6ef7b4 OUT 0x10 RKey 0x183100 VAddr 0x007fb6bd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1cb3 PSN 0xc90326 OUT 0x10 RKey 0x183100 VAddr 0x007fb6bd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1cb4 PSN 0xddf54d OUT 0x10 RKey 0x183100 VAddr 0x007fb6be000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1cb5 PSN 0x70a6cb OUT 0x10 RKey 0x183100 VAddr 0x007fb6be800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1cb6 PSN 0xc7485 OUT 0x10 RKey 0x183100 VAddr 0x007fb6bf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1cb7 PSN 0xe44190 OUT 0x10 RKey 0x183100 VAddr 0x007fb6bf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1c98 PSN 0x400ee9 OUT 0x10 RKey 0x183000 VAddr 0x007f7eb0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c99 PSN 0x3f191f OUT 0x10 RKey 0x183000 VAddr 0x007f7eb0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c9a PSN 0x750d7d OUT 0x10 RKey 0x183000 VAddr 0x007f7eb1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c9b PSN 0x57ab88 OUT 0x10 RKey 0x183000 VAddr 0x007f7eb1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c9c PSN 0x41eefb OUT 0x10 RKey 0x183000 VAddr 0x007f7eb2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c9d PSN 0xc49841 OUT 0x10 RKey 0x183000 VAddr 0x007f7eb2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c9e PSN 0x54fb0c OUT 0x10 RKey 0x183000 VAddr 0x007f7eb3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c9f PSN 0x90e815 OUT 0x10 RKey 0x183000 VAddr 0x007f7eb3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ca0 PSN 0x608895 OUT 0x10 RKey 0x183000 VAddr 0x007f7eb4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ca1 PSN 0xf282f3 OUT 0x10 RKey 0x183000 VAddr 0x007f7eb4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ca2 PSN 0xfd491b OUT 0x10 RKey 0x183000 VAddr 0x007f7eb5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ca3 PSN 0xa52312 OUT 0x10 RKey 0x183000 VAddr 0x007f7eb5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ca4 PSN 0x730896 OUT 0x10 RKey 0x183000 VAddr 0x007f7eb6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ca5 PSN 0x45558b OUT 0x10 RKey 0x183000 VAddr 0x007f7eb6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ca6 PSN 0x3d2ed OUT 0x10 RKey 0x183000 VAddr 0x007f7eb7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ca7 PSN 0xe78cad OUT 0x10 RKey 0x183000 VAddr 0x007f7eb7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ca8 PSN 0x9acebe OUT 0x10 RKey 0x183000 VAddr 0x007f7eb8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ca9 PSN 0x3452a0 OUT 0x10 RKey 0x183000 VAddr 0x007f7eb8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1caa PSN 0xe62cfb OUT 0x10 RKey 0x183000 VAddr 0x007f7eb9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1cab PSN 0x1111cc OUT 0x10 RKey 0x183000 VAddr 0x007f7eb9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1cac PSN 0x1c353d OUT 0x10 RKey 0x183000 VAddr 0x007f7eba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1cad PSN 0xfc74c8 OUT 0x10 RKey 0x183000 VAddr 0x007f7eba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1cae PSN 0x7ee08c OUT 0x10 RKey 0x183000 VAddr 0x007f7ebb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1caf PSN 0xaf18a4 OUT 0x10 RKey 0x183000 VAddr 0x007f7ebb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1cb0 PSN 0x8806d5 OUT 0x10 RKey 0x183000 VAddr 0x007f7ebc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1cb1 PSN 0x297a7c OUT 0x10 RKey 0x183000 VAddr 0x007f7ebc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1cb2 PSN 0x6486ed OUT 0x10 RKey 0x183000 VAddr 0x007f7ebd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1cb3 PSN 0x90346b OUT 0x10 RKey 0x183000 VAddr 0x007f7ebd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1cb4 PSN 0x8dedae OUT 0x10 RKey 0x183000 VAddr 0x007f7ebe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1cb5 PSN 0xf08e18 OUT 0x10 RKey 0x183000 VAddr 0x007f7ebe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1cb6 PSN 0x4d1e4e OUT 0x10 RKey 0x183000 VAddr 0x007f7ebf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1cb7 PSN 0x432225 OUT 0x10 RKey 0x183000 VAddr 0x007f7ebf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.058347            0.058198            3.637397
 4          32000            0.12               0.12   		     3.719594
 8          32000            0.24               0.24   		     3.717975
 16         32000            0.48               0.47   		     3.708511
 32         32000            0.95               0.95   		     3.696764
 64         32000            1.91               1.90   		     3.713128
 128        32000            3.80               3.79   		     3.703755
 256        32000            7.67               7.65   		     3.737126
 512        32000            15.41              15.32  		     3.741360
 1024       32000            31.03              30.96  		     3.779173
 2048       32000            62.38              62.03  		     3.785764
 4096       32000            130.26             129.12 		     3.940484
 8192       32000            196.61             196.41 		     2.996965
 16384      32000            197.27             197.20 		     1.504505
 32768      32000            197.33             197.28 		     0.752553
 65536      32000            197.23             197.23 		     0.376190
 131072     32000            197.35             197.35 		     0.188203
 262144     32000            197.37             197.37 		     0.094112
 524288     32000            197.41             197.40 		     0.047065
 1048576    32000            178.29             178.29 		     0.021254
 2097152    32000            163.74             163.74 		     0.009760
 4194304    32000            163.70             163.70 		     0.004879
 8388608    32000            163.68             163.68 		     0.002439
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fb6a0000000
destroying current CUDA Ctx
