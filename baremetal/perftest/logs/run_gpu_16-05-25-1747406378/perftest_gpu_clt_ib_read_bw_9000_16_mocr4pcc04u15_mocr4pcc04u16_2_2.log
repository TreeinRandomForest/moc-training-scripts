initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 52343, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f3b54000000 pointer=0x7f3b54000000
using DMA-BUF for GPU buffer address at 0x7f3b54000000 aligned at 0x7f3b54000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f3b54000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1b0e PSN 0x559611 OUT 0x10 RKey 0x183000 VAddr 0x007f3b5c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b0f PSN 0xb79527 OUT 0x10 RKey 0x183000 VAddr 0x007f3b5c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b10 PSN 0x910ce5 OUT 0x10 RKey 0x183000 VAddr 0x007f3b5d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b11 PSN 0x9adad0 OUT 0x10 RKey 0x183000 VAddr 0x007f3b5d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b12 PSN 0xb7c0a3 OUT 0x10 RKey 0x183000 VAddr 0x007f3b5e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b13 PSN 0x2bccc9 OUT 0x10 RKey 0x183000 VAddr 0x007f3b5e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b14 PSN 0xd888f4 OUT 0x10 RKey 0x183000 VAddr 0x007f3b5f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b15 PSN 0xf2c3dd OUT 0x10 RKey 0x183000 VAddr 0x007f3b5f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b16 PSN 0xe0ccbd OUT 0x10 RKey 0x183000 VAddr 0x007f3b60000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b17 PSN 0xab77fb OUT 0x10 RKey 0x183000 VAddr 0x007f3b60800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b18 PSN 0x42cd83 OUT 0x10 RKey 0x183000 VAddr 0x007f3b61000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b19 PSN 0x13f35a OUT 0x10 RKey 0x183000 VAddr 0x007f3b61800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b1a PSN 0x22673e OUT 0x10 RKey 0x183000 VAddr 0x007f3b62000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b1b PSN 0xdb9313 OUT 0x10 RKey 0x183000 VAddr 0x007f3b62800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b1c PSN 0xa435d5 OUT 0x10 RKey 0x183000 VAddr 0x007f3b63000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b1d PSN 0xee1975 OUT 0x10 RKey 0x183000 VAddr 0x007f3b63800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1b0e PSN 0xf9541e OUT 0x10 RKey 0x182f00 VAddr 0x007f5e4a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b0f PSN 0x2b2eb0 OUT 0x10 RKey 0x182f00 VAddr 0x007f5e4a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b10 PSN 0x6823a OUT 0x10 RKey 0x182f00 VAddr 0x007f5e4b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b11 PSN 0x642e01 OUT 0x10 RKey 0x182f00 VAddr 0x007f5e4b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b12 PSN 0x5a3280 OUT 0x10 RKey 0x182f00 VAddr 0x007f5e4c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b13 PSN 0x5ed5e2 OUT 0x10 RKey 0x182f00 VAddr 0x007f5e4c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b14 PSN 0xcbde99 OUT 0x10 RKey 0x182f00 VAddr 0x007f5e4d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b15 PSN 0x9c791e OUT 0x10 RKey 0x182f00 VAddr 0x007f5e4d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b16 PSN 0xe75f6a OUT 0x10 RKey 0x182f00 VAddr 0x007f5e4e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b17 PSN 0xbb59a4 OUT 0x10 RKey 0x182f00 VAddr 0x007f5e4e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b18 PSN 0x8fb878 OUT 0x10 RKey 0x182f00 VAddr 0x007f5e4f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b19 PSN 0xc81bab OUT 0x10 RKey 0x182f00 VAddr 0x007f5e4f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b1a PSN 0xbc57bb OUT 0x10 RKey 0x182f00 VAddr 0x007f5e50000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b1b PSN 0xb3464c OUT 0x10 RKey 0x182f00 VAddr 0x007f5e50800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b1c PSN 0xcbb1a OUT 0x10 RKey 0x182f00 VAddr 0x007f5e51000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b1d PSN 0xc6d5d6 OUT 0x10 RKey 0x182f00 VAddr 0x007f5e51800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.057971            0.057671            3.604448
 4          16000            0.12               0.12   		     3.688234
 8          16000            0.24               0.24   		     3.684064
 16         16000            0.47               0.47   		     3.684697
 32         16000            0.95               0.94   		     3.679776
 64         16000            1.89               1.88   		     3.672597
 128        16000            3.78               3.75   		     3.660339
 256        16000            7.55               7.51   		     3.666428
 512        16000            15.13              15.05  		     3.674250
 1024       16000            30.17              30.01  		     3.663851
 2048       16000            60.24              60.10  		     3.668084
 4096       16000            120.47             119.83 		     3.656792
 8192       16000            196.09             195.72 		     2.986401
 16384      16000            197.66             197.62 		     1.507733
 32768      16000            198.06             198.01 		     0.755352
 65536      16000            198.09             198.07 		     0.377793
 131072     16000            198.16             198.15 		     0.188969
 262144     16000            198.18             198.18 		     0.094498
 524288     16000            198.22             198.22 		     0.047258
 1048576    16000            198.20             198.20 		     0.023627
 2097152    16000            183.93             183.93 		     0.010963
 4194304    16000            163.76             163.76 		     0.004880
 8388608    16000            163.73             163.73 		     0.002440
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f3b54000000
destroying current CUDA Ctx
