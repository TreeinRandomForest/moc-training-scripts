initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 47381, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007fae2e000000 pointer=0x7fae2e000000
using DMA-BUF for GPU buffer address at 0x7fae2e000000 aligned at 0x7fae2e000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7fae2e000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x179c PSN 0x481bb4 OUT 0x10 RKey 0x183000 VAddr 0x007fae36000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x179d PSN 0x4eed8e OUT 0x10 RKey 0x183000 VAddr 0x007fae36800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x179e PSN 0x623ac0 OUT 0x10 RKey 0x183000 VAddr 0x007fae37000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x179f PSN 0xc2230f OUT 0x10 RKey 0x183000 VAddr 0x007fae37800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17a0 PSN 0x6e1d76 OUT 0x10 RKey 0x183000 VAddr 0x007fae38000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17a1 PSN 0xbae4a0 OUT 0x10 RKey 0x183000 VAddr 0x007fae38800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17a2 PSN 0x64d97f OUT 0x10 RKey 0x183000 VAddr 0x007fae39000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17a3 PSN 0x31f10c OUT 0x10 RKey 0x183000 VAddr 0x007fae39800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17a4 PSN 0xb343c0 OUT 0x10 RKey 0x183000 VAddr 0x007fae3a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17a5 PSN 0xf8d642 OUT 0x10 RKey 0x183000 VAddr 0x007fae3a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17a6 PSN 0x5bbbbe OUT 0x10 RKey 0x183000 VAddr 0x007fae3b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17a7 PSN 0x1e6479 OUT 0x10 RKey 0x183000 VAddr 0x007fae3b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17a8 PSN 0xca6b71 OUT 0x10 RKey 0x183000 VAddr 0x007fae3c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17a9 PSN 0x2f2eca OUT 0x10 RKey 0x183000 VAddr 0x007fae3c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17aa PSN 0xd7ecc0 OUT 0x10 RKey 0x183000 VAddr 0x007fae3d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x17ab PSN 0xee1d84 OUT 0x10 RKey 0x183000 VAddr 0x007fae3d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x179c PSN 0x6c3588 OUT 0x10 RKey 0x182f00 VAddr 0x007fd716000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x179d PSN 0x5264d2 OUT 0x10 RKey 0x182f00 VAddr 0x007fd716800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x179e PSN 0xb31ab4 OUT 0x10 RKey 0x182f00 VAddr 0x007fd717000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x179f PSN 0x56b5f3 OUT 0x10 RKey 0x182f00 VAddr 0x007fd717800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17a0 PSN 0xd9808a OUT 0x10 RKey 0x182f00 VAddr 0x007fd718000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17a1 PSN 0xe80c24 OUT 0x10 RKey 0x182f00 VAddr 0x007fd718800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17a2 PSN 0xcf44b3 OUT 0x10 RKey 0x182f00 VAddr 0x007fd719000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17a3 PSN 0xc24e30 OUT 0x10 RKey 0x182f00 VAddr 0x007fd719800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17a4 PSN 0x94414 OUT 0x10 RKey 0x182f00 VAddr 0x007fd71a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17a5 PSN 0x527206 OUT 0x10 RKey 0x182f00 VAddr 0x007fd71a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17a6 PSN 0x252632 OUT 0x10 RKey 0x182f00 VAddr 0x007fd71b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17a7 PSN 0x74efdd OUT 0x10 RKey 0x182f00 VAddr 0x007fd71b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17a8 PSN 0xf9d05 OUT 0x10 RKey 0x182f00 VAddr 0x007fd71c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17a9 PSN 0xa042ce OUT 0x10 RKey 0x182f00 VAddr 0x007fd71c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17aa PSN 0xa90a74 OUT 0x10 RKey 0x182f00 VAddr 0x007fd71d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x17ab PSN 0x977b28 OUT 0x10 RKey 0x182f00 VAddr 0x007fd71d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.073171            0.071671            4.479446
 4          16000            0.16               0.16   		     4.921926
 8          16000            0.32               0.31   		     4.906245
 16         16000            0.63               0.63   		     4.917207
 32         16000            1.26               1.26   		     4.904696
 64         16000            2.52               2.51   		     4.905568
 128        16000            5.02               5.00   		     4.880146
 256        16000            10.13              10.08  		     4.920291
 512        16000            20.21              20.10  		     4.907945
 1024       16000            40.33              40.19  		     4.905658
 2048       16000            80.31              79.91  		     4.877350
 4096       16000            160.28             159.65 		     4.872211
 8192       16000            206.23             204.74 		     3.124073
 16384      16000            208.71             208.69 		     1.592149
 32768      16000            209.16             209.13 		     0.797763
 65536      16000            209.34             209.31 		     0.399231
 131072     16000            209.32             209.32 		     0.199625
 262144     16000            209.38             209.38 		     0.099839
 524288     16000            209.42             209.42 		     0.049929
 1048576    16000            209.45             209.45 		     0.024968
 2097152    16000            192.44             192.44 		     0.011470
 4194304    16000            171.07             171.07 		     0.005098
 8388608    16000            171.08             171.07 		     0.002549
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fae2e000000
destroying current CUDA Ctx
