initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 62136, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f72e6000000 pointer=0x7f72e6000000
using DMA-BUF for GPU buffer address at 0x7f72e6000000 aligned at 0x7f72e6000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f72e6000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x2174 PSN 0xc362ba OUT 0x10 RKey 0x182f00 VAddr 0x007f72ee000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2175 PSN 0x238f1c OUT 0x10 RKey 0x182f00 VAddr 0x007f72ee800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2176 PSN 0xf89836 OUT 0x10 RKey 0x182f00 VAddr 0x007f72ef000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2177 PSN 0x87f24d OUT 0x10 RKey 0x182f00 VAddr 0x007f72ef800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2178 PSN 0x10edc OUT 0x10 RKey 0x182f00 VAddr 0x007f72f0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2179 PSN 0x35510e OUT 0x10 RKey 0x182f00 VAddr 0x007f72f0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x217a PSN 0x57d855 OUT 0x10 RKey 0x182f00 VAddr 0x007f72f1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x217b PSN 0xe4b62a OUT 0x10 RKey 0x182f00 VAddr 0x007f72f1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x217c PSN 0x922586 OUT 0x10 RKey 0x182f00 VAddr 0x007f72f2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x217d PSN 0x3edb90 OUT 0x10 RKey 0x182f00 VAddr 0x007f72f2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x217e PSN 0xd811f4 OUT 0x10 RKey 0x182f00 VAddr 0x007f72f3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x217f PSN 0x4b9d77 OUT 0x10 RKey 0x182f00 VAddr 0x007f72f3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2180 PSN 0x67e397 OUT 0x10 RKey 0x182f00 VAddr 0x007f72f4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2181 PSN 0x357af8 OUT 0x10 RKey 0x182f00 VAddr 0x007f72f4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2182 PSN 0x5fb056 OUT 0x10 RKey 0x182f00 VAddr 0x007f72f5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2183 PSN 0xbd2862 OUT 0x10 RKey 0x182f00 VAddr 0x007f72f5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x2174 PSN 0x8a19a6 OUT 0x10 RKey 0x183000 VAddr 0x007fb290000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2175 PSN 0xa77998 OUT 0x10 RKey 0x183000 VAddr 0x007fb290800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2176 PSN 0x1ed702 OUT 0x10 RKey 0x183000 VAddr 0x007fb291000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2177 PSN 0x4bf729 OUT 0x10 RKey 0x183000 VAddr 0x007fb291800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2178 PSN 0xa4c888 OUT 0x10 RKey 0x183000 VAddr 0x007fb292000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2179 PSN 0x4be74a OUT 0x10 RKey 0x183000 VAddr 0x007fb292800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x217a PSN 0x3fb7e1 OUT 0x10 RKey 0x183000 VAddr 0x007fb293000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x217b PSN 0x86acc6 OUT 0x10 RKey 0x183000 VAddr 0x007fb293800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x217c PSN 0xe84df2 OUT 0x10 RKey 0x183000 VAddr 0x007fb294000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x217d PSN 0xcf198c OUT 0x10 RKey 0x183000 VAddr 0x007fb294800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x217e PSN 0x42de40 OUT 0x10 RKey 0x183000 VAddr 0x007fb295000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x217f PSN 0x60e1d3 OUT 0x10 RKey 0x183000 VAddr 0x007fb295800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2180 PSN 0xb0a6c3 OUT 0x10 RKey 0x183000 VAddr 0x007fb296000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2181 PSN 0x1a1cb4 OUT 0x10 RKey 0x183000 VAddr 0x007fb296800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2182 PSN 0x577562 OUT 0x10 RKey 0x183000 VAddr 0x007fb297000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2183 PSN 0x54d67e OUT 0x10 RKey 0x183000 VAddr 0x007fb297800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.055814            0.055578            3.473602
 4          16000            0.11               0.11   		     3.523655
 8          16000            0.23               0.23   		     3.523585
 16         16000            0.45               0.45   		     3.526614
 32         16000            0.91               0.90   		     3.527850
 64         16000            1.81               1.80   		     3.519918
 128        16000            3.61               3.59   		     3.510011
 256        16000            7.23               7.20   		     3.517957
 512        16000            14.47              14.41  		     3.518455
 1024       16000            28.85              28.57  		     3.487624
 2048       16000            57.06              56.65  		     3.457420
 4096       16000            115.74             115.62 		     3.528356
 8192       16000            199.00             198.90 		     3.034947
 16384      16000            200.62             200.58 		     1.530342
 32768      16000            200.96             200.93 		     0.766492
 65536      16000            198.49             198.47 		     0.378554
 131072     16000            202.29             202.28 		     0.192906
 262144     16000            202.59             202.59 		     0.096604
 524288     16000            201.48             201.47 		     0.048035
 1048576    16000            200.49             200.49 		     0.023901
 2097152    16000            188.41             188.41 		     0.011230
 4194304    16000            168.74             167.19 		     0.004983
 8388608    16000            167.62             167.50 		     0.002496
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f72e6000000
destroying current CUDA Ctx
