initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 62192, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fc5a0000000 pointer=0x7fc5a0000000
using DMA-BUF for GPU buffer address at 0x7fc5a0000000 aligned at 0x7fc5a0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fc5a0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x2184 PSN 0x7db8ae OUT 0x10 RKey 0x183000 VAddr 0x007fc5b0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2185 PSN 0xa36000 OUT 0x10 RKey 0x183000 VAddr 0x007fc5b0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2186 PSN 0x41614a OUT 0x10 RKey 0x183000 VAddr 0x007fc5b1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2187 PSN 0x9d87d1 OUT 0x10 RKey 0x183000 VAddr 0x007fc5b1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2188 PSN 0x365010 OUT 0x10 RKey 0x183000 VAddr 0x007fc5b2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2189 PSN 0x66cc32 OUT 0x10 RKey 0x183000 VAddr 0x007fc5b2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x218a PSN 0x3b9ea9 OUT 0x10 RKey 0x183000 VAddr 0x007fc5b3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x218b PSN 0x7f9fee OUT 0x10 RKey 0x183000 VAddr 0x007fc5b3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x218c PSN 0x3dc5fa OUT 0x10 RKey 0x183000 VAddr 0x007fc5b4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x218d PSN 0x6a64f4 OUT 0x10 RKey 0x183000 VAddr 0x007fc5b4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x218e PSN 0x16988 OUT 0x10 RKey 0x183000 VAddr 0x007fc5b5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x218f PSN 0x4df7b OUT 0x10 RKey 0x183000 VAddr 0x007fc5b5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2190 PSN 0x48974b OUT 0x10 RKey 0x183000 VAddr 0x007fc5b6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2191 PSN 0x45b69c OUT 0x10 RKey 0x183000 VAddr 0x007fc5b6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2192 PSN 0xe6d2a OUT 0x10 RKey 0x183000 VAddr 0x007fc5b7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2193 PSN 0x3a06a6 OUT 0x10 RKey 0x183000 VAddr 0x007fc5b7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2194 PSN 0xda73c3 OUT 0x10 RKey 0x183000 VAddr 0x007fc5b8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2195 PSN 0x2c13c1 OUT 0x10 RKey 0x183000 VAddr 0x007fc5b8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2196 PSN 0x530e08 OUT 0x10 RKey 0x183000 VAddr 0x007fc5b9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2197 PSN 0x9a9255 OUT 0x10 RKey 0x183000 VAddr 0x007fc5b9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2198 PSN 0x6f0592 OUT 0x10 RKey 0x183000 VAddr 0x007fc5ba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2199 PSN 0xc786f9 OUT 0x10 RKey 0x183000 VAddr 0x007fc5ba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x219a PSN 0x79a569 OUT 0x10 RKey 0x183000 VAddr 0x007fc5bb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x219b PSN 0xf78bd OUT 0x10 RKey 0x183000 VAddr 0x007fc5bb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x219c PSN 0xf3677a OUT 0x10 RKey 0x183000 VAddr 0x007fc5bc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x219d PSN 0xd1debd OUT 0x10 RKey 0x183000 VAddr 0x007fc5bc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x219e PSN 0x159c9a OUT 0x10 RKey 0x183000 VAddr 0x007fc5bd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x219f PSN 0xebdd14 OUT 0x10 RKey 0x183000 VAddr 0x007fc5bd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21a0 PSN 0xe893a3 OUT 0x10 RKey 0x183000 VAddr 0x007fc5be000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21a1 PSN 0x7f5569 OUT 0x10 RKey 0x183000 VAddr 0x007fc5be800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21a2 PSN 0xd6c1cb OUT 0x10 RKey 0x183000 VAddr 0x007fc5bf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21a3 PSN 0xfc0c5e OUT 0x10 RKey 0x183000 VAddr 0x007fc5bf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x2184 PSN 0x1b3c82 OUT 0x10 RKey 0x183100 VAddr 0x007fd8b0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2185 PSN 0x94f944 OUT 0x10 RKey 0x183100 VAddr 0x007fd8b0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2186 PSN 0x82bb3e OUT 0x10 RKey 0x183100 VAddr 0x007fd8b1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2187 PSN 0x320cb5 OUT 0x10 RKey 0x183100 VAddr 0x007fd8b1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2188 PSN 0x7bd24 OUT 0x10 RKey 0x183100 VAddr 0x007fd8b2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2189 PSN 0x235b6 OUT 0x10 RKey 0x183100 VAddr 0x007fd8b2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x218a PSN 0xe423dd OUT 0x10 RKey 0x183100 VAddr 0x007fd8b3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x218b PSN 0xdd0f12 OUT 0x10 RKey 0x183100 VAddr 0x007fd8b3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x218c PSN 0x10704e OUT 0x10 RKey 0x183100 VAddr 0x007fd8b4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x218d PSN 0x9462b8 OUT 0x10 RKey 0x183100 VAddr 0x007fd8b4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x218e PSN 0x908dfc OUT 0x10 RKey 0x183100 VAddr 0x007fd8b5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x218f PSN 0xa79cdf OUT 0x10 RKey 0x183100 VAddr 0x007fd8b5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2190 PSN 0xeb12df OUT 0x10 RKey 0x183100 VAddr 0x007fd8b6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2191 PSN 0xeb4ca0 OUT 0x10 RKey 0x183100 VAddr 0x007fd8b6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2192 PSN 0x6e4de OUT 0x10 RKey 0x183100 VAddr 0x007fd8b7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2193 PSN 0x80b64a OUT 0x10 RKey 0x183100 VAddr 0x007fd8b7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2194 PSN 0xf09497 OUT 0x10 RKey 0x183100 VAddr 0x007fd8b8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2195 PSN 0x868605 OUT 0x10 RKey 0x183100 VAddr 0x007fd8b8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2196 PSN 0x2eccfc OUT 0x10 RKey 0x183100 VAddr 0x007fd8b9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2197 PSN 0xaa1839 OUT 0x10 RKey 0x183100 VAddr 0x007fd8b9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2198 PSN 0x85dfa6 OUT 0x10 RKey 0x183100 VAddr 0x007fd8ba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2199 PSN 0xe0597d OUT 0x10 RKey 0x183100 VAddr 0x007fd8ba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x219a PSN 0xdddf9d OUT 0x10 RKey 0x183100 VAddr 0x007fd8bb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x219b PSN 0xf6f8e1 OUT 0x10 RKey 0x183100 VAddr 0x007fd8bb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x219c PSN 0xd54ece OUT 0x10 RKey 0x183100 VAddr 0x007fd8bc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x219d PSN 0x46d581 OUT 0x10 RKey 0x183100 VAddr 0x007fd8bc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x219e PSN 0x46c60e OUT 0x10 RKey 0x183100 VAddr 0x007fd8bd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x219f PSN 0x8bb78 OUT 0x10 RKey 0x183100 VAddr 0x007fd8bd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21a0 PSN 0x311c37 OUT 0x10 RKey 0x183100 VAddr 0x007fd8be000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21a1 PSN 0x86746d OUT 0x10 RKey 0x183100 VAddr 0x007fd8be800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21a2 PSN 0x6c8e7f OUT 0x10 RKey 0x183100 VAddr 0x007fd8bf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21a3 PSN 0x9ded02 OUT 0x10 RKey 0x183100 VAddr 0x007fd8bf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.080000            0.078955            4.934715
 4          32000            0.16               0.16   		     5.095858
 8          32000            0.33               0.33   		     5.106755
 16         32000            0.66               0.66   		     5.121721
 32         32000            1.32               1.31   		     5.106274
 64         32000            2.63               2.62   		     5.115237
 128        32000            5.25               5.23   		     5.103408
 256        32000            10.50              10.46  		     5.107383
 512        32000            20.99              20.88  		     5.098472
 1024       32000            41.99              41.86  		     5.110180
 2048       32000            83.59              83.12  		     5.073318
 4096       32000            167.56             166.86 		     5.092120
 8192       32000            199.53             199.29 		     3.040880
 16384      32000            200.76             200.66 		     1.530900
 32768      32000            196.35             196.29 		     0.748792
 65536      32000            199.00             198.98 		     0.379516
 131072     32000            199.59             199.57 		     0.190327
 262144     32000            201.39             201.39 		     0.096029
 524288     32000            202.33             202.33 		     0.048240
 1048576    32000            181.10             181.10 		     0.021589
 2097152    32000            167.59             167.55 		     0.009987
 4194304    32000            167.41             167.41 		     0.004989
 8388608    32000            167.10             167.09 		     0.002490
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fc5a0000000
destroying current CUDA Ctx
