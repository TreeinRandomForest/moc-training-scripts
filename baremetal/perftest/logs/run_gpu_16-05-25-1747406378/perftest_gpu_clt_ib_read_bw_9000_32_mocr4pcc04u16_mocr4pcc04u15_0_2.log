initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 58765, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f05a0000000 pointer=0x7f05a0000000
using DMA-BUF for GPU buffer address at 0x7f05a0000000 aligned at 0x7f05a0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f05a0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1f0e PSN 0x13738c OUT 0x10 RKey 0x183000 VAddr 0x007f05b0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f0f PSN 0x65d7bd OUT 0x10 RKey 0x183000 VAddr 0x007f05b0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f10 PSN 0x67b78d OUT 0x10 RKey 0x183000 VAddr 0x007f05b1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f11 PSN 0xbe0121 OUT 0x10 RKey 0x183000 VAddr 0x007f05b1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f12 PSN 0x3e4a57 OUT 0x10 RKey 0x183000 VAddr 0x007f05b2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f13 PSN 0xa5b337 OUT 0x10 RKey 0x183000 VAddr 0x007f05b2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f14 PSN 0xb80694 OUT 0x10 RKey 0x183000 VAddr 0x007f05b3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f15 PSN 0x28dc7 OUT 0x10 RKey 0x183000 VAddr 0x007f05b3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f16 PSN 0x438e29 OUT 0x10 RKey 0x183000 VAddr 0x007f05b4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f17 PSN 0x9867c0 OUT 0x10 RKey 0x183000 VAddr 0x007f05b4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f18 PSN 0xa2559a OUT 0x10 RKey 0x183000 VAddr 0x007f05b5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f19 PSN 0xb0025c OUT 0x10 RKey 0x183000 VAddr 0x007f05b5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f1a PSN 0x7223e2 OUT 0x10 RKey 0x183000 VAddr 0x007f05b6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f1b PSN 0x3c9b0 OUT 0x10 RKey 0x183000 VAddr 0x007f05b6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f1c PSN 0x6f7e4 OUT 0x10 RKey 0x183000 VAddr 0x007f05b7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f1d PSN 0x9ea70e OUT 0x10 RKey 0x183000 VAddr 0x007f05b7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f1e PSN 0x26a342 OUT 0x10 RKey 0x183000 VAddr 0x007f05b8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f1f PSN 0xe5f39d OUT 0x10 RKey 0x183000 VAddr 0x007f05b8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f20 PSN 0xdd79eb OUT 0x10 RKey 0x183000 VAddr 0x007f05b9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f21 PSN 0x4600c5 OUT 0x10 RKey 0x183000 VAddr 0x007f05b9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f22 PSN 0x5c1e78 OUT 0x10 RKey 0x183000 VAddr 0x007f05ba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f23 PSN 0x98381e OUT 0x10 RKey 0x183000 VAddr 0x007f05ba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f24 PSN 0x21dcf4 OUT 0x10 RKey 0x183000 VAddr 0x007f05bb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f25 PSN 0x438db6 OUT 0x10 RKey 0x183000 VAddr 0x007f05bb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f26 PSN 0xd9849 OUT 0x10 RKey 0x183000 VAddr 0x007f05bc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f27 PSN 0x302daa OUT 0x10 RKey 0x183000 VAddr 0x007f05bc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f28 PSN 0x2bb24d OUT 0x10 RKey 0x183000 VAddr 0x007f05bd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f29 PSN 0x5f7915 OUT 0x10 RKey 0x183000 VAddr 0x007f05bd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f2a PSN 0xc072d9 OUT 0x10 RKey 0x183000 VAddr 0x007f05be000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f2b PSN 0x32569e OUT 0x10 RKey 0x183000 VAddr 0x007f05be800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f2c PSN 0x897025 OUT 0x10 RKey 0x183000 VAddr 0x007f05bf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1f2d PSN 0x2397e7 OUT 0x10 RKey 0x183000 VAddr 0x007f05bf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1f0e PSN 0x3e1203 OUT 0x10 RKey 0x183100 VAddr 0x007f7110000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f0f PSN 0x9e3a68 OUT 0x10 RKey 0x183100 VAddr 0x007f7110800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f10 PSN 0xb35c5c OUT 0x10 RKey 0x183100 VAddr 0x007f7111000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f11 PSN 0xd92744 OUT 0x10 RKey 0x183100 VAddr 0x007f7111800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f12 PSN 0x54f93e OUT 0x10 RKey 0x183100 VAddr 0x007f7112000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f13 PSN 0x65b592 OUT 0x10 RKey 0x183100 VAddr 0x007f7112800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f14 PSN 0x7ac953 OUT 0x10 RKey 0x183100 VAddr 0x007f7113000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f15 PSN 0xfb131a OUT 0x10 RKey 0x183100 VAddr 0x007f7113800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f16 PSN 0x60e480 OUT 0x10 RKey 0x183100 VAddr 0x007f7114000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f17 PSN 0xdc54cb OUT 0x10 RKey 0x183100 VAddr 0x007f7114800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f18 PSN 0xaa2549 OUT 0x10 RKey 0x183100 VAddr 0x007f7115000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f19 PSN 0xeea9df OUT 0x10 RKey 0x183100 VAddr 0x007f7115800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f1a PSN 0x6328a9 OUT 0x10 RKey 0x183100 VAddr 0x007f7116000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f1b PSN 0x619c6b OUT 0x10 RKey 0x183100 VAddr 0x007f7116800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f1c PSN 0xb1b383 OUT 0x10 RKey 0x183100 VAddr 0x007f7117000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f1d PSN 0x7563c1 OUT 0x10 RKey 0x183100 VAddr 0x007f7117800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f1e PSN 0x21cd79 OUT 0x10 RKey 0x183100 VAddr 0x007f7118000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f1f PSN 0x785708 OUT 0x10 RKey 0x183100 VAddr 0x007f7118800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f20 PSN 0x27f07a OUT 0x10 RKey 0x183100 VAddr 0x007f7119000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f21 PSN 0x52f5a8 OUT 0x10 RKey 0x183100 VAddr 0x007f7119800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f22 PSN 0x28551f OUT 0x10 RKey 0x183100 VAddr 0x007f711a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f23 PSN 0x998739 OUT 0x10 RKey 0x183100 VAddr 0x007f711a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f24 PSN 0xa6cd73 OUT 0x10 RKey 0x183100 VAddr 0x007f711b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f25 PSN 0x40dc9 OUT 0x10 RKey 0x183100 VAddr 0x007f711b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f26 PSN 0x993260 OUT 0x10 RKey 0x183100 VAddr 0x007f711c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f27 PSN 0x457375 OUT 0x10 RKey 0x183100 VAddr 0x007f711c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f28 PSN 0x12cbbc OUT 0x10 RKey 0x183100 VAddr 0x007f711d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f29 PSN 0xf30758 OUT 0x10 RKey 0x183100 VAddr 0x007f711d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f2a PSN 0x283760 OUT 0x10 RKey 0x183100 VAddr 0x007f711e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f2b PSN 0x664e19 OUT 0x10 RKey 0x183100 VAddr 0x007f711e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f2c PSN 0x665184 OUT 0x10 RKey 0x183100 VAddr 0x007f711f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1f2d PSN 0x3ee75a OUT 0x10 RKey 0x183100 VAddr 0x007f711f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.056075            0.055891            3.493179
 4          32000            0.11               0.11   		     3.544580
 8          32000            0.23               0.23   		     3.545879
 16         32000            0.45               0.45   		     3.545482
 32         32000            0.91               0.91   		     3.543166
 64         32000            1.82               1.81   		     3.542558
 128        32000            3.63               3.62   		     3.538441
 256        32000            7.27               7.26   		     3.543759
 512        32000            14.54              14.50  		     3.539443
 1024       32000            29.03              28.96  		     3.535138
 2048       32000            57.96              57.85  		     3.530809
 4096       32000            115.38             114.86 		     3.505213
 8192       32000            207.98             207.61 		     3.167937
 16384      32000            209.01             209.00 		     1.594551
 32768      32000            209.31             209.25 		     0.798224
 65536      32000            209.19             209.16 		     0.398947
 131072     32000            209.32             209.32 		     0.199622
 262144     32000            208.94             208.93 		     0.099624
 524288     32000            209.16             209.16 		     0.049867
 1048576    32000            186.90             186.90 		     0.022280
 2097152    32000            171.32             171.32 		     0.010211
 4194304    32000            171.18             171.18 		     0.005101
 8388608    32000            171.23             171.23 		     0.002551
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f05a0000000
destroying current CUDA Ctx
