initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 57392, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fa3a0000000 pointer=0x7fa3a0000000
using DMA-BUF for GPU buffer address at 0x7fa3a0000000 aligned at 0x7fa3a0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fa3a0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1e12 PSN 0x4cf57e OUT 0x10 RKey 0x183000 VAddr 0x007fa3b0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e13 PSN 0x432490 OUT 0x10 RKey 0x183000 VAddr 0x007fa3b0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e14 PSN 0xa1729a OUT 0x10 RKey 0x183000 VAddr 0x007fa3b1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e15 PSN 0xd2c6e1 OUT 0x10 RKey 0x183000 VAddr 0x007fa3b1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e16 PSN 0x4a89e0 OUT 0x10 RKey 0x183000 VAddr 0x007fa3b2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e17 PSN 0xb449c2 OUT 0x10 RKey 0x183000 VAddr 0x007fa3b2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e18 PSN 0xc974f9 OUT 0x10 RKey 0x183000 VAddr 0x007fa3b3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e19 PSN 0x2fbffe OUT 0x10 RKey 0x183000 VAddr 0x007fa3b3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e1a PSN 0xc9ccca OUT 0x10 RKey 0x183000 VAddr 0x007fa3b4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e1b PSN 0xe82b84 OUT 0x10 RKey 0x183000 VAddr 0x007fa3b4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e1c PSN 0xb454d8 OUT 0x10 RKey 0x183000 VAddr 0x007fa3b5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e1d PSN 0x5cf08b OUT 0x10 RKey 0x183000 VAddr 0x007fa3b5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e1e PSN 0xdc3b1b OUT 0x10 RKey 0x183000 VAddr 0x007fa3b6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e1f PSN 0xf562c OUT 0x10 RKey 0x183000 VAddr 0x007fa3b6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e20 PSN 0x2bd7a OUT 0x10 RKey 0x183000 VAddr 0x007fa3b7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e21 PSN 0x2818b6 OUT 0x10 RKey 0x183000 VAddr 0x007fa3b7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e22 PSN 0x328493 OUT 0x10 RKey 0x183000 VAddr 0x007fa3b8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e23 PSN 0x861c51 OUT 0x10 RKey 0x183000 VAddr 0x007fa3b8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e24 PSN 0x1a1358 OUT 0x10 RKey 0x183000 VAddr 0x007fa3b9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e25 PSN 0xddb565 OUT 0x10 RKey 0x183000 VAddr 0x007fa3b9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e26 PSN 0x455362 OUT 0x10 RKey 0x183000 VAddr 0x007fa3ba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e27 PSN 0xaf8889 OUT 0x10 RKey 0x183000 VAddr 0x007fa3ba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e28 PSN 0x69afb9 OUT 0x10 RKey 0x183000 VAddr 0x007fa3bb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e29 PSN 0x47bccd OUT 0x10 RKey 0x183000 VAddr 0x007fa3bb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e2a PSN 0xcec24a OUT 0x10 RKey 0x183000 VAddr 0x007fa3bc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e2b PSN 0x8e694d OUT 0x10 RKey 0x183000 VAddr 0x007fa3bc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e2c PSN 0x99fbea OUT 0x10 RKey 0x183000 VAddr 0x007fa3bd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e2d PSN 0xaa5224 OUT 0x10 RKey 0x183000 VAddr 0x007fa3bd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e2e PSN 0xeccb73 OUT 0x10 RKey 0x183000 VAddr 0x007fa3be000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e2f PSN 0x2ff8f9 OUT 0x10 RKey 0x183000 VAddr 0x007fa3be800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e30 PSN 0xbfc61b OUT 0x10 RKey 0x183000 VAddr 0x007fa3bf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x1e31 PSN 0xd2c26e OUT 0x10 RKey 0x183000 VAddr 0x007fa3bf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1e12 PSN 0xde2653 OUT 0x10 RKey 0x183100 VAddr 0x007fc190000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e13 PSN 0x504d41 OUT 0x10 RKey 0x183100 VAddr 0x007fc190800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e14 PSN 0xf6cbf7 OUT 0x10 RKey 0x183100 VAddr 0x007fc191000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e15 PSN 0x2f617a OUT 0x10 RKey 0x183100 VAddr 0x007fc191800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e16 PSN 0xa9d305 OUT 0x10 RKey 0x183100 VAddr 0x007fc192000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e17 PSN 0x19ac83 OUT 0x10 RKey 0x183100 VAddr 0x007fc192800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e18 PSN 0x99e726 OUT 0x10 RKey 0x183100 VAddr 0x007fc193000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e19 PSN 0xcb27 OUT 0x10 RKey 0x183100 VAddr 0x007fc193800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e1a PSN 0x9e633f OUT 0x10 RKey 0x183100 VAddr 0x007fc194000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e1b PSN 0x755955 OUT 0x10 RKey 0x183100 VAddr 0x007fc194800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e1c PSN 0xa69cd5 OUT 0x10 RKey 0x183100 VAddr 0x007fc195000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e1d PSN 0x6ee544 OUT 0x10 RKey 0x183100 VAddr 0x007fc195800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e1e PSN 0xeba3e0 OUT 0x10 RKey 0x183100 VAddr 0x007fc196000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e1f PSN 0x5bf00d OUT 0x10 RKey 0x183100 VAddr 0x007fc196800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e20 PSN 0x4c6847 OUT 0x10 RKey 0x183100 VAddr 0x007fc197000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e21 PSN 0xf5ffff OUT 0x10 RKey 0x183100 VAddr 0x007fc197800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e22 PSN 0xf594a8 OUT 0x10 RKey 0x183100 VAddr 0x007fc198000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e23 PSN 0x62d342 OUT 0x10 RKey 0x183100 VAddr 0x007fc198800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e24 PSN 0x9c7df5 OUT 0x10 RKey 0x183100 VAddr 0x007fc199000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e25 PSN 0xea283e OUT 0x10 RKey 0x183100 VAddr 0x007fc199800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e26 PSN 0xcd2fc7 OUT 0x10 RKey 0x183100 VAddr 0x007fc19a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e27 PSN 0xa71d8a OUT 0x10 RKey 0x183100 VAddr 0x007fc19a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e28 PSN 0x9f0726 OUT 0x10 RKey 0x183100 VAddr 0x007fc19b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e29 PSN 0x5e436 OUT 0x10 RKey 0x183100 VAddr 0x007fc19b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e2a PSN 0xf9dfff OUT 0x10 RKey 0x183100 VAddr 0x007fc19c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e2b PSN 0x76ad5e OUT 0x10 RKey 0x183100 VAddr 0x007fc19c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e2c PSN 0x523d27 OUT 0x10 RKey 0x183100 VAddr 0x007fc19d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e2d PSN 0xf6e71d OUT 0x10 RKey 0x183100 VAddr 0x007fc19d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e2e PSN 0xebef78 OUT 0x10 RKey 0x183100 VAddr 0x007fc19e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e2f PSN 0xcacd1a OUT 0x10 RKey 0x183100 VAddr 0x007fc19e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e30 PSN 0xadbe28 OUT 0x10 RKey 0x183100 VAddr 0x007fc19f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1e31 PSN 0xfd0df7 OUT 0x10 RKey 0x183100 VAddr 0x007fc19f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.055988            0.055339            3.458674
 4          32000            0.11               0.11   		     3.548573
 8          32000            0.23               0.23   		     3.544300
 16         32000            0.45               0.45   		     3.544159
 32         32000            0.91               0.91   		     3.547518
 64         32000            1.82               1.82   		     3.546025
 128        32000            3.63               3.62   		     3.535994
 256        32000            7.27               7.25   		     3.542370
 512        32000            14.54              14.51  		     3.541805
 1024       32000            29.07              28.99  		     3.539150
 2048       32000            57.33              57.07  		     3.483304
 4096       32000            116.84             116.60 		     3.558434
 8192       32000            207.98             207.42 		     3.165052
 16384      32000            202.83             202.75 		     1.546859
 32768      32000            206.02             206.00 		     0.785844
 65536      32000            206.81             206.80 		     0.394432
 131072     32000            208.12             208.10 		     0.198457
 262144     32000            208.94             208.94 		     0.099632
 524288     32000            208.87             208.87 		     0.049798
 1048576    32000            186.92             186.92 		     0.022282
 2097152    32000            171.27             171.27 		     0.010208
 4194304    32000            171.19             171.19 		     0.005102
 8388608    32000            171.23             171.23 		     0.002552
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fa3a0000000
destroying current CUDA Ctx
