initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 64235, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f8f60000000 pointer=0x7f8f60000000
using DMA-BUF for GPU buffer address at 0x7f8f60000000 aligned at 0x7f8f60000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f8f60000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x22fe PSN 0xb79401 OUT 0x10 RKey 0x183000 VAddr 0x007f8f70000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x22ff PSN 0x4cc78e OUT 0x10 RKey 0x183000 VAddr 0x007f8f70800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2300 PSN 0xdd998a OUT 0x10 RKey 0x183000 VAddr 0x007f8f71000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2301 PSN 0x3487da OUT 0x10 RKey 0x183000 VAddr 0x007f8f71800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2302 PSN 0x4bdd1c OUT 0x10 RKey 0x183000 VAddr 0x007f8f72000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2303 PSN 0xe62f18 OUT 0x10 RKey 0x183000 VAddr 0x007f8f72800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2304 PSN 0xe4eb61 OUT 0x10 RKey 0x183000 VAddr 0x007f8f73000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2305 PSN 0xac2710 OUT 0x10 RKey 0x183000 VAddr 0x007f8f73800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2306 PSN 0x7d683e OUT 0x10 RKey 0x183000 VAddr 0x007f8f74000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2307 PSN 0x8520b1 OUT 0x10 RKey 0x183000 VAddr 0x007f8f74800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2308 PSN 0xc19a37 OUT 0x10 RKey 0x183000 VAddr 0x007f8f75000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2309 PSN 0x614735 OUT 0x10 RKey 0x183000 VAddr 0x007f8f75800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x230a PSN 0xd36a47 OUT 0x10 RKey 0x183000 VAddr 0x007f8f76000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x230b PSN 0xc980b1 OUT 0x10 RKey 0x183000 VAddr 0x007f8f76800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x230c PSN 0x8cc951 OUT 0x10 RKey 0x183000 VAddr 0x007f8f77000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x230d PSN 0x3cc077 OUT 0x10 RKey 0x183000 VAddr 0x007f8f77800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x230e PSN 0x17caf7 OUT 0x10 RKey 0x183000 VAddr 0x007f8f78000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x230f PSN 0x1c79ae OUT 0x10 RKey 0x183000 VAddr 0x007f8f78800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2310 PSN 0x33d528 OUT 0x10 RKey 0x183000 VAddr 0x007f8f79000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2311 PSN 0x3fa7be OUT 0x10 RKey 0x183000 VAddr 0x007f8f79800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2312 PSN 0x37ec7d OUT 0x10 RKey 0x183000 VAddr 0x007f8f7a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2313 PSN 0xe36e3f OUT 0x10 RKey 0x183000 VAddr 0x007f8f7a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2314 PSN 0x358f01 OUT 0x10 RKey 0x183000 VAddr 0x007f8f7b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2315 PSN 0x9a0b3f OUT 0x10 RKey 0x183000 VAddr 0x007f8f7b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2316 PSN 0xf6219e OUT 0x10 RKey 0x183000 VAddr 0x007f8f7c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2317 PSN 0xf104db OUT 0x10 RKey 0x183000 VAddr 0x007f8f7c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2318 PSN 0xc9582a OUT 0x10 RKey 0x183000 VAddr 0x007f8f7d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2319 PSN 0x3fa62e OUT 0x10 RKey 0x183000 VAddr 0x007f8f7d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x231a PSN 0xc41c7e OUT 0x10 RKey 0x183000 VAddr 0x007f8f7e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x231b PSN 0x47cfdf OUT 0x10 RKey 0x183000 VAddr 0x007f8f7e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x231c PSN 0x8a76d2 OUT 0x10 RKey 0x183000 VAddr 0x007f8f7f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x231d PSN 0xedd90 OUT 0x10 RKey 0x183000 VAddr 0x007f8f7f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x22fe PSN 0x4fbeb1 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x22ff PSN 0x3aa147 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2300 PSN 0xc1f685 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2301 PSN 0xd413f0 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2302 PSN 0xe7d343 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2303 PSN 0xdf7ae9 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2304 PSN 0x4a6c94 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2305 PSN 0x726efd OUT 0x10 RKey 0x183100 VAddr 0x007f1ad3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2306 PSN 0x7b695d OUT 0x10 RKey 0x183100 VAddr 0x007f1ad4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2307 PSN 0xb7e81b OUT 0x10 RKey 0x183100 VAddr 0x007f1ad4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2308 PSN 0xcb4b23 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2309 PSN 0x8f307a OUT 0x10 RKey 0x183100 VAddr 0x007f1ad5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x230a PSN 0x62dde OUT 0x10 RKey 0x183100 VAddr 0x007f1ad6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x230b PSN 0xcae533 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x230c PSN 0xd2ed75 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x230d PSN 0x4c0895 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x230e PSN 0x960086 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x230f PSN 0x4234c8 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2310 PSN 0xdf6803 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2311 PSN 0x986434 OUT 0x10 RKey 0x183100 VAddr 0x007f1ad9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2312 PSN 0xa3bb85 OUT 0x10 RKey 0x183100 VAddr 0x007f1ada000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2313 PSN 0xb55170 OUT 0x10 RKey 0x183100 VAddr 0x007f1ada800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2314 PSN 0x53c414 OUT 0x10 RKey 0x183100 VAddr 0x007f1adb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2315 PSN 0x20298c OUT 0x10 RKey 0x183100 VAddr 0x007f1adb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2316 PSN 0xbca99d OUT 0x10 RKey 0x183100 VAddr 0x007f1adc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2317 PSN 0x3279a4 OUT 0x10 RKey 0x183100 VAddr 0x007f1adc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2318 PSN 0x571af5 OUT 0x10 RKey 0x183100 VAddr 0x007f1add000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2319 PSN 0x386bd3 OUT 0x10 RKey 0x183100 VAddr 0x007f1add800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x231a PSN 0xd4f4f6 OUT 0x10 RKey 0x183100 VAddr 0x007f1ade000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x231b PSN 0x1957c0 OUT 0x10 RKey 0x183100 VAddr 0x007f1ade800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x231c PSN 0xb7ead6 OUT 0x10 RKey 0x183100 VAddr 0x007f1adf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x231d PSN 0xde680d OUT 0x10 RKey 0x183100 VAddr 0x007f1adf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.080357            0.078962            4.935126
 4          32000            0.17               0.16   		     5.128756
 8          32000            0.33               0.33   		     5.150955
 16         32000            0.66               0.66   		     5.141710
 32         32000            1.32               1.32   		     5.148776
 64         32000            2.64               2.63   		     5.140967
 128        32000            5.26               5.24   		     5.118248
 256        32000            10.59              10.54  		     5.145282
 512        32000            21.14              21.04  		     5.135719
 1024       32000            42.28              42.01  		     5.127836
 2048       32000            83.97              83.61  		     5.103302
 4096       32000            167.95             167.31 		     5.105948
 8192       32000            179.82             150.12 		     2.290719
 16384      32000            184.32             171.53 		     1.308668
 32768      32000            197.99             197.93 		     0.755033
 65536      32000            197.86             197.83 		     0.377331
 131072     32000            197.73             197.73 		     0.188566
 262144     32000            195.41             195.40 		     0.093176
 524288     32000            196.64             196.64 		     0.046884
 1048576    32000            178.19             178.19 		     0.021242
 2097152    32000            163.93             163.93 		     0.009771
 4194304    32000            163.82             163.82 		     0.004882
 8388608    32000            163.79             163.79 		     0.002441
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f8f60000000
destroying current CUDA Ctx
