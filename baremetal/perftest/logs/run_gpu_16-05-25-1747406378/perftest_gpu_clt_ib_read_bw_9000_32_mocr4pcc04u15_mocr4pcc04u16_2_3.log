initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 53088, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fc9c0000000 pointer=0x7fc9c0000000
using DMA-BUF for GPU buffer address at 0x7fc9c0000000 aligned at 0x7fc9c0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fc9c0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1b9c PSN 0xc212be OUT 0x10 RKey 0x183100 VAddr 0x007fc9d0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b9d PSN 0x6818d0 OUT 0x10 RKey 0x183100 VAddr 0x007fc9d0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b9e PSN 0xcef1da OUT 0x10 RKey 0x183100 VAddr 0x007fc9d1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1b9f PSN 0x857521 OUT 0x10 RKey 0x183100 VAddr 0x007fc9d1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ba0 PSN 0xec3b20 OUT 0x10 RKey 0x183100 VAddr 0x007fc9d2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ba1 PSN 0xcc4202 OUT 0x10 RKey 0x183100 VAddr 0x007fc9d2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ba2 PSN 0x7a839 OUT 0x10 RKey 0x183100 VAddr 0x007fc9d3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ba3 PSN 0xb7123e OUT 0x10 RKey 0x183100 VAddr 0x007fc9d3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ba4 PSN 0x4d520a OUT 0x10 RKey 0x183100 VAddr 0x007fc9d4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ba5 PSN 0x9f67c4 OUT 0x10 RKey 0x183100 VAddr 0x007fc9d4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ba6 PSN 0xda7c18 OUT 0x10 RKey 0x183100 VAddr 0x007fc9d5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ba7 PSN 0xdf26cb OUT 0x10 RKey 0x183100 VAddr 0x007fc9d5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ba8 PSN 0xad45b OUT 0x10 RKey 0x183100 VAddr 0x007fc9d6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1ba9 PSN 0x96166c OUT 0x10 RKey 0x183100 VAddr 0x007fc9d6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1baa PSN 0x1c18ba OUT 0x10 RKey 0x183100 VAddr 0x007fc9d7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bab PSN 0xef72f6 OUT 0x10 RKey 0x183100 VAddr 0x007fc9d7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bac PSN 0x2971d3 OUT 0x10 RKey 0x183100 VAddr 0x007fc9d8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bad PSN 0xd0a091 OUT 0x10 RKey 0x183100 VAddr 0x007fc9d8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bae PSN 0xa5e298 OUT 0x10 RKey 0x183100 VAddr 0x007fc9d9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1baf PSN 0x9873a5 OUT 0x10 RKey 0x183100 VAddr 0x007fc9d9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bb0 PSN 0xb5d4a2 OUT 0x10 RKey 0x183100 VAddr 0x007fc9da000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bb1 PSN 0xb610c9 OUT 0x10 RKey 0x183100 VAddr 0x007fc9da800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bb2 PSN 0x9b32f9 OUT 0x10 RKey 0x183100 VAddr 0x007fc9db000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bb3 PSN 0x481f0d OUT 0x10 RKey 0x183100 VAddr 0x007fc9db800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bb4 PSN 0x3e178a OUT 0x10 RKey 0x183100 VAddr 0x007fc9dc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bb5 PSN 0x8d358d OUT 0x10 RKey 0x183100 VAddr 0x007fc9dc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bb6 PSN 0x98732a OUT 0x10 RKey 0x183100 VAddr 0x007fc9dd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bb7 PSN 0x269864 OUT 0x10 RKey 0x183100 VAddr 0x007fc9dd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bb8 PSN 0xf434b3 OUT 0x10 RKey 0x183100 VAddr 0x007fc9de000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bb9 PSN 0xe74939 OUT 0x10 RKey 0x183100 VAddr 0x007fc9de800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bba PSN 0xe6715b OUT 0x10 RKey 0x183100 VAddr 0x007fc9df000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1bbb PSN 0x252cae OUT 0x10 RKey 0x183100 VAddr 0x007fc9df800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1b9c PSN 0xb85086 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b9d PSN 0x2216f8 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b9e PSN 0x3818e2 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1b9f PSN 0xbc4389 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ba0 PSN 0x938d68 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ba1 PSN 0x56faaa OUT 0x10 RKey 0x183000 VAddr 0x007fe6b2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ba2 PSN 0xdf37c1 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ba3 PSN 0xd35f26 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ba4 PSN 0x5280d2 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ba5 PSN 0x3c02ec OUT 0x10 RKey 0x183000 VAddr 0x007fe6b4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ba6 PSN 0xce7c20 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ba7 PSN 0x2a5a33 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ba8 PSN 0x1f27a3 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1ba9 PSN 0x703c14 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1baa PSN 0xb31142 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bab PSN 0xe174de OUT 0x10 RKey 0x183000 VAddr 0x007fe6b7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bac PSN 0xcab19b OUT 0x10 RKey 0x183000 VAddr 0x007fe6b8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bad PSN 0x2678b9 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bae PSN 0x46dba0 OUT 0x10 RKey 0x183000 VAddr 0x007fe6b9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1baf PSN 0x3fac0d OUT 0x10 RKey 0x183000 VAddr 0x007fe6b9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bb0 PSN 0x7648ea OUT 0x10 RKey 0x183000 VAddr 0x007fe6ba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bb1 PSN 0x804371 OUT 0x10 RKey 0x183000 VAddr 0x007fe6ba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bb2 PSN 0x15b481 OUT 0x10 RKey 0x183000 VAddr 0x007fe6bb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bb3 PSN 0x3175f5 OUT 0x10 RKey 0x183000 VAddr 0x007fe6bb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bb4 PSN 0x8c8852 OUT 0x10 RKey 0x183000 VAddr 0x007fe6bc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bb5 PSN 0xa6eab5 OUT 0x10 RKey 0x183000 VAddr 0x007fe6bc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bb6 PSN 0x2c8532 OUT 0x10 RKey 0x183000 VAddr 0x007fe6bd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bb7 PSN 0xc575cc OUT 0x10 RKey 0x183000 VAddr 0x007fe6bd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bb8 PSN 0x63e9fb OUT 0x10 RKey 0x183000 VAddr 0x007fe6be000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bb9 PSN 0xb628e1 OUT 0x10 RKey 0x183000 VAddr 0x007fe6be800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bba PSN 0xcc9be3 OUT 0x10 RKey 0x183000 VAddr 0x007fe6bf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1bbb PSN 0xbb7896 OUT 0x10 RKey 0x183000 VAddr 0x007fe6bf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.057878            0.057672            3.604505
 4          32000            0.12               0.12   		     3.679358
 8          32000            0.24               0.23   		     3.669902
 16         32000            0.47               0.47   		     3.679480
 32         32000            0.94               0.94   		     3.662765
 64         32000            1.89               1.88   		     3.677489
 128        32000            3.75               3.74   		     3.655722
 256        32000            7.48               7.46   		     3.643336
 512        32000            15.03              14.99  		     3.660171
 1024       32000            30.12              30.06  		     3.669859
 2048       32000            60.14              59.91  		     3.656489
 4096       32000            119.69             118.77 		     3.624555
 8192       32000            197.13             196.90 		     3.004419
 16384      32000            197.79             197.77 		     1.508902
 32768      32000            197.99             197.95 		     0.755129
 65536      32000            197.93             197.93 		     0.377515
 131072     32000            197.99             197.98 		     0.188812
 262144     32000            198.02             198.01 		     0.094420
 524288     32000            198.02             198.02 		     0.047211
 1048576    32000            178.54             178.53 		     0.021283
 2097152    32000            164.07             164.07 		     0.009779
 4194304    32000            163.97             163.97 		     0.004887
 8388608    32000            163.99             163.99 		     0.002444
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fc9c0000000
destroying current CUDA Ctx
