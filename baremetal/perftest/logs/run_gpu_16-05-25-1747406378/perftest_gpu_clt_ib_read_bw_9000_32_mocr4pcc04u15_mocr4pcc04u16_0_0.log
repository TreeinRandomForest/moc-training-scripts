initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 45385, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f8fe0000000 pointer=0x7f8fe0000000
using DMA-BUF for GPU buffer address at 0x7f8fe0000000 aligned at 0x7f8fe0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f8fe0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1632 PSN 0x8d6f10 OUT 0x10 RKey 0x183100 VAddr 0x007f8ff0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1633 PSN 0x8813ba OUT 0x10 RKey 0x183100 VAddr 0x007f8ff0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1634 PSN 0x93037c OUT 0x10 RKey 0x183100 VAddr 0x007f8ff1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1635 PSN 0x30831b OUT 0x10 RKey 0x183100 VAddr 0x007f8ff1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1636 PSN 0xc7ca92 OUT 0x10 RKey 0x183100 VAddr 0x007f8ff2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1637 PSN 0x40c18c OUT 0x10 RKey 0x183100 VAddr 0x007f8ff2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1638 PSN 0x6ff1fb OUT 0x10 RKey 0x183100 VAddr 0x007f8ff3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1639 PSN 0x3ac5d8 OUT 0x10 RKey 0x183100 VAddr 0x007f8ff3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x163a PSN 0xb5269c OUT 0x10 RKey 0x183100 VAddr 0x007f8ff4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x163b PSN 0x6815ee OUT 0x10 RKey 0x183100 VAddr 0x007f8ff4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x163c PSN 0x7e5ffa OUT 0x10 RKey 0x183100 VAddr 0x007f8ff5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x163d PSN 0xbc3a05 OUT 0x10 RKey 0x183100 VAddr 0x007f8ff5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x163e PSN 0xea200d OUT 0x10 RKey 0x183100 VAddr 0x007f8ff6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x163f PSN 0xc33d36 OUT 0x10 RKey 0x183100 VAddr 0x007f8ff6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1640 PSN 0x6718bc OUT 0x10 RKey 0x183100 VAddr 0x007f8ff7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1641 PSN 0xb83fd0 OUT 0x10 RKey 0x183100 VAddr 0x007f8ff7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1642 PSN 0xac86a5 OUT 0x10 RKey 0x183100 VAddr 0x007f8ff8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1643 PSN 0xed29fb OUT 0x10 RKey 0x183100 VAddr 0x007f8ff8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1644 PSN 0xf9a0ba OUT 0x10 RKey 0x183100 VAddr 0x007f8ff9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1645 PSN 0x6af41f OUT 0x10 RKey 0x183100 VAddr 0x007f8ff9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1646 PSN 0x3c2494 OUT 0x10 RKey 0x183100 VAddr 0x007f8ffa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1647 PSN 0xd186d3 OUT 0x10 RKey 0x183100 VAddr 0x007f8ffa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1648 PSN 0x91713b OUT 0x10 RKey 0x183100 VAddr 0x007f8ffb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1649 PSN 0xe7ed27 OUT 0x10 RKey 0x183100 VAddr 0x007f8ffb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x164a PSN 0x6c349c OUT 0x10 RKey 0x183100 VAddr 0x007f8ffc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x164b PSN 0xe5c237 OUT 0x10 RKey 0x183100 VAddr 0x007f8ffc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x164c PSN 0x65138c OUT 0x10 RKey 0x183100 VAddr 0x007f8ffd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x164d PSN 0xb6ee1e OUT 0x10 RKey 0x183100 VAddr 0x007f8ffd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x164e PSN 0xe5d0e5 OUT 0x10 RKey 0x183100 VAddr 0x007f8ffe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x164f PSN 0x33b683 OUT 0x10 RKey 0x183100 VAddr 0x007f8ffe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1650 PSN 0xd975dd OUT 0x10 RKey 0x183100 VAddr 0x007f8fff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1651 PSN 0x82e408 OUT 0x10 RKey 0x183100 VAddr 0x007f8fff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1632 PSN 0xf254bc OUT 0x10 RKey 0x183000 VAddr 0x007f1150000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1633 PSN 0x6665f6 OUT 0x10 RKey 0x183000 VAddr 0x007f1150800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1634 PSN 0x6def08 OUT 0x10 RKey 0x183000 VAddr 0x007f1151000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1635 PSN 0x1695b7 OUT 0x10 RKey 0x183000 VAddr 0x007f1151800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1636 PSN 0x45defe OUT 0x10 RKey 0x183000 VAddr 0x007f1152000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1637 PSN 0xd87b88 OUT 0x10 RKey 0x183000 VAddr 0x007f1152800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1638 PSN 0x728a47 OUT 0x10 RKey 0x183000 VAddr 0x007f1153000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1639 PSN 0x39e634 OUT 0x10 RKey 0x183000 VAddr 0x007f1153800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x163a PSN 0x3895c8 OUT 0x10 RKey 0x183000 VAddr 0x007f1154000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x163b PSN 0xcff3aa OUT 0x10 RKey 0x183000 VAddr 0x007f1154800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x163c PSN 0x3eb106 OUT 0x10 RKey 0x183000 VAddr 0x007f1155000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x163d PSN 0x7f8421 OUT 0x10 RKey 0x183000 VAddr 0x007f1155800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x163e PSN 0x75d5f9 OUT 0x10 RKey 0x183000 VAddr 0x007f1156000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x163f PSN 0x41bab2 OUT 0x10 RKey 0x183000 VAddr 0x007f1156800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1640 PSN 0x4fee88 OUT 0x10 RKey 0x183000 VAddr 0x007f1157000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1641 PSN 0x8fac OUT 0x10 RKey 0x183000 VAddr 0x007f1157800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1642 PSN 0x62f51 OUT 0x10 RKey 0x183000 VAddr 0x007f1158000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1643 PSN 0x348337 OUT 0x10 RKey 0x183000 VAddr 0x007f1158800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1644 PSN 0xd68746 OUT 0x10 RKey 0x183000 VAddr 0x007f1159000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1645 PSN 0xaae5bb OUT 0x10 RKey 0x183000 VAddr 0x007f1159800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1646 PSN 0x582c00 OUT 0x10 RKey 0x183000 VAddr 0x007f115a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1647 PSN 0xfbb7cf OUT 0x10 RKey 0x183000 VAddr 0x007f115a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1648 PSN 0xdab487 OUT 0x10 RKey 0x183000 VAddr 0x007f115b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1649 PSN 0x9fdc83 OUT 0x10 RKey 0x183000 VAddr 0x007f115b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x164a PSN 0x99c6c8 OUT 0x10 RKey 0x183000 VAddr 0x007f115c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x164b PSN 0x3086f3 OUT 0x10 RKey 0x183000 VAddr 0x007f115c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x164c PSN 0x4bbf98 OUT 0x10 RKey 0x183000 VAddr 0x007f115d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x164d PSN 0x90f73a OUT 0x10 RKey 0x183000 VAddr 0x007f115d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x164e PSN 0xbad9d1 OUT 0x10 RKey 0x183000 VAddr 0x007f115e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x164f PSN 0x7c8aff OUT 0x10 RKey 0x183000 VAddr 0x007f115e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1650 PSN 0x1356a9 OUT 0x10 RKey 0x183000 VAddr 0x007f115f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1651 PSN 0x2ee2e4 OUT 0x10 RKey 0x183000 VAddr 0x007f115f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.056872            0.056689            3.543080
 4          32000            0.12               0.12   		     3.619905
 8          32000            0.23               0.23   		     3.613708
 16         32000            0.46               0.46   		     3.616980
 32         32000            0.93               0.92   		     3.598813
 64         32000            1.86               1.85   		     3.617258
 128        32000            3.71               3.70   		     3.614178
 256        32000            7.41               7.40   		     3.614178
 512        32000            14.84              14.80  		     3.613557
 1024       32000            29.63              29.58  		     3.610707
 2048       32000            59.17              59.09  		     3.606422
 4096       32000            117.78             117.22 		     3.577126
 8192       32000            207.98             207.66 		     3.168690
 16384      32000            209.00             208.95 		     1.594191
 32768      32000            209.23             209.18 		     0.797948
 65536      32000            209.12             209.10 		     0.398829
 131072     32000            209.19             209.19 		     0.199495
 262144     32000            209.26             209.26 		     0.099781
 524288     32000            209.29             209.29 		     0.049899
 1048576    32000            186.63             186.63 		     0.022248
 2097152    32000            171.32             171.32 		     0.010212
 4194304    32000            171.22             171.21 		     0.005103
 8388608    32000            171.21             171.21 		     0.002551
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f8fe0000000
destroying current CUDA Ctx
