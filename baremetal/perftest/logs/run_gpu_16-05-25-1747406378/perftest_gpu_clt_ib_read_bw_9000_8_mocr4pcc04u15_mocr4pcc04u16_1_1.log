initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 48843, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 134217728 bytes GPU buffer
allocated GPU buffer address at 00007ff06c000000 pointer=0x7ff06c000000
using DMA-BUF for GPU buffer address at 0x7ff06c000000 aligned at 0x7ff06c000000 with aligned size 134217728
Calling ibv_reg_dmabuf_mr(offset=0, size=134217728, addr=0x7ff06c000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 8		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1890 PSN 0x1a4d0e OUT 0x10 RKey 0x182f00 VAddr 0x007ff070000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1891 PSN 0x934017 OUT 0x10 RKey 0x182f00 VAddr 0x007ff070800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1892 PSN 0x7601df OUT 0x10 RKey 0x182f00 VAddr 0x007ff071000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1893 PSN 0x31520b OUT 0x10 RKey 0x182f00 VAddr 0x007ff071800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1894 PSN 0xc1f9f9 OUT 0x10 RKey 0x182f00 VAddr 0x007ff072000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1895 PSN 0xdb0731 OUT 0x10 RKey 0x182f00 VAddr 0x007ff072800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1896 PSN 0x576406 OUT 0x10 RKey 0x182f00 VAddr 0x007ff073000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1897 PSN 0xe9c351 OUT 0x10 RKey 0x182f00 VAddr 0x007ff073800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1890 PSN 0x680320 OUT 0x10 RKey 0x182f00 VAddr 0x007fb390000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1891 PSN 0xd5f1c1 OUT 0x10 RKey 0x182f00 VAddr 0x007fb390800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1892 PSN 0x326341 OUT 0x10 RKey 0x182f00 VAddr 0x007fb391000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1893 PSN 0x3cd4c5 OUT 0x10 RKey 0x182f00 VAddr 0x007fb391800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1894 PSN 0x93bf2b OUT 0x10 RKey 0x182f00 VAddr 0x007fb392000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1895 PSN 0x6ee97b OUT 0x10 RKey 0x182f00 VAddr 0x007fb392800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1896 PSN 0xd53988 OUT 0x10 RKey 0x182f00 VAddr 0x007fb393000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1897 PSN 0x2877ab OUT 0x10 RKey 0x182f00 VAddr 0x007fb393800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          8000           0.078091            0.073314            4.582111
 4          8000             0.17               0.17   		     5.157332
 8          8000             0.33               0.33   		     5.168359
 16         8000             0.67               0.66   		     5.176554
 32         8000             1.33               1.32   		     5.147475
 64         8000             2.65               2.64   		     5.158928
 128        8000             5.27               5.24   		     5.113291
 256        8000             10.54              10.37  		     5.065432
 512        8000             21.09              20.99  		     5.123509
 1024       8000             42.67              42.39  		     5.175013
 2048       8000             88.40              87.51  		     5.340918
 4096       8000             186.18             185.79 		     5.669899
 8192       8000             199.00             196.66 		     3.000750
 16384      8000             201.86             201.84 		     1.539880
 32768      8000             202.55             202.53 		     0.772574
 65536      8000             202.79             202.78 		     0.386773
 131072     8000             202.85             202.85 		     0.193448
 262144     8000             202.92             202.92 		     0.096760
 524288     8000             202.95             202.94 		     0.048386
 1048576    8000             202.92             202.92 		     0.024190
 2097152    8000             202.95             202.95 		     0.012096
 4194304    8000             197.38             197.38 		     0.005882
 8388608    8000             170.05             170.02 		     0.002534
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007ff06c000000
destroying current CUDA Ctx
