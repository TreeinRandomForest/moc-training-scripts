initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 46751, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fdc20000000 pointer=0x7fdc20000000
using DMA-BUF for GPU buffer address at 0x7fdc20000000 aligned at 0x7fdc20000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fdc20000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x172e PSN 0x96a74c OUT 0x10 RKey 0x183100 VAddr 0x007fdc30000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x172f PSN 0x4aed46 OUT 0x10 RKey 0x183100 VAddr 0x007fdc30800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1730 PSN 0xd6c18 OUT 0x10 RKey 0x183100 VAddr 0x007fdc31000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1731 PSN 0x1b3587 OUT 0x10 RKey 0x183100 VAddr 0x007fdc31800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1732 PSN 0x92ca8e OUT 0x10 RKey 0x183100 VAddr 0x007fdc32000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1733 PSN 0xfc27d8 OUT 0x10 RKey 0x183100 VAddr 0x007fdc32800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1734 PSN 0x32c857 OUT 0x10 RKey 0x183100 VAddr 0x007fdc33000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1735 PSN 0x96b304 OUT 0x10 RKey 0x183100 VAddr 0x007fdc33800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1736 PSN 0x7eaa58 OUT 0x10 RKey 0x183100 VAddr 0x007fdc34000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1737 PSN 0xe014fa OUT 0x10 RKey 0x183100 VAddr 0x007fdc34800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1738 PSN 0xcac016 OUT 0x10 RKey 0x183100 VAddr 0x007fdc35000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1739 PSN 0x6a4df1 OUT 0x10 RKey 0x183100 VAddr 0x007fdc35800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x173a PSN 0x7ea389 OUT 0x10 RKey 0x183100 VAddr 0x007fdc36000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x173b PSN 0x70a102 OUT 0x10 RKey 0x183100 VAddr 0x007fdc36800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x173c PSN 0xf3de98 OUT 0x10 RKey 0x183100 VAddr 0x007fdc37000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x173d PSN 0x3c267c OUT 0x10 RKey 0x183100 VAddr 0x007fdc37800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x173e PSN 0xa445e1 OUT 0x10 RKey 0x183100 VAddr 0x007fdc38000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x173f PSN 0x897e87 OUT 0x10 RKey 0x183100 VAddr 0x007fdc38800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1740 PSN 0x8f6856 OUT 0x10 RKey 0x183100 VAddr 0x007fdc39000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1741 PSN 0x57198b OUT 0x10 RKey 0x183100 VAddr 0x007fdc39800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1742 PSN 0xf71b90 OUT 0x10 RKey 0x183100 VAddr 0x007fdc3a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1743 PSN 0xa3181f OUT 0x10 RKey 0x183100 VAddr 0x007fdc3a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1744 PSN 0x669697 OUT 0x10 RKey 0x183100 VAddr 0x007fdc3b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1745 PSN 0x97d53 OUT 0x10 RKey 0x183100 VAddr 0x007fdc3b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1746 PSN 0xce1f58 OUT 0x10 RKey 0x183100 VAddr 0x007fdc3c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1747 PSN 0xcb9c43 OUT 0x10 RKey 0x183100 VAddr 0x007fdc3c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1748 PSN 0x39b2a8 OUT 0x10 RKey 0x183100 VAddr 0x007fdc3d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1749 PSN 0x1d50a OUT 0x10 RKey 0x183100 VAddr 0x007fdc3d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x174a PSN 0xd22b61 OUT 0x10 RKey 0x183100 VAddr 0x007fdc3e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x174b PSN 0x71a54f OUT 0x10 RKey 0x183100 VAddr 0x007fdc3e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x174c PSN 0xd36ab9 OUT 0x10 RKey 0x183100 VAddr 0x007fdc3f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x174d PSN 0xbdcdb4 OUT 0x10 RKey 0x183100 VAddr 0x007fdc3f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x172e PSN 0x97d78c OUT 0x10 RKey 0x183000 VAddr 0x007fcc50000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x172f PSN 0x25f886 OUT 0x10 RKey 0x183000 VAddr 0x007fcc50800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1730 PSN 0x6cb658 OUT 0x10 RKey 0x183000 VAddr 0x007fcc51000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1731 PSN 0x6352c7 OUT 0x10 RKey 0x183000 VAddr 0x007fcc51800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1732 PSN 0x8ebece OUT 0x10 RKey 0x183000 VAddr 0x007fcc52000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1733 PSN 0xb4a718 OUT 0x10 RKey 0x183000 VAddr 0x007fcc52800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1734 PSN 0x147697 OUT 0x10 RKey 0x183000 VAddr 0x007fcc53000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1735 PSN 0x3b6444 OUT 0x10 RKey 0x183000 VAddr 0x007fcc53800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1736 PSN 0xdda298 OUT 0x10 RKey 0x183000 VAddr 0x007fcc54000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1737 PSN 0x59483a OUT 0x10 RKey 0x183000 VAddr 0x007fcc54800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1738 PSN 0x711256 OUT 0x10 RKey 0x183000 VAddr 0x007fcc55000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1739 PSN 0x20d331 OUT 0x10 RKey 0x183000 VAddr 0x007fcc55800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x173a PSN 0xecdfc9 OUT 0x10 RKey 0x183000 VAddr 0x007fcc56000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x173b PSN 0x81c842 OUT 0x10 RKey 0x183000 VAddr 0x007fcc56800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x173c PSN 0x8514d8 OUT 0x10 RKey 0x183000 VAddr 0x007fcc57000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x173d PSN 0xcdbfbc OUT 0x10 RKey 0x183000 VAddr 0x007fcc57800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x173e PSN 0x520621 OUT 0x10 RKey 0x183000 VAddr 0x007fcc58000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x173f PSN 0x3dd9c7 OUT 0x10 RKey 0x183000 VAddr 0x007fcc58800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1740 PSN 0x55c296 OUT 0x10 RKey 0x183000 VAddr 0x007fcc59000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1741 PSN 0xe106cb OUT 0x10 RKey 0x183000 VAddr 0x007fcc59800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1742 PSN 0xd89fd0 OUT 0x10 RKey 0x183000 VAddr 0x007fcc5a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1743 PSN 0x79e75f OUT 0x10 RKey 0x183000 VAddr 0x007fcc5a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1744 PSN 0x1054d7 OUT 0x10 RKey 0x183000 VAddr 0x007fcc5b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1745 PSN 0x3cfe93 OUT 0x10 RKey 0x183000 VAddr 0x007fcc5b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1746 PSN 0xdba798 OUT 0x10 RKey 0x183000 VAddr 0x007fcc5c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1747 PSN 0xf81f83 OUT 0x10 RKey 0x183000 VAddr 0x007fcc5c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1748 PSN 0x1914e8 OUT 0x10 RKey 0x183000 VAddr 0x007fcc5d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1749 PSN 0x642a4a OUT 0x10 RKey 0x183000 VAddr 0x007fcc5d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x174a PSN 0x47f7a1 OUT 0x10 RKey 0x183000 VAddr 0x007fcc5e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x174b PSN 0x1b1c8f OUT 0x10 RKey 0x183000 VAddr 0x007fcc5e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x174c PSN 0x1eb0f9 OUT 0x10 RKey 0x183000 VAddr 0x007fcc5f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x174d PSN 0xe836f4 OUT 0x10 RKey 0x183000 VAddr 0x007fcc5f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.057785            0.057694            3.605845
 4          32000            0.12               0.12   		     3.671169
 8          32000            0.24               0.24   		     3.676386
 16         32000            0.47               0.47   		     3.671573
 32         32000            0.95               0.94   		     3.687039
 64         32000            1.89               1.89   		     3.690445
 128        32000            3.77               3.75   		     3.666970
 256        32000            7.57               7.55   		     3.686415
 512        32000            15.11              15.05  		     3.674896
 1024       32000            30.17              30.10  		     3.673931
 2048       32000            60.14              60.05  		     3.665156
 4096       32000            119.69             118.79 		     3.625138
 8192       32000            207.98             207.83 		     3.171171
 16384      32000            209.01             208.99 		     1.594496
 32768      32000            209.16             209.15 		     0.797845
 65536      32000            209.12             209.09 		     0.398806
 131072     32000            209.18             209.16 		     0.199471
 262144     32000            209.24             209.24 		     0.099772
 524288     32000            209.27             209.27 		     0.049895
 1048576    32000            186.45             186.45 		     0.022227
 2097152    32000            171.29             171.29 		     0.010209
 4194304    32000            171.22             171.22 		     0.005103
 8388608    32000            171.22             171.22 		     0.002551
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fdc20000000
destroying current CUDA Ctx
