initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 54389, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007ff424000000 pointer=0x7ff424000000
using DMA-BUF for GPU buffer address at 0x7ff424000000 aligned at 0x7ff424000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7ff424000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1c88 PSN 0x988f54 OUT 0x10 RKey 0x183000 VAddr 0x007ff42c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c89 PSN 0xf1e8ae OUT 0x10 RKey 0x183000 VAddr 0x007ff42c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c8a PSN 0xe5e760 OUT 0x10 RKey 0x183000 VAddr 0x007ff42d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c8b PSN 0x6a632f OUT 0x10 RKey 0x183000 VAddr 0x007ff42d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c8c PSN 0x2e2b16 OUT 0x10 RKey 0x183000 VAddr 0x007ff42e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c8d PSN 0x3e71c0 OUT 0x10 RKey 0x183000 VAddr 0x007ff42e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c8e PSN 0xb2b01f OUT 0x10 RKey 0x183000 VAddr 0x007ff42f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c8f PSN 0xaa132c OUT 0x10 RKey 0x183000 VAddr 0x007ff42f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c90 PSN 0x28b60 OUT 0x10 RKey 0x183000 VAddr 0x007ff430000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c91 PSN 0x941562 OUT 0x10 RKey 0x183000 VAddr 0x007ff430800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c92 PSN 0xac5c5e OUT 0x10 RKey 0x183000 VAddr 0x007ff431000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c93 PSN 0x428899 OUT 0x10 RKey 0x183000 VAddr 0x007ff431800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c94 PSN 0x228d11 OUT 0x10 RKey 0x183000 VAddr 0x007ff432000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c95 PSN 0x6b3fea OUT 0x10 RKey 0x183000 VAddr 0x007ff432800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c96 PSN 0x4df760 OUT 0x10 RKey 0x183000 VAddr 0x007ff433000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1c97 PSN 0x3c63a4 OUT 0x10 RKey 0x183000 VAddr 0x007ff433800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1c88 PSN 0xfdefaa OUT 0x10 RKey 0x182f00 VAddr 0x007f9e3a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c89 PSN 0xf1314c OUT 0x10 RKey 0x182f00 VAddr 0x007f9e3a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c8a PSN 0x7dc6a6 OUT 0x10 RKey 0x182f00 VAddr 0x007f9e3b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c8b PSN 0x3557fd OUT 0x10 RKey 0x182f00 VAddr 0x007f9e3b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c8c PSN 0x717acc OUT 0x10 RKey 0x182f00 VAddr 0x007f9e3c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c8d PSN 0x4ce63e OUT 0x10 RKey 0x182f00 VAddr 0x007f9e3c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c8e PSN 0xab7dc5 OUT 0x10 RKey 0x182f00 VAddr 0x007f9e3d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c8f PSN 0x64c6da OUT 0x10 RKey 0x182f00 VAddr 0x007f9e3d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c90 PSN 0x576076 OUT 0x10 RKey 0x182f00 VAddr 0x007f9e3e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c91 PSN 0x6c93c0 OUT 0x10 RKey 0x182f00 VAddr 0x007f9e3e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c92 PSN 0xa9e64 OUT 0x10 RKey 0x182f00 VAddr 0x007f9e3f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c93 PSN 0x3e0927 OUT 0x10 RKey 0x182f00 VAddr 0x007f9e3f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c94 PSN 0x9fdd87 OUT 0x10 RKey 0x182f00 VAddr 0x007f9e40000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c95 PSN 0xd88628 OUT 0x10 RKey 0x182f00 VAddr 0x007f9e40800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c96 PSN 0x1893c6 OUT 0x10 RKey 0x182f00 VAddr 0x007f9e41000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1c97 PSN 0xc9f12 OUT 0x10 RKey 0x182f00 VAddr 0x007f9e41800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.060100            0.059879            3.742445
 4          16000            0.12               0.12   		     3.774947
 8          16000            0.24               0.24   		     3.790248
 16         16000            0.49               0.49   		     3.800042
 32         16000            0.98               0.97   		     3.798715
 64         16000            1.95               1.93   		     3.774876
 128        16000            3.90               3.89   		     3.794517
 256        16000            7.81               7.77   		     3.792791
 512        16000            15.81              15.76  		     3.848550
 1024       16000            31.45              31.44  		     3.838385
 2048       16000            64.00              63.74  		     3.890381
 4096       16000            132.60             131.54 		     4.014401
 8192       16000            195.82             195.65 		     2.985420
 16384      16000            197.13             197.03 		     1.503255
 32768      16000            197.40             197.34 		     0.752791
 65536      16000            197.50             197.47 		     0.376639
 131072     16000            197.48             197.48 		     0.188331
 262144     16000            197.55             197.54 		     0.094196
 524288     16000            197.57             197.57 		     0.047104
 1048576    16000            197.56             197.56 		     0.023551
 2097152    16000            185.21             185.20 		     0.011039
 4194304    16000            163.51             163.51 		     0.004873
 8388608    16000            163.44             163.44 		     0.002435
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007ff424000000
destroying current CUDA Ctx
