initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 63552, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007ff140000000 pointer=0x7ff140000000
using DMA-BUF for GPU buffer address at 0x7ff140000000 aligned at 0x7ff140000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7ff140000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x2280 PSN 0xc111ee OUT 0x10 RKey 0x183000 VAddr 0x007ff150000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2281 PSN 0x7fe040 OUT 0x10 RKey 0x183000 VAddr 0x007ff150800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2282 PSN 0x5d7c8a OUT 0x10 RKey 0x183000 VAddr 0x007ff151000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2283 PSN 0x10a211 OUT 0x10 RKey 0x183000 VAddr 0x007ff151800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2284 PSN 0xcdfd50 OUT 0x10 RKey 0x183000 VAddr 0x007ff152000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2285 PSN 0xa31072 OUT 0x10 RKey 0x183000 VAddr 0x007ff152800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2286 PSN 0x362de9 OUT 0x10 RKey 0x183000 VAddr 0x007ff153000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2287 PSN 0xe21e2e OUT 0x10 RKey 0x183000 VAddr 0x007ff153800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2288 PSN 0x9b073a OUT 0x10 RKey 0x183000 VAddr 0x007ff154000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2289 PSN 0xbead34 OUT 0x10 RKey 0x183000 VAddr 0x007ff154800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x228a PSN 0xcdacc8 OUT 0x10 RKey 0x183000 VAddr 0x007ff155000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x228b PSN 0x6901bb OUT 0x10 RKey 0x183000 VAddr 0x007ff155800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x228c PSN 0xb0ac8b OUT 0x10 RKey 0x183000 VAddr 0x007ff156000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x228d PSN 0xae42dc OUT 0x10 RKey 0x183000 VAddr 0x007ff156800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x228e PSN 0x93a46a OUT 0x10 RKey 0x183000 VAddr 0x007ff157000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x228f PSN 0x960ce6 OUT 0x10 RKey 0x183000 VAddr 0x007ff157800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2290 PSN 0xa69d03 OUT 0x10 RKey 0x183000 VAddr 0x007ff158000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2291 PSN 0x292401 OUT 0x10 RKey 0x183000 VAddr 0x007ff158800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2292 PSN 0xac7948 OUT 0x10 RKey 0x183000 VAddr 0x007ff159000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2293 PSN 0x8bc95 OUT 0x10 RKey 0x183000 VAddr 0x007ff159800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2294 PSN 0x4c82d2 OUT 0x10 RKey 0x183000 VAddr 0x007ff15a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2295 PSN 0x9d5b39 OUT 0x10 RKey 0x183000 VAddr 0x007ff15a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2296 PSN 0x3684a9 OUT 0x10 RKey 0x183000 VAddr 0x007ff15b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2297 PSN 0xe06fd OUT 0x10 RKey 0x183000 VAddr 0x007ff15b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2298 PSN 0x2378ba OUT 0x10 RKey 0x183000 VAddr 0x007ff15c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2299 PSN 0xc8b6fd OUT 0x10 RKey 0x183000 VAddr 0x007ff15c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x229a PSN 0x792fda OUT 0x10 RKey 0x183000 VAddr 0x007ff15d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x229b PSN 0x9d0f54 OUT 0x10 RKey 0x183000 VAddr 0x007ff15d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x229c PSN 0x8078e3 OUT 0x10 RKey 0x183000 VAddr 0x007ff15e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x229d PSN 0x2371a9 OUT 0x10 RKey 0x183000 VAddr 0x007ff15e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x229e PSN 0x18490b OUT 0x10 RKey 0x183000 VAddr 0x007ff15f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x229f PSN 0x66229e OUT 0x10 RKey 0x183000 VAddr 0x007ff15f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x2280 PSN 0xf88534 OUT 0x10 RKey 0x183100 VAddr 0x007f7cd0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2281 PSN 0x34d90e OUT 0x10 RKey 0x183100 VAddr 0x007f7cd0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2282 PSN 0xdc8040 OUT 0x10 RKey 0x183100 VAddr 0x007f7cd1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2283 PSN 0x42ba8f OUT 0x10 RKey 0x183100 VAddr 0x007f7cd1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2284 PSN 0x4b9ef6 OUT 0x10 RKey 0x183100 VAddr 0x007f7cd2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2285 PSN 0x640820 OUT 0x10 RKey 0x183100 VAddr 0x007f7cd2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2286 PSN 0x4df6ff OUT 0x10 RKey 0x183100 VAddr 0x007f7cd3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2287 PSN 0xf4808c OUT 0x10 RKey 0x183100 VAddr 0x007f7cd3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2288 PSN 0x775d40 OUT 0x10 RKey 0x183100 VAddr 0x007f7cd4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2289 PSN 0x60b1c2 OUT 0x10 RKey 0x183100 VAddr 0x007f7cd4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x228a PSN 0xc9313e OUT 0x10 RKey 0x183100 VAddr 0x007f7cd5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x228b PSN 0x4a6bf9 OUT 0x10 RKey 0x183100 VAddr 0x007f7cd5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x228c PSN 0x469cf1 OUT 0x10 RKey 0x183100 VAddr 0x007f7cd6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x228d PSN 0x89424a OUT 0x10 RKey 0x183100 VAddr 0x007f7cd6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x228e PSN 0xb73a40 OUT 0x10 RKey 0x183100 VAddr 0x007f7cd7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x228f PSN 0xa31d04 OUT 0x10 RKey 0x183100 VAddr 0x007f7cd7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2290 PSN 0x596dc9 OUT 0x10 RKey 0x183100 VAddr 0x007f7cd8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2291 PSN 0x65ec4f OUT 0x10 RKey 0x183100 VAddr 0x007f7cd8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2292 PSN 0x6bd67e OUT 0x10 RKey 0x183100 VAddr 0x007f7cd9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2293 PSN 0x9f093 OUT 0x10 RKey 0x183100 VAddr 0x007f7cd9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2294 PSN 0xadd9f8 OUT 0x10 RKey 0x183100 VAddr 0x007f7cda000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2295 PSN 0x639a67 OUT 0x10 RKey 0x183100 VAddr 0x007f7cda800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2296 PSN 0xcabf3f OUT 0x10 RKey 0x183100 VAddr 0x007f7cdb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2297 PSN 0x15bcdb OUT 0x10 RKey 0x183100 VAddr 0x007f7cdb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2298 PSN 0x795c40 OUT 0x10 RKey 0x183100 VAddr 0x007f7cdc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2299 PSN 0x4cfb0b OUT 0x10 RKey 0x183100 VAddr 0x007f7cdc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x229a PSN 0xd6bdd0 OUT 0x10 RKey 0x183100 VAddr 0x007f7cdd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x229b PSN 0xc58512 OUT 0x10 RKey 0x183100 VAddr 0x007f7cdd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x229c PSN 0xab4ec9 OUT 0x10 RKey 0x183100 VAddr 0x007f7cde000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x229d PSN 0x952897 OUT 0x10 RKey 0x183100 VAddr 0x007f7cde800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x229e PSN 0x450061 OUT 0x10 RKey 0x183100 VAddr 0x007f7cdf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x229f PSN 0x6f763c OUT 0x10 RKey 0x183100 VAddr 0x007f7cdf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.080717            0.079670            4.979351
 4          32000            0.17               0.17   		     5.175699
 8          32000            0.33               0.33   		     5.164847
 16         32000            0.67               0.66   		     5.168710
 32         32000            1.33               1.32   		     5.162539
 64         32000            2.65               2.64   		     5.153062
 128        32000            5.32               5.29   		     5.164240
 256        32000            10.59              10.54  		     5.146506
 512        32000            21.28              21.18  		     5.170823
 1024       32000            42.97              42.73  		     5.216153
 2048       32000            91.25              73.63  		     4.494086
 4096       32000            128.45             122.92 		     3.751369
 8192       32000            194.02             193.88 		     2.958369
 16384      32000            196.09             196.05 		     1.495721
 32768      32000            190.45             177.40 		     0.676713
 65536      32000            191.15             187.21 		     0.357083
 131072     32000            194.44             194.44 		     0.185428
 262144     32000            197.92             197.91 		     0.094373
 524288     32000            198.07             198.07 		     0.047223
 1048576    32000            178.26             178.25 		     0.021249
 2097152    32000            163.68             163.68 		     0.009756
 4194304    32000            163.74             163.74 		     0.004880
 8388608    32000            163.83             163.83 		     0.002441
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007ff140000000
destroying current CUDA Ctx
