initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 45330, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007fe4b6000000 pointer=0x7fe4b6000000
using DMA-BUF for GPU buffer address at 0x7fe4b6000000 aligned at 0x7fe4b6000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7fe4b6000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1622 PSN 0x80af67 OUT 0x10 RKey 0x183000 VAddr 0x007fe4be000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1623 PSN 0x1ca2c5 OUT 0x10 RKey 0x183000 VAddr 0x007fe4be800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1624 PSN 0x7bcd2b OUT 0x10 RKey 0x183000 VAddr 0x007fe4bf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1625 PSN 0xd59c9e OUT 0x10 RKey 0x183000 VAddr 0x007fe4bf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1626 PSN 0xc35959 OUT 0x10 RKey 0x183000 VAddr 0x007fe4c0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1627 PSN 0x175647 OUT 0x10 RKey 0x183000 VAddr 0x007fe4c0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1628 PSN 0xd1479a OUT 0x10 RKey 0x183000 VAddr 0x007fe4c1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1629 PSN 0x2d148b OUT 0x10 RKey 0x183000 VAddr 0x007fe4c1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x162a PSN 0x997ad3 OUT 0x10 RKey 0x183000 VAddr 0x007fe4c2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x162b PSN 0xfd5b59 OUT 0x10 RKey 0x183000 VAddr 0x007fe4c2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x162c PSN 0xf1089 OUT 0x10 RKey 0x183000 VAddr 0x007fe4c3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x162d PSN 0xcbe0e8 OUT 0x10 RKey 0x183000 VAddr 0x007fe4c3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x162e PSN 0xc820b4 OUT 0x10 RKey 0x183000 VAddr 0x007fe4c4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x162f PSN 0xd38e51 OUT 0x10 RKey 0x183000 VAddr 0x007fe4c4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1630 PSN 0x1be33b OUT 0x10 RKey 0x183000 VAddr 0x007fe4c5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1631 PSN 0xb491e3 OUT 0x10 RKey 0x183000 VAddr 0x007fe4c5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1622 PSN 0xf0394a OUT 0x10 RKey 0x182f00 VAddr 0x007f07dc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1623 PSN 0xc04a6c OUT 0x10 RKey 0x182f00 VAddr 0x007f07dc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1624 PSN 0xbe3946 OUT 0x10 RKey 0x182f00 VAddr 0x007f07dd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1625 PSN 0x21e61d OUT 0x10 RKey 0x182f00 VAddr 0x007f07dd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1626 PSN 0x5abe6c OUT 0x10 RKey 0x182f00 VAddr 0x007f07de000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1627 PSN 0xe0715e OUT 0x10 RKey 0x182f00 VAddr 0x007f07de800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1628 PSN 0xfc7a65 OUT 0x10 RKey 0x182f00 VAddr 0x007f07df000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1629 PSN 0x5816fa OUT 0x10 RKey 0x182f00 VAddr 0x007f07df800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x162a PSN 0x6d3e16 OUT 0x10 RKey 0x182f00 VAddr 0x007f07e0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x162b PSN 0x59b0e0 OUT 0x10 RKey 0x182f00 VAddr 0x007f07e0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x162c PSN 0xaac504 OUT 0x10 RKey 0x182f00 VAddr 0x007f07e1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x162d PSN 0xa23b47 OUT 0x10 RKey 0x182f00 VAddr 0x007f07e1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x162e PSN 0xd1f527 OUT 0x10 RKey 0x182f00 VAddr 0x007f07e2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x162f PSN 0xe65548 OUT 0x10 RKey 0x182f00 VAddr 0x007f07e2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1630 PSN 0x908466 OUT 0x10 RKey 0x182f00 VAddr 0x007f07e3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1631 PSN 0xcdd332 OUT 0x10 RKey 0x182f00 VAddr 0x007f07e3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.057785            0.057108            3.569230
 4          16000            0.12               0.12   		     3.669767
 8          16000            0.24               0.23   		     3.667555
 16         16000            0.47               0.47   		     3.673828
 32         16000            0.94               0.94   		     3.654837
 64         16000            1.89               1.88   		     3.676719
 128        16000            3.76               3.76   		     3.668050
 256        16000            7.52               7.49   		     3.659276
 512        16000            15.03              14.99  		     3.660573
 1024       16000            30.02              29.93  		     3.653928
 2048       16000            60.04              59.85  		     3.652985
 4096       16000            120.47             120.04 		     3.663406
 8192       16000            205.94             205.49 		     3.135601
 16384      16000            208.71             208.69 		     1.592154
 32768      16000            209.23             209.17 		     0.797916
 65536      16000            209.31             209.31 		     0.399218
 131072     16000            209.32             209.32 		     0.199625
 262144     16000            209.38             209.38 		     0.099838
 524288     16000            209.44             209.43 		     0.049933
 1048576    16000            209.45             209.44 		     0.024968
 2097152    16000            192.19             192.16 		     0.011454
 4194304    16000            171.08             171.08 		     0.005099
 8388608    16000            171.07             171.07 		     0.002549
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fe4b6000000
destroying current CUDA Ctx
