initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 65599, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f8520000000 pointer=0x7f8520000000
using DMA-BUF for GPU buffer address at 0x7f8520000000 aligned at 0x7f8520000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f8520000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x23fa PSN 0x476c55 OUT 0x10 RKey 0x183000 VAddr 0x007f8530000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x23fb PSN 0x575b52 OUT 0x10 RKey 0x183000 VAddr 0x007f8530800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x23fc PSN 0xd09bfe OUT 0x10 RKey 0x183000 VAddr 0x007f8531000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x23fd PSN 0xd0cb3e OUT 0x10 RKey 0x183000 VAddr 0x007f8531800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x23fe PSN 0x9066b0 OUT 0x10 RKey 0x183000 VAddr 0x007f8532000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x23ff PSN 0x1fbb1c OUT 0x10 RKey 0x183000 VAddr 0x007f8532800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2400 PSN 0xe12115 OUT 0x10 RKey 0x183000 VAddr 0x007f8533000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2401 PSN 0x3ebcb4 OUT 0x10 RKey 0x183000 VAddr 0x007f8533800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2402 PSN 0x887712 OUT 0x10 RKey 0x183000 VAddr 0x007f8534000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2403 PSN 0xfce8f5 OUT 0x10 RKey 0x183000 VAddr 0x007f8534800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2404 PSN 0x5ef72b OUT 0x10 RKey 0x183000 VAddr 0x007f8535000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2405 PSN 0xd51319 OUT 0x10 RKey 0x183000 VAddr 0x007f8535800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2406 PSN 0x80125b OUT 0x10 RKey 0x183000 VAddr 0x007f8536000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2407 PSN 0xbf0935 OUT 0x10 RKey 0x183000 VAddr 0x007f8536800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2408 PSN 0x6e8185 OUT 0x10 RKey 0x183000 VAddr 0x007f8537000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2409 PSN 0xc6e69b OUT 0x10 RKey 0x183000 VAddr 0x007f8537800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x240a PSN 0x5e604b OUT 0x10 RKey 0x183000 VAddr 0x007f8538000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x240b PSN 0xc38672 OUT 0x10 RKey 0x183000 VAddr 0x007f8538800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x240c PSN 0x7c5c9c OUT 0x10 RKey 0x183000 VAddr 0x007f8539000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x240d PSN 0xc38c22 OUT 0x10 RKey 0x183000 VAddr 0x007f8539800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x240e PSN 0xc20311 OUT 0x10 RKey 0x183000 VAddr 0x007f853a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x240f PSN 0x680343 OUT 0x10 RKey 0x183000 VAddr 0x007f853a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2410 PSN 0x3a99b5 OUT 0x10 RKey 0x183000 VAddr 0x007f853b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2411 PSN 0x4d51e3 OUT 0x10 RKey 0x183000 VAddr 0x007f853b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2412 PSN 0xf28d72 OUT 0x10 RKey 0x183000 VAddr 0x007f853c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2413 PSN 0xbb661f OUT 0x10 RKey 0x183000 VAddr 0x007f853c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2414 PSN 0x7da1e OUT 0x10 RKey 0x183000 VAddr 0x007f853d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2415 PSN 0x8e3312 OUT 0x10 RKey 0x183000 VAddr 0x007f853d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2416 PSN 0xfaf192 OUT 0x10 RKey 0x183000 VAddr 0x007f853e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2417 PSN 0x808163 OUT 0x10 RKey 0x183000 VAddr 0x007f853e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2418 PSN 0xdaa406 OUT 0x10 RKey 0x183000 VAddr 0x007f853f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2419 PSN 0xbed4b4 OUT 0x10 RKey 0x183000 VAddr 0x007f853f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x23fa PSN 0xc67e27 OUT 0x10 RKey 0x183100 VAddr 0x007fefb0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x23fb PSN 0x962a85 OUT 0x10 RKey 0x183100 VAddr 0x007fefb0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x23fc PSN 0x3119eb OUT 0x10 RKey 0x183100 VAddr 0x007fefb1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x23fd PSN 0xfbca5e OUT 0x10 RKey 0x183100 VAddr 0x007fefb1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x23fe PSN 0x1f5419 OUT 0x10 RKey 0x183100 VAddr 0x007fefb2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x23ff PSN 0x899a07 OUT 0x10 RKey 0x183100 VAddr 0x007fefb2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2400 PSN 0x56a05a OUT 0x10 RKey 0x183100 VAddr 0x007fefb3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2401 PSN 0xb05e4b OUT 0x10 RKey 0x183100 VAddr 0x007fefb3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2402 PSN 0xc26193 OUT 0x10 RKey 0x183100 VAddr 0x007fefb4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2403 PSN 0xb81b19 OUT 0x10 RKey 0x183100 VAddr 0x007fefb4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2404 PSN 0xd93549 OUT 0x10 RKey 0x183100 VAddr 0x007fefb5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2405 PSN 0xe206a8 OUT 0x10 RKey 0x183100 VAddr 0x007fefb5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2406 PSN 0x20b374 OUT 0x10 RKey 0x183100 VAddr 0x007fefb6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2407 PSN 0x628a11 OUT 0x10 RKey 0x183100 VAddr 0x007fefb6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2408 PSN 0x2b93fb OUT 0x10 RKey 0x183100 VAddr 0x007fefb7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2409 PSN 0x2f53a3 OUT 0x10 RKey 0x183100 VAddr 0x007fefb7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x240a PSN 0xb3897c OUT 0x10 RKey 0x183100 VAddr 0x007fefb8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x240b PSN 0xaa8986 OUT 0x10 RKey 0x183100 VAddr 0x007fefb8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x240c PSN 0x9630e9 OUT 0x10 RKey 0x183100 VAddr 0x007fefb9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x240d PSN 0xf29222 OUT 0x10 RKey 0x183100 VAddr 0x007fefb9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x240e PSN 0xb51ddb OUT 0x10 RKey 0x183100 VAddr 0x007fefba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x240f PSN 0xbd740e OUT 0x10 RKey 0x183100 VAddr 0x007fefba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2410 PSN 0x8c755a OUT 0x10 RKey 0x183100 VAddr 0x007fefbb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2411 PSN 0x10885a OUT 0x10 RKey 0x183100 VAddr 0x007fefbb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2412 PSN 0x2a1b53 OUT 0x10 RKey 0x183100 VAddr 0x007fefbc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2413 PSN 0xbd6822 OUT 0x10 RKey 0x183100 VAddr 0x007fefbc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2414 PSN 0xebda9b OUT 0x10 RKey 0x183100 VAddr 0x007fefbd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2415 PSN 0xc52981 OUT 0x10 RKey 0x183100 VAddr 0x007fefbd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2416 PSN 0x940c0c OUT 0x10 RKey 0x183100 VAddr 0x007fefbe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2417 PSN 0x7bf01e OUT 0x10 RKey 0x183100 VAddr 0x007fefbe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2418 PSN 0x3f3edc OUT 0x10 RKey 0x183100 VAddr 0x007fefbf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2419 PSN 0x82929b OUT 0x10 RKey 0x183100 VAddr 0x007fefbf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.056075            0.055946            3.496645
 4          32000            0.11               0.11   		     3.543484
 8          32000            0.23               0.23   		     3.539267
 16         32000            0.45               0.45   		     3.541570
 32         32000            0.91               0.91   		     3.547180
 64         32000            1.82               1.82   		     3.545663
 128        32000            3.63               3.63   		     3.540093
 256        32000            7.27               7.26   		     3.545392
 512        32000            14.51              14.49  		     3.538778
 1024       32000            29.03              28.98  		     3.537260
 2048       32000            57.42              57.09  		     3.484673
 4096       32000            116.47             98.32  		     3.000452
 8192       32000            179.39             134.28 		     2.048990
 16384      32000            186.54             161.04 		     1.228641
 32768      32000            195.89             195.87 		     0.747192
 65536      32000            197.30             197.28 		     0.376273
 131072     32000            197.18             197.18 		     0.188043
 262144     32000            197.09             197.09 		     0.093980
 524288     32000            196.00             195.99 		     0.046729
 1048576    32000            178.45             178.45 		     0.021273
 2097152    32000            163.50             163.49 		     0.009745
 4194304    32000            163.36             163.36 		     0.004869
 8388608    32000            163.44             163.44 		     0.002435
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f8520000000
destroying current CUDA Ctx
