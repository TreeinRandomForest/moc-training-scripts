initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 51015, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fbd00000000 pointer=0x7fbd00000000
using DMA-BUF for GPU buffer address at 0x7fbd00000000 aligned at 0x7fbd00000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fbd00000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1a22 PSN 0xb3dcfa OUT 0x10 RKey 0x183100 VAddr 0x007fbd10000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a23 PSN 0x5d1c5c OUT 0x10 RKey 0x183100 VAddr 0x007fbd10800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a24 PSN 0x613c76 OUT 0x10 RKey 0x183100 VAddr 0x007fbd11000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a25 PSN 0xa7618d OUT 0x10 RKey 0x183100 VAddr 0x007fbd11800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a26 PSN 0x56ed1c OUT 0x10 RKey 0x183100 VAddr 0x007fbd12000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a27 PSN 0x72724e OUT 0x10 RKey 0x183100 VAddr 0x007fbd12800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a28 PSN 0x3e8095 OUT 0x10 RKey 0x183100 VAddr 0x007fbd13000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a29 PSN 0x43d96a OUT 0x10 RKey 0x183100 VAddr 0x007fbd13800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a2a PSN 0xbfa7c6 OUT 0x10 RKey 0x183100 VAddr 0x007fbd14000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a2b PSN 0xa4d0d0 OUT 0x10 RKey 0x183100 VAddr 0x007fbd14800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a2c PSN 0x98fe34 OUT 0x10 RKey 0x183100 VAddr 0x007fbd15000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a2d PSN 0xb1b4b7 OUT 0x10 RKey 0x183100 VAddr 0x007fbd15800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a2e PSN 0xc349d7 OUT 0x10 RKey 0x183100 VAddr 0x007fbd16000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a2f PSN 0xfd8438 OUT 0x10 RKey 0x183100 VAddr 0x007fbd16800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a30 PSN 0xdb2096 OUT 0x10 RKey 0x183100 VAddr 0x007fbd17000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a31 PSN 0x2573a2 OUT 0x10 RKey 0x183100 VAddr 0x007fbd17800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a32 PSN 0x52430f OUT 0x10 RKey 0x183100 VAddr 0x007fbd18000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a33 PSN 0x7d9f1d OUT 0x10 RKey 0x183100 VAddr 0x007fbd18800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a34 PSN 0x100c34 OUT 0x10 RKey 0x183100 VAddr 0x007fbd19000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a35 PSN 0xfe5311 OUT 0x10 RKey 0x183100 VAddr 0x007fbd19800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a36 PSN 0x60fd9e OUT 0x10 RKey 0x183100 VAddr 0x007fbd1a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a37 PSN 0xb8ec15 OUT 0x10 RKey 0x183100 VAddr 0x007fbd1a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a38 PSN 0xe8da55 OUT 0x10 RKey 0x183100 VAddr 0x007fbd1b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a39 PSN 0x850939 OUT 0x10 RKey 0x183100 VAddr 0x007fbd1b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a3a PSN 0x215446 OUT 0x10 RKey 0x183100 VAddr 0x007fbd1c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a3b PSN 0x2ef999 OUT 0x10 RKey 0x183100 VAddr 0x007fbd1c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a3c PSN 0xabb446 OUT 0x10 RKey 0x183100 VAddr 0x007fbd1d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a3d PSN 0xa87950 OUT 0x10 RKey 0x183100 VAddr 0x007fbd1d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a3e PSN 0xe5012f OUT 0x10 RKey 0x183100 VAddr 0x007fbd1e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a3f PSN 0x75c205 OUT 0x10 RKey 0x183100 VAddr 0x007fbd1e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a40 PSN 0x272837 OUT 0x10 RKey 0x183100 VAddr 0x007fbd1f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a41 PSN 0xccb05a OUT 0x10 RKey 0x183100 VAddr 0x007fbd1f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1a22 PSN 0xab534a OUT 0x10 RKey 0x183000 VAddr 0x007f1650000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a23 PSN 0xc65c6c OUT 0x10 RKey 0x183000 VAddr 0x007f1650800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a24 PSN 0x7fe346 OUT 0x10 RKey 0x183000 VAddr 0x007f1651000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a25 PSN 0x53481d OUT 0x10 RKey 0x183000 VAddr 0x007f1651800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a26 PSN 0x6d786c OUT 0x10 RKey 0x183000 VAddr 0x007f1652000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a27 PSN 0xf5a35e OUT 0x10 RKey 0x183000 VAddr 0x007f1652800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a28 PSN 0xeec465 OUT 0x10 RKey 0x183000 VAddr 0x007f1653000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a29 PSN 0xfd98fa OUT 0x10 RKey 0x183000 VAddr 0x007f1653800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a2a PSN 0xb19816 OUT 0x10 RKey 0x183000 VAddr 0x007f1654000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a2b PSN 0x5002e0 OUT 0x10 RKey 0x183000 VAddr 0x007f1654800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a2c PSN 0x37af04 OUT 0x10 RKey 0x183000 VAddr 0x007f1655000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a2d PSN 0xdddd47 OUT 0x10 RKey 0x183000 VAddr 0x007f1655800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a2e PSN 0xc1ef27 OUT 0x10 RKey 0x183000 VAddr 0x007f1656000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a2f PSN 0xafc748 OUT 0x10 RKey 0x183000 VAddr 0x007f1656800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a30 PSN 0xc20e66 OUT 0x10 RKey 0x183000 VAddr 0x007f1657000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a31 PSN 0xe19532 OUT 0x10 RKey 0x183000 VAddr 0x007f1657800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a32 PSN 0x53ed5f OUT 0x10 RKey 0x183000 VAddr 0x007f1658000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a33 PSN 0xf7032d OUT 0x10 RKey 0x183000 VAddr 0x007f1658800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a34 PSN 0x660704 OUT 0x10 RKey 0x183000 VAddr 0x007f1659000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a35 PSN 0xb0fda1 OUT 0x10 RKey 0x183000 VAddr 0x007f1659800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a36 PSN 0x70fcee OUT 0x10 RKey 0x183000 VAddr 0x007f165a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a37 PSN 0xaa8125 OUT 0x10 RKey 0x183000 VAddr 0x007f165a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a38 PSN 0x71b225 OUT 0x10 RKey 0x183000 VAddr 0x007f165b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a39 PSN 0x6dccc9 OUT 0x10 RKey 0x183000 VAddr 0x007f165b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a3a PSN 0xaff896 OUT 0x10 RKey 0x183000 VAddr 0x007f165c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a3b PSN 0x4acfa9 OUT 0x10 RKey 0x183000 VAddr 0x007f165c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a3c PSN 0x983916 OUT 0x10 RKey 0x183000 VAddr 0x007f165d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a3d PSN 0x6fe5e0 OUT 0x10 RKey 0x183000 VAddr 0x007f165d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a3e PSN 0x179a7f OUT 0x10 RKey 0x183000 VAddr 0x007f165e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a3f PSN 0x7ee915 OUT 0x10 RKey 0x183000 VAddr 0x007f165e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a40 PSN 0xe52a07 OUT 0x10 RKey 0x183000 VAddr 0x007f165f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a41 PSN 0x1455ea OUT 0x10 RKey 0x183000 VAddr 0x007f165f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.057878            0.057736            3.608521
 4          32000            0.12               0.12   		     3.664829
 8          32000            0.24               0.23   		     3.663398
 16         32000            0.47               0.47   		     3.678914
 32         32000            0.94               0.94   		     3.676978
 64         32000            1.89               1.89   		     3.694399
 128        32000            3.77               3.74   		     3.652868
 256        32000            7.58               7.56   		     3.690824
 512        32000            15.13              15.11  		     3.688706
 1024       32000            30.22              30.18  		     3.684530
 2048       32000            59.65              59.38  		     3.624505
 4096       32000            121.26             120.46 		     3.676040
 8192       32000            196.87             196.72 		     3.001643
 16384      32000            197.79             197.73 		     1.508542
 32768      32000            197.86             197.82 		     0.754635
 65536      32000            197.83             197.82 		     0.377304
 131072     32000            197.93             197.91 		     0.188744
 262144     32000            197.94             197.93 		     0.094380
 524288     32000            197.95             197.95 		     0.047195
 1048576    32000            178.62             178.62 		     0.021293
 2097152    32000            164.05             164.05 		     0.009778
 4194304    32000            163.94             163.94 		     0.004886
 8388608    32000            163.96             163.96 		     0.002443
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fbd00000000
destroying current CUDA Ctx
