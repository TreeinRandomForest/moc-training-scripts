initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 60140, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fb7e0000000 pointer=0x7fb7e0000000
using DMA-BUF for GPU buffer address at 0x7fb7e0000000 aligned at 0x7fb7e0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fb7e0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x200a PSN 0x4afc7a OUT 0x10 RKey 0x183000 VAddr 0x007fb7f0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x200b PSN 0x285dc OUT 0x10 RKey 0x183000 VAddr 0x007fb7f0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x200c PSN 0x9827f6 OUT 0x10 RKey 0x183000 VAddr 0x007fb7f1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x200d PSN 0x9ea70d OUT 0x10 RKey 0x183000 VAddr 0x007fb7f1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x200e PSN 0x10849c OUT 0x10 RKey 0x183000 VAddr 0x007fb7f2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x200f PSN 0x94f3ce OUT 0x10 RKey 0x183000 VAddr 0x007fb7f2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2010 PSN 0x48a415 OUT 0x10 RKey 0x183000 VAddr 0x007fb7f3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2011 PSN 0x79f6ea OUT 0x10 RKey 0x183000 VAddr 0x007fb7f3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2012 PSN 0x4b3746 OUT 0x10 RKey 0x183000 VAddr 0x007fb7f4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2013 PSN 0xfdea50 OUT 0x10 RKey 0x183000 VAddr 0x007fb7f4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2014 PSN 0x71d9b4 OUT 0x10 RKey 0x183000 VAddr 0x007fb7f5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2015 PSN 0x3c2a37 OUT 0x10 RKey 0x183000 VAddr 0x007fb7f5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2016 PSN 0x485157 OUT 0x10 RKey 0x183000 VAddr 0x007fb7f6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2017 PSN 0x5eb5b8 OUT 0x10 RKey 0x183000 VAddr 0x007fb7f6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2018 PSN 0xb63416 OUT 0x10 RKey 0x183000 VAddr 0x007fb7f7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2019 PSN 0xf1c122 OUT 0x10 RKey 0x183000 VAddr 0x007fb7f7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x201a PSN 0xf0428f OUT 0x10 RKey 0x183000 VAddr 0x007fb7f8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x201b PSN 0x50689d OUT 0x10 RKey 0x183000 VAddr 0x007fb7f8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x201c PSN 0xd8d7b4 OUT 0x10 RKey 0x183000 VAddr 0x007fb7f9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x201d PSN 0x51f891 OUT 0x10 RKey 0x183000 VAddr 0x007fb7f9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x201e PSN 0xaf751e OUT 0x10 RKey 0x183000 VAddr 0x007fb7fa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x201f PSN 0x7ecd95 OUT 0x10 RKey 0x183000 VAddr 0x007fb7fa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2020 PSN 0xc2ddd5 OUT 0x10 RKey 0x183000 VAddr 0x007fb7fb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2021 PSN 0x7d86b9 OUT 0x10 RKey 0x183000 VAddr 0x007fb7fb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2022 PSN 0xafc3c6 OUT 0x10 RKey 0x183000 VAddr 0x007fb7fc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2023 PSN 0x17319 OUT 0x10 RKey 0x183000 VAddr 0x007fb7fc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2024 PSN 0x726fc6 OUT 0x10 RKey 0x183000 VAddr 0x007fb7fd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2025 PSN 0xbb4ed0 OUT 0x10 RKey 0x183000 VAddr 0x007fb7fd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2026 PSN 0xbae8af OUT 0x10 RKey 0x183000 VAddr 0x007fb7fe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2027 PSN 0x865385 OUT 0x10 RKey 0x183000 VAddr 0x007fb7fe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2028 PSN 0xee1bb7 OUT 0x10 RKey 0x183000 VAddr 0x007fb7ff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2029 PSN 0x475dda OUT 0x10 RKey 0x183000 VAddr 0x007fb7ff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x200a PSN 0x46f04b OUT 0x10 RKey 0x183100 VAddr 0x007f6f70000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x200b PSN 0x31bd9 OUT 0x10 RKey 0x183100 VAddr 0x007f6f70800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x200c PSN 0xd552af OUT 0x10 RKey 0x183100 VAddr 0x007f6f71000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x200d PSN 0x980dd2 OUT 0x10 RKey 0x183100 VAddr 0x007f6f71800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x200e PSN 0x32447d OUT 0x10 RKey 0x183100 VAddr 0x007f6f72000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x200f PSN 0xc3cc9b OUT 0x10 RKey 0x183100 VAddr 0x007f6f72800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2010 PSN 0xff215e OUT 0x10 RKey 0x183100 VAddr 0x007f6f73000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2011 PSN 0x8e4ff OUT 0x10 RKey 0x183100 VAddr 0x007f6f73800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2012 PSN 0x697437 OUT 0x10 RKey 0x183100 VAddr 0x007f6f74000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2013 PSN 0xca62ed OUT 0x10 RKey 0x183100 VAddr 0x007f6f74800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2014 PSN 0x9a428d OUT 0x10 RKey 0x183100 VAddr 0x007f6f75000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2015 PSN 0xafc49c OUT 0x10 RKey 0x183100 VAddr 0x007f6f75800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2016 PSN 0x53cc58 OUT 0x10 RKey 0x183100 VAddr 0x007f6f76000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2017 PSN 0xb0fb25 OUT 0x10 RKey 0x183100 VAddr 0x007f6f76800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2018 PSN 0x99b17f OUT 0x10 RKey 0x183100 VAddr 0x007f6f77000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2019 PSN 0x467cd7 OUT 0x10 RKey 0x183100 VAddr 0x007f6f77800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x201a PSN 0x84cca0 OUT 0x10 RKey 0x183100 VAddr 0x007f6f78000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x201b PSN 0x4677da OUT 0x10 RKey 0x183100 VAddr 0x007f6f78800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x201c PSN 0x8a22ad OUT 0x10 RKey 0x183100 VAddr 0x007f6f79000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x201d PSN 0xb69a96 OUT 0x10 RKey 0x183100 VAddr 0x007f6f79800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x201e PSN 0xb4ef3f OUT 0x10 RKey 0x183100 VAddr 0x007f6f7a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x201f PSN 0xf973a2 OUT 0x10 RKey 0x183100 VAddr 0x007f6f7a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2020 PSN 0x273f5e OUT 0x10 RKey 0x183100 VAddr 0x007f6f7b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2021 PSN 0x28240e OUT 0x10 RKey 0x183100 VAddr 0x007f6f7b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2022 PSN 0xb1ef7 OUT 0x10 RKey 0x183100 VAddr 0x007f6f7c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2023 PSN 0x14cf6 OUT 0x10 RKey 0x183100 VAddr 0x007f6f7c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2024 PSN 0xdac0df OUT 0x10 RKey 0x183100 VAddr 0x007f6f7d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2025 PSN 0xe4c75 OUT 0x10 RKey 0x183100 VAddr 0x007f6f7d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2026 PSN 0xf25f0 OUT 0x10 RKey 0x183100 VAddr 0x007f6f7e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2027 PSN 0x58ce32 OUT 0x10 RKey 0x183100 VAddr 0x007f6f7e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2028 PSN 0x3fc560 OUT 0x10 RKey 0x183100 VAddr 0x007f6f7f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2029 PSN 0x4670cf OUT 0x10 RKey 0x183100 VAddr 0x007f6f7f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.081438            0.080961            5.060082
 4          32000            0.17               0.16   		     5.001299
 8          32000            0.33               0.33   		     5.216837
 16         32000            0.67               0.67   		     5.231890
 32         32000            1.34               1.34   		     5.238783
 64         32000            2.69               2.68   		     5.227623
 128        32000            5.37               5.35   		     5.221839
 256        32000            10.74              10.71  		     5.231832
 512        32000            21.43              21.37  		     5.217754
 1024       32000            42.86              42.80  		     5.224548
 2048       32000            85.13              84.87  		     5.180065
 4096       32000            171.45             171.06 		     5.220241
 8192       32000            201.99             201.93 		     3.081133
 16384      32000            202.54             202.51 		     1.545005
 32768      32000            202.68             202.65 		     0.773060
 65536      32000            198.15             198.13 		     0.377901
 131072     32000            200.56             200.55 		     0.191259
 262144     32000            199.17             199.17 		     0.094973
 524288     32000            199.57             199.57 		     0.047581
 1048576    32000            182.59             182.59 		     0.021767
 2097152    32000            166.91             166.91 		     0.009949
 4194304    32000            167.94             167.31 		     0.004986
 8388608    32000            167.22             167.06 		     0.002489
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fb7e0000000
destroying current CUDA Ctx
