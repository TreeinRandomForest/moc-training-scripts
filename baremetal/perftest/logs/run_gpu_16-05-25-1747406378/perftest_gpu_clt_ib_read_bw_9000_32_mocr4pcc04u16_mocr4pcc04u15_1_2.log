initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 61497, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fd940000000 pointer=0x7fd940000000
using DMA-BUF for GPU buffer address at 0x7fd940000000 aligned at 0x7fd940000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fd940000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x2106 PSN 0x7a6ec0 OUT 0x10 RKey 0x183000 VAddr 0x007fd950000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2107 PSN 0xdf84e1 OUT 0x10 RKey 0x183000 VAddr 0x007fd950800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2108 PSN 0xf4c7e1 OUT 0x10 RKey 0x183000 VAddr 0x007fd951000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2109 PSN 0xe96ce5 OUT 0x10 RKey 0x183000 VAddr 0x007fd951800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x210a PSN 0x3d44cb OUT 0x10 RKey 0x183000 VAddr 0x007fd952000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x210b PSN 0x2a8e9b OUT 0x10 RKey 0x183000 VAddr 0x007fd952800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x210c PSN 0x954828 OUT 0x10 RKey 0x183000 VAddr 0x007fd953000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x210d PSN 0x9271cb OUT 0x10 RKey 0x183000 VAddr 0x007fd953800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x210e PSN 0x133bdd OUT 0x10 RKey 0x183000 VAddr 0x007fd954000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x210f PSN 0x51564 OUT 0x10 RKey 0x183000 VAddr 0x007fd954800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2110 PSN 0x199c6e OUT 0x10 RKey 0x183000 VAddr 0x007fd955000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2111 PSN 0x8ba2a0 OUT 0x10 RKey 0x183000 VAddr 0x007fd955800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2112 PSN 0xa278d6 OUT 0x10 RKey 0x183000 VAddr 0x007fd956000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2113 PSN 0xdb2d94 OUT 0x10 RKey 0x183000 VAddr 0x007fd956800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2114 PSN 0xab57f8 OUT 0x10 RKey 0x183000 VAddr 0x007fd957000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2115 PSN 0x5d8792 OUT 0x10 RKey 0x183000 VAddr 0x007fd957800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2116 PSN 0xd2d376 OUT 0x10 RKey 0x183000 VAddr 0x007fd958000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2117 PSN 0x7531c1 OUT 0x10 RKey 0x183000 VAddr 0x007fd958800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2118 PSN 0xdf473f OUT 0x10 RKey 0x183000 VAddr 0x007fd959000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2119 PSN 0xf3e589 OUT 0x10 RKey 0x183000 VAddr 0x007fd959800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x211a PSN 0x9e9dec OUT 0x10 RKey 0x183000 VAddr 0x007fd95a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x211b PSN 0x5ab482 OUT 0x10 RKey 0x183000 VAddr 0x007fd95a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x211c PSN 0xe2ab88 OUT 0x10 RKey 0x183000 VAddr 0x007fd95b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x211d PSN 0x647aba OUT 0x10 RKey 0x183000 VAddr 0x007fd95b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x211e PSN 0xb41afd OUT 0x10 RKey 0x183000 VAddr 0x007fd95c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x211f PSN 0x738c4e OUT 0x10 RKey 0x183000 VAddr 0x007fd95c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2120 PSN 0x125621 OUT 0x10 RKey 0x183000 VAddr 0x007fd95d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2121 PSN 0x33b259 OUT 0x10 RKey 0x183000 VAddr 0x007fd95d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2122 PSN 0x3feccd OUT 0x10 RKey 0x183000 VAddr 0x007fd95e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2123 PSN 0xfa7b82 OUT 0x10 RKey 0x183000 VAddr 0x007fd95e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2124 PSN 0x15fd39 OUT 0x10 RKey 0x183000 VAddr 0x007fd95f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2125 PSN 0x2ba16b OUT 0x10 RKey 0x183000 VAddr 0x007fd95f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x2106 PSN 0x61afa6 OUT 0x10 RKey 0x183100 VAddr 0x007f9b30000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2107 PSN 0xaccacf OUT 0x10 RKey 0x183100 VAddr 0x007f9b30800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2108 PSN 0x976237 OUT 0x10 RKey 0x183100 VAddr 0x007f9b31000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2109 PSN 0x166783 OUT 0x10 RKey 0x183100 VAddr 0x007f9b31800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x210a PSN 0x35ee11 OUT 0x10 RKey 0x183100 VAddr 0x007f9b32000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x210b PSN 0xa78569 OUT 0x10 RKey 0x183100 VAddr 0x007f9b32800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x210c PSN 0x6f71de OUT 0x10 RKey 0x183100 VAddr 0x007f9b33000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x210d PSN 0xb7b849 OUT 0x10 RKey 0x183100 VAddr 0x007f9b33800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x210e PSN 0x6f7383 OUT 0x10 RKey 0x183100 VAddr 0x007f9b34000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x210f PSN 0x4feb12 OUT 0x10 RKey 0x183100 VAddr 0x007f9b34800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2110 PSN 0x58eb84 OUT 0x10 RKey 0x183100 VAddr 0x007f9b35000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2111 PSN 0xd612fe OUT 0x10 RKey 0x183100 VAddr 0x007f9b35800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2112 PSN 0xf0c4dc OUT 0x10 RKey 0x183100 VAddr 0x007f9b36000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2113 PSN 0x6f022 OUT 0x10 RKey 0x183100 VAddr 0x007f9b36800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2114 PSN 0xc26e OUT 0x10 RKey 0x183100 VAddr 0x007f9b37000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2115 PSN 0x29dfd0 OUT 0x10 RKey 0x183100 VAddr 0x007f9b37800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2116 PSN 0x4419dc OUT 0x10 RKey 0x183100 VAddr 0x007f9b38000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2117 PSN 0xf7cf2f OUT 0x10 RKey 0x183100 VAddr 0x007f9b38800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2118 PSN 0x552315 OUT 0x10 RKey 0x183100 VAddr 0x007f9b39000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2119 PSN 0xecc3a7 OUT 0x10 RKey 0x183100 VAddr 0x007f9b39800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x211a PSN 0xcc24b2 OUT 0x10 RKey 0x183100 VAddr 0x007f9b3a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x211b PSN 0x5afad0 OUT 0x10 RKey 0x183100 VAddr 0x007f9b3a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x211c PSN 0x12aebe OUT 0x10 RKey 0x183100 VAddr 0x007f9b3b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x211d PSN 0x805cb8 OUT 0x10 RKey 0x183100 VAddr 0x007f9b3b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x211e PSN 0xc58823 OUT 0x10 RKey 0x183100 VAddr 0x007f9b3c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x211f PSN 0xf7297c OUT 0x10 RKey 0x183100 VAddr 0x007f9b3c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2120 PSN 0xbb96b7 OUT 0x10 RKey 0x183100 VAddr 0x007f9b3d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2121 PSN 0x92f637 OUT 0x10 RKey 0x183100 VAddr 0x007f9b3d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2122 PSN 0x714653 OUT 0x10 RKey 0x183100 VAddr 0x007f9b3e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2123 PSN 0xf3fd90 OUT 0x10 RKey 0x183100 VAddr 0x007f9b3e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2124 PSN 0x12f12f OUT 0x10 RKey 0x183100 VAddr 0x007f9b3f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2125 PSN 0xd68529 OUT 0x10 RKey 0x183100 VAddr 0x007f9b3f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.079470            0.078740            4.921268
 4          32000            0.16               0.16   		     5.114049
 8          32000            0.33               0.33   		     5.118158
 16         32000            0.66               0.66   		     5.123328
 32         32000            1.32               1.31   		     5.119214
 64         32000            2.63               2.62   		     5.109634
 128        32000            5.25               5.23   		     5.104596
 256        32000            10.47              10.45  		     5.103619
 512        32000            20.99              20.93  		     5.110548
 1024       32000            41.89              41.71  		     5.092095
 2048       32000            83.40              83.17  		     5.076150
 4096       32000            167.18             166.95 		     5.094779
 8192       32000            200.35             200.20 		     3.054863
 16384      32000            197.66             197.56 		     1.507228
 32768      32000            201.31             201.28 		     0.767815
 65536      32000            202.13             202.13 		     0.385531
 131072     32000            201.91             201.89 		     0.192542
 262144     32000            199.39             199.39 		     0.095075
 524288     32000            199.59             199.59 		     0.047586
 1048576    32000            180.88             180.88 		     0.021562
 2097152    32000            168.78             167.12 		     0.009961
 4194304    32000            168.04             167.23 		     0.004984
 8388608    32000            167.39             167.32 		     0.002493
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fd940000000
destroying current CUDA Ctx
