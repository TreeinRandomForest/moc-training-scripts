initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 48266, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fa2e0000000 pointer=0x7fa2e0000000
using DMA-BUF for GPU buffer address at 0x7fa2e0000000 aligned at 0x7fa2e0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fa2e0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x182a PSN 0xf58f24 OUT 0x10 RKey 0x183100 VAddr 0x007fa2f0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x182b PSN 0x1fb43e OUT 0x10 RKey 0x183100 VAddr 0x007fa2f0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x182c PSN 0x8f3b0 OUT 0x10 RKey 0x183100 VAddr 0x007fa2f1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x182d PSN 0x26813f OUT 0x10 RKey 0x183100 VAddr 0x007fa2f1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x182e PSN 0x957e6 OUT 0x10 RKey 0x183100 VAddr 0x007fa2f2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x182f PSN 0x936650 OUT 0x10 RKey 0x183100 VAddr 0x007fa2f2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1830 PSN 0x58316f OUT 0x10 RKey 0x183100 VAddr 0x007fa2f3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1831 PSN 0x10023c OUT 0x10 RKey 0x183100 VAddr 0x007fa2f3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1832 PSN 0xf1b530 OUT 0x10 RKey 0x183100 VAddr 0x007fa2f4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1833 PSN 0xb9c2f2 OUT 0x10 RKey 0x183100 VAddr 0x007fa2f4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1834 PSN 0x66a2ae OUT 0x10 RKey 0x183100 VAddr 0x007fa2f5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1835 PSN 0x7e58a9 OUT 0x10 RKey 0x183100 VAddr 0x007fa2f5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1836 PSN 0x4883e1 OUT 0x10 RKey 0x183100 VAddr 0x007fa2f6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1837 PSN 0x14367a OUT 0x10 RKey 0x183100 VAddr 0x007fa2f6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1838 PSN 0x8452b0 OUT 0x10 RKey 0x183100 VAddr 0x007fa2f7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1839 PSN 0x2b24b4 OUT 0x10 RKey 0x183100 VAddr 0x007fa2f7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x183a PSN 0x6cd3b9 OUT 0x10 RKey 0x183100 VAddr 0x007fa2f8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x183b PSN 0x7df37f OUT 0x10 RKey 0x183100 VAddr 0x007fa2f8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x183c PSN 0x5c05ee OUT 0x10 RKey 0x183100 VAddr 0x007fa2f9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x183d PSN 0x2cc343 OUT 0x10 RKey 0x183100 VAddr 0x007fa2f9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x183e PSN 0xbaee8 OUT 0x10 RKey 0x183100 VAddr 0x007fa2fa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x183f PSN 0xe6e497 OUT 0x10 RKey 0x183100 VAddr 0x007fa2fa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1840 PSN 0x9875af OUT 0x10 RKey 0x183100 VAddr 0x007fa2fb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1841 PSN 0xd50a8b OUT 0x10 RKey 0x183100 VAddr 0x007fa2fb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1842 PSN 0xf99030 OUT 0x10 RKey 0x183100 VAddr 0x007fa2fc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1843 PSN 0xccb83b OUT 0x10 RKey 0x183100 VAddr 0x007fa2fc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1844 PSN 0x736b40 OUT 0x10 RKey 0x183100 VAddr 0x007fa2fd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1845 PSN 0x8dfdc2 OUT 0x10 RKey 0x183100 VAddr 0x007fa2fd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1846 PSN 0xb4d1b9 OUT 0x10 RKey 0x183100 VAddr 0x007fa2fe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1847 PSN 0x8588c7 OUT 0x10 RKey 0x183100 VAddr 0x007fa2fe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1848 PSN 0x4914d1 OUT 0x10 RKey 0x183100 VAddr 0x007fa2ff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1849 PSN 0xc8c9ec OUT 0x10 RKey 0x183100 VAddr 0x007fa2ff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x182a PSN 0xaaf1ca OUT 0x10 RKey 0x183000 VAddr 0x007f5ff0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x182b PSN 0x3d8ec OUT 0x10 RKey 0x183000 VAddr 0x007f5ff0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x182c PSN 0x88e5c6 OUT 0x10 RKey 0x183000 VAddr 0x007f5ff1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x182d PSN 0x68589d OUT 0x10 RKey 0x183000 VAddr 0x007f5ff1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x182e PSN 0x387eec OUT 0x10 RKey 0x183000 VAddr 0x007f5ff2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x182f PSN 0x3e67de OUT 0x10 RKey 0x183000 VAddr 0x007f5ff2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1830 PSN 0x756ee5 OUT 0x10 RKey 0x183000 VAddr 0x007f5ff3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1831 PSN 0x83317a OUT 0x10 RKey 0x183000 VAddr 0x007f5ff3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1832 PSN 0x968696 OUT 0x10 RKey 0x183000 VAddr 0x007f5ff4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1833 PSN 0x108f60 OUT 0x10 RKey 0x183000 VAddr 0x007f5ff4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1834 PSN 0x6e8184 OUT 0x10 RKey 0x183000 VAddr 0x007f5ff5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1835 PSN 0x547dc7 OUT 0x10 RKey 0x183000 VAddr 0x007f5ff5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1836 PSN 0x7745a7 OUT 0x10 RKey 0x183000 VAddr 0x007f5ff6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1837 PSN 0x9c9bc8 OUT 0x10 RKey 0x183000 VAddr 0x007f5ff6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1838 PSN 0x8388e6 OUT 0x10 RKey 0x183000 VAddr 0x007f5ff7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1839 PSN 0x51bdb2 OUT 0x10 RKey 0x183000 VAddr 0x007f5ff7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x183a PSN 0x782bdf OUT 0x10 RKey 0x183000 VAddr 0x007f5ff8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x183b PSN 0x8c9fad OUT 0x10 RKey 0x183000 VAddr 0x007f5ff8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x183c PSN 0xb4a984 OUT 0x10 RKey 0x183000 VAddr 0x007f5ff9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x183d PSN 0x2b2e21 OUT 0x10 RKey 0x183000 VAddr 0x007f5ff9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x183e PSN 0xaa36e OUT 0x10 RKey 0x183000 VAddr 0x007f5ffa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x183f PSN 0xad65a5 OUT 0x10 RKey 0x183000 VAddr 0x007f5ffa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1840 PSN 0xf7fca5 OUT 0x10 RKey 0x183000 VAddr 0x007f5ffb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1841 PSN 0x8a8549 OUT 0x10 RKey 0x183000 VAddr 0x007f5ffb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1842 PSN 0xad8716 OUT 0x10 RKey 0x183000 VAddr 0x007f5ffc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1843 PSN 0x477c29 OUT 0x10 RKey 0x183000 VAddr 0x007f5ffc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1844 PSN 0x28ab96 OUT 0x10 RKey 0x183000 VAddr 0x007f5ffd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1845 PSN 0xcfa660 OUT 0x10 RKey 0x183000 VAddr 0x007f5ffd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1846 PSN 0xcf90ff OUT 0x10 RKey 0x183000 VAddr 0x007f5ffe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1847 PSN 0x49dd95 OUT 0x10 RKey 0x183000 VAddr 0x007f5ffe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1848 PSN 0xfa4487 OUT 0x10 RKey 0x183000 VAddr 0x007f5fff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1849 PSN 0xdf9e6a OUT 0x10 RKey 0x183000 VAddr 0x007f5fff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.057878            0.057687            3.605423
 4          32000            0.12               0.12   		     3.675314
 8          32000            0.24               0.24   		     3.690905
 16         32000            0.47               0.47   		     3.685884
 32         32000            0.95               0.94   		     3.689463
 64         32000            1.89               1.88   		     3.676479
 128        32000            3.76               3.75   		     3.661675
 256        32000            7.54               7.53   		     3.675284
 512        32000            15.06              15.01  		     3.663595
 1024       32000            30.17              30.13  		     3.678119
 2048       32000            60.14              59.99  		     3.661231
 4096       32000            119.49             118.88 		     3.628023
 8192       32000            201.72             201.55 		     3.075409
 16384      32000            202.55             202.48 		     1.544809
 32768      32000            202.69             202.67 		     0.773128
 65536      32000            202.68             202.66 		     0.386536
 131072     32000            202.72             202.71 		     0.193319
 262144     32000            202.76             202.75 		     0.096681
 524288     32000            202.79             202.79 		     0.048349
 1048576    32000            184.29             184.29 		     0.021969
 2097152    32000            170.14             170.14 		     0.010141
 4194304    32000            170.16             170.15 		     0.005071
 8388608    32000            170.15             170.15 		     0.002535
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fa2e0000000
destroying current CUDA Ctx
