initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 62817, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f4a86000000 pointer=0x7f4a86000000
using DMA-BUF for GPU buffer address at 0x7f4a86000000 aligned at 0x7f4a86000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f4a86000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x21f2 PSN 0x220e05 OUT 0x10 RKey 0x182f00 VAddr 0x007f4a8e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21f3 PSN 0x7be00b OUT 0x10 RKey 0x182f00 VAddr 0x007f4a8e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21f4 PSN 0x9dc7f9 OUT 0x10 RKey 0x182f00 VAddr 0x007f4a8f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21f5 PSN 0x8a7a54 OUT 0x10 RKey 0x182f00 VAddr 0x007f4a8f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21f6 PSN 0xbf43d7 OUT 0x10 RKey 0x182f00 VAddr 0x007f4a90000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21f7 PSN 0x2f61ed OUT 0x10 RKey 0x182f00 VAddr 0x007f4a90800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21f8 PSN 0x8d6148 OUT 0x10 RKey 0x182f00 VAddr 0x007f4a91000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21f9 PSN 0xbe57a1 OUT 0x10 RKey 0x182f00 VAddr 0x007f4a91800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21fa PSN 0xcf31 OUT 0x10 RKey 0x182f00 VAddr 0x007f4a92000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21fb PSN 0x70bb5f OUT 0x10 RKey 0x182f00 VAddr 0x007f4a92800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21fc PSN 0xfc5717 OUT 0x10 RKey 0x182f00 VAddr 0x007f4a93000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21fd PSN 0x1e7f5e OUT 0x10 RKey 0x182f00 VAddr 0x007f4a93800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21fe PSN 0x1b9cf2 OUT 0x10 RKey 0x182f00 VAddr 0x007f4a94000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x21ff PSN 0x2728b7 OUT 0x10 RKey 0x182f00 VAddr 0x007f4a94800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2200 PSN 0x7444a9 OUT 0x10 RKey 0x182f00 VAddr 0x007f4a95000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2201 PSN 0x46e1b9 OUT 0x10 RKey 0x182f00 VAddr 0x007f4a95800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x21f2 PSN 0x2e7fea OUT 0x10 RKey 0x183000 VAddr 0x007f10a8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21f3 PSN 0x381c8c OUT 0x10 RKey 0x183000 VAddr 0x007f10a8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21f4 PSN 0xb70e6 OUT 0x10 RKey 0x183000 VAddr 0x007f10a9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21f5 PSN 0x7c553d OUT 0x10 RKey 0x183000 VAddr 0x007f10a9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21f6 PSN 0x32cf0c OUT 0x10 RKey 0x183000 VAddr 0x007f10aa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21f7 PSN 0x4f457e OUT 0x10 RKey 0x183000 VAddr 0x007f10aa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21f8 PSN 0x418c05 OUT 0x10 RKey 0x183000 VAddr 0x007f10ab000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21f9 PSN 0x16581a OUT 0x10 RKey 0x183000 VAddr 0x007f10ab800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21fa PSN 0x71b8b6 OUT 0x10 RKey 0x183000 VAddr 0x007f10ac000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21fb PSN 0xeda700 OUT 0x10 RKey 0x183000 VAddr 0x007f10ac800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21fc PSN 0x4b50a4 OUT 0x10 RKey 0x183000 VAddr 0x007f10ad000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21fd PSN 0xef6e67 OUT 0x10 RKey 0x183000 VAddr 0x007f10ad800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21fe PSN 0x1f79c7 OUT 0x10 RKey 0x183000 VAddr 0x007f10ae000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x21ff PSN 0x8f8d68 OUT 0x10 RKey 0x183000 VAddr 0x007f10ae800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2200 PSN 0x8a2a06 OUT 0x10 RKey 0x183000 VAddr 0x007f10af000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2201 PSN 0x671852 OUT 0x10 RKey 0x183000 VAddr 0x007f10af800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.058158            0.058030            3.626901
 4          16000            0.12               0.12   		     3.657678
 8          16000            0.23               0.23   		     3.643543
 16         16000            0.47               0.47   		     3.656266
 32         16000            0.94               0.94   		     3.654119
 64         16000            1.88               1.87   		     3.656909
 128        16000            3.75               3.73   		     3.646084
 256        16000            7.50               7.47   		     3.647488
 512        16000            15.01              14.94  		     3.648561
 1024       16000            29.92              29.81  		     3.639350
 2048       16000            58.70              58.33  		     3.560342
 4096       16000            68.52              68.46  		     2.089384
 8192       16000            195.82             195.73 		     2.986540
 16384      16000            197.66             197.61 		     1.507650
 32768      16000            198.06             198.01 		     0.755348
 65536      16000            197.79             197.77 		     0.377226
 131072     16000            197.94             197.93 		     0.188760
 262144     16000            192.72             192.72 		     0.091896
 524288     16000            197.94             197.94 		     0.047192
 1048576    16000            197.79             197.79 		     0.023578
 2097152    16000            184.79             184.79 		     0.011014
 4194304    16000            163.68             163.68 		     0.004878
 8388608    16000            163.61             163.61 		     0.002438
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f4a86000000
destroying current CUDA Ctx
