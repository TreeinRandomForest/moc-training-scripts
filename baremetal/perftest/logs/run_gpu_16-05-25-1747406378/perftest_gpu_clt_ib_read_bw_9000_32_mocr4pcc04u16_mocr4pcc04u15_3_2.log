initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 66957, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007feaa0000000 pointer=0x7feaa0000000
using DMA-BUF for GPU buffer address at 0x7feaa0000000 aligned at 0x7feaa0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7feaa0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x24f6 PSN 0x4d71db OUT 0x10 RKey 0x183000 VAddr 0x007feab0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x24f7 PSN 0x661960 OUT 0x10 RKey 0x183000 VAddr 0x007feab0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x24f8 PSN 0xc01bf4 OUT 0x10 RKey 0x183000 VAddr 0x007feab1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x24f9 PSN 0x894afc OUT 0x10 RKey 0x183000 VAddr 0x007feab1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x24fa PSN 0xb7e96 OUT 0x10 RKey 0x183000 VAddr 0x007feab2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x24fb PSN 0x98c0a OUT 0x10 RKey 0x183000 VAddr 0x007feab2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x24fc PSN 0x8cea6b OUT 0x10 RKey 0x183000 VAddr 0x007feab3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x24fd PSN 0x8eba52 OUT 0x10 RKey 0x183000 VAddr 0x007feab3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x24fe PSN 0x1b6758 OUT 0x10 RKey 0x183000 VAddr 0x007feab4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x24ff PSN 0xf41ac3 OUT 0x10 RKey 0x183000 VAddr 0x007feab4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2500 PSN 0x463fe1 OUT 0x10 RKey 0x183000 VAddr 0x007feab5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2501 PSN 0x6a8c97 OUT 0x10 RKey 0x183000 VAddr 0x007feab5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2502 PSN 0x740101 OUT 0x10 RKey 0x183000 VAddr 0x007feab6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2503 PSN 0xcc9e3 OUT 0x10 RKey 0x183000 VAddr 0x007feab6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2504 PSN 0xddf9b OUT 0x10 RKey 0x183000 VAddr 0x007feab7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2505 PSN 0x71b9f9 OUT 0x10 RKey 0x183000 VAddr 0x007feab7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2506 PSN 0xa8d351 OUT 0x10 RKey 0x183000 VAddr 0x007feab8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2507 PSN 0x55e400 OUT 0x10 RKey 0x183000 VAddr 0x007feab8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2508 PSN 0xc3c612 OUT 0x10 RKey 0x183000 VAddr 0x007feab9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2509 PSN 0xb37760 OUT 0x10 RKey 0x183000 VAddr 0x007feab9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x250a PSN 0x6ae077 OUT 0x10 RKey 0x183000 VAddr 0x007feaba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x250b PSN 0x3febb1 OUT 0x10 RKey 0x183000 VAddr 0x007feaba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x250c PSN 0x63648b OUT 0x10 RKey 0x183000 VAddr 0x007feabb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x250d PSN 0x2ff301 OUT 0x10 RKey 0x183000 VAddr 0x007feabb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x250e PSN 0xda1b38 OUT 0x10 RKey 0x183000 VAddr 0x007feabc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x250f PSN 0x3aa76d OUT 0x10 RKey 0x183000 VAddr 0x007feabc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2510 PSN 0xcabc54 OUT 0x10 RKey 0x183000 VAddr 0x007feabd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2511 PSN 0x8d0810 OUT 0x10 RKey 0x183000 VAddr 0x007feabd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2512 PSN 0xffd5b8 OUT 0x10 RKey 0x183000 VAddr 0x007feabe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2513 PSN 0x97c991 OUT 0x10 RKey 0x183000 VAddr 0x007feabe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2514 PSN 0x5b39c OUT 0x10 RKey 0x183000 VAddr 0x007feabf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2515 PSN 0x5d3b92 OUT 0x10 RKey 0x183000 VAddr 0x007feabf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x24f6 PSN 0x5696dc OUT 0x10 RKey 0x183100 VAddr 0x007fb1b0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x24f7 PSN 0x75c0cd OUT 0x10 RKey 0x183100 VAddr 0x007fb1b0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x24f8 PSN 0x52535d OUT 0x10 RKey 0x183100 VAddr 0x007fb1b1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x24f9 PSN 0x5f38b1 OUT 0x10 RKey 0x183100 VAddr 0x007fb1b1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x24fa PSN 0x8e52a7 OUT 0x10 RKey 0x183100 VAddr 0x007fb1b2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x24fb PSN 0xf11d47 OUT 0x10 RKey 0x183100 VAddr 0x007fb1b2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x24fc PSN 0xde8f64 OUT 0x10 RKey 0x183100 VAddr 0x007fb1b3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x24fd PSN 0x15ae57 OUT 0x10 RKey 0x183100 VAddr 0x007fb1b3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x24fe PSN 0x69cb79 OUT 0x10 RKey 0x183100 VAddr 0x007fb1b4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x24ff PSN 0xb662d0 OUT 0x10 RKey 0x183100 VAddr 0x007fb1b4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2500 PSN 0xb69b6a OUT 0x10 RKey 0x183100 VAddr 0x007fb1b5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2501 PSN 0xca9bec OUT 0x10 RKey 0x183100 VAddr 0x007fb1b5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2502 PSN 0x7ce632 OUT 0x10 RKey 0x183100 VAddr 0x007fb1b6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2503 PSN 0xec65c0 OUT 0x10 RKey 0x183100 VAddr 0x007fb1b6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2504 PSN 0x7cab4 OUT 0x10 RKey 0x183100 VAddr 0x007fb1b7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2505 PSN 0x1f499e OUT 0x10 RKey 0x183100 VAddr 0x007fb1b7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2506 PSN 0xb93a92 OUT 0x10 RKey 0x183100 VAddr 0x007fb1b8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2507 PSN 0x240ad OUT 0x10 RKey 0x183100 VAddr 0x007fb1b8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2508 PSN 0xe6a9bb OUT 0x10 RKey 0x183100 VAddr 0x007fb1b9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2509 PSN 0xe43c55 OUT 0x10 RKey 0x183100 VAddr 0x007fb1b9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x250a PSN 0xfedac8 OUT 0x10 RKey 0x183100 VAddr 0x007fb1ba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x250b PSN 0xd2462e OUT 0x10 RKey 0x183100 VAddr 0x007fb1ba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x250c PSN 0x3c39c4 OUT 0x10 RKey 0x183100 VAddr 0x007fb1bb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x250d PSN 0x9ff246 OUT 0x10 RKey 0x183100 VAddr 0x007fb1bb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x250e PSN 0x7dc999 OUT 0x10 RKey 0x183100 VAddr 0x007fb1bc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x250f PSN 0x30cba OUT 0x10 RKey 0x183100 VAddr 0x007fb1bc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2510 PSN 0x1d0c1d OUT 0x10 RKey 0x183100 VAddr 0x007fb1bd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2511 PSN 0x9396a5 OUT 0x10 RKey 0x183100 VAddr 0x007fb1bd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2512 PSN 0x406929 OUT 0x10 RKey 0x183100 VAddr 0x007fb1be000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2513 PSN 0xba16ae OUT 0x10 RKey 0x183100 VAddr 0x007fb1be800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2514 PSN 0xa496f5 OUT 0x10 RKey 0x183100 VAddr 0x007fb1bf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2515 PSN 0x51fe77 OUT 0x10 RKey 0x183100 VAddr 0x007fb1bf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.055470            0.055395            3.462214
 4          32000            0.11               0.11   		     3.516414
 8          32000            0.23               0.23   		     3.521631
 16         32000            0.45               0.45   		     3.505716
 32         32000            0.90               0.90   		     3.516043
 64         32000            1.81               1.79   		     3.502830
 128        32000            3.62               3.61   		     3.523682
 256        32000            7.23               7.21   		     3.521828
 512        32000            14.47              14.43  		     3.524109
 1024       32000            28.94              28.88  		     3.525336
 2048       32000            56.98              56.68  		     3.459325
 4096       32000            115.92             90.88  		     2.773302
 8192       32000            179.17             134.22 		     2.048045
 16384      32000            185.48             161.37 		     1.231188
 32768      32000            187.07             179.86 		     0.686118
 65536      32000            189.62             186.06 		     0.354890
 131072     32000            191.28             191.27 		     0.182412
 262144     32000            194.59             194.59 		     0.092787
 524288     32000            197.29             197.29 		     0.047037
 1048576    32000            178.12             178.12 		     0.021233
 2097152    32000            163.51             163.51 		     0.009746
 4194304    32000            163.38             163.38 		     0.004869
 8388608    32000            163.42             163.42 		     0.002435
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007feaa0000000
destroying current CUDA Ctx
