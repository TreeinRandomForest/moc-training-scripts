initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 51648, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f5f56000000 pointer=0x7f5f56000000
using DMA-BUF for GPU buffer address at 0x7f5f56000000 aligned at 0x7f5f56000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f5f56000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x1a90 PSN 0xd3b1ce OUT 0x10 RKey 0x183000 VAddr 0x007f5f5e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a91 PSN 0x9132a0 OUT 0x10 RKey 0x183000 VAddr 0x007f5f5e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a92 PSN 0x3fcf6a OUT 0x10 RKey 0x183000 VAddr 0x007f5f5f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a93 PSN 0x632b71 OUT 0x10 RKey 0x183000 VAddr 0x007f5f5f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a94 PSN 0xdebb30 OUT 0x10 RKey 0x183000 VAddr 0x007f5f60000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a95 PSN 0xdb28d2 OUT 0x10 RKey 0x183000 VAddr 0x007f5f60800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a96 PSN 0x7ecec9 OUT 0x10 RKey 0x183000 VAddr 0x007f5f61000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a97 PSN 0xd7dd8e OUT 0x10 RKey 0x183000 VAddr 0x007f5f61800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a98 PSN 0xadc31a OUT 0x10 RKey 0x183000 VAddr 0x007f5f62000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a99 PSN 0x3eb94 OUT 0x10 RKey 0x183000 VAddr 0x007f5f62800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a9a PSN 0xd37ba8 OUT 0x10 RKey 0x183000 VAddr 0x007f5f63000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a9b PSN 0x3f571b OUT 0x10 RKey 0x183000 VAddr 0x007f5f63800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a9c PSN 0x27466b OUT 0x10 RKey 0x183000 VAddr 0x007f5f64000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a9d PSN 0xed073c OUT 0x10 RKey 0x183000 VAddr 0x007f5f64800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a9e PSN 0x3b814a OUT 0x10 RKey 0x183000 VAddr 0x007f5f65000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x1a9f PSN 0x5846 OUT 0x10 RKey 0x183000 VAddr 0x007f5f65800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x1a90 PSN 0xc9ce35 OUT 0x10 RKey 0x182f00 VAddr 0x007f89e4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a91 PSN 0x4a47b2 OUT 0x10 RKey 0x182f00 VAddr 0x007f89e4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a92 PSN 0x1d80de OUT 0x10 RKey 0x182f00 VAddr 0x007f89e5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a93 PSN 0xaf7e9e OUT 0x10 RKey 0x182f00 VAddr 0x007f89e5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a94 PSN 0xb0690 OUT 0x10 RKey 0x182f00 VAddr 0x007f89e6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a95 PSN 0x790d7c OUT 0x10 RKey 0x182f00 VAddr 0x007f89e6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a96 PSN 0x6b73f5 OUT 0x10 RKey 0x182f00 VAddr 0x007f89e7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a97 PSN 0x194614 OUT 0x10 RKey 0x182f00 VAddr 0x007f89e7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a98 PSN 0x8134f2 OUT 0x10 RKey 0x182f00 VAddr 0x007f89e8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a99 PSN 0xfd0155 OUT 0x10 RKey 0x182f00 VAddr 0x007f89e8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a9a PSN 0xcf980b OUT 0x10 RKey 0x182f00 VAddr 0x007f89e9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a9b PSN 0xd2d279 OUT 0x10 RKey 0x182f00 VAddr 0x007f89e9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a9c PSN 0xface3b OUT 0x10 RKey 0x182f00 VAddr 0x007f89ea000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a9d PSN 0x4c4795 OUT 0x10 RKey 0x182f00 VAddr 0x007f89ea800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a9e PSN 0x1c5065 OUT 0x10 RKey 0x182f00 VAddr 0x007f89eb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x1a9f PSN 0x253bfb OUT 0x10 RKey 0x182f00 VAddr 0x007f89eb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.059504            0.059295            3.705908
 4          16000            0.12               0.12   		     3.803493
 8          16000            0.24               0.24   		     3.811121
 16         16000            0.49               0.49   		     3.797075
 32         16000            0.97               0.97   		     3.800809
 64         16000            1.96               1.94   		     3.791883
 128        16000            3.87               3.87   		     3.779173
 256        16000            7.78               7.75   		     3.785925
 512        16000            15.75              15.68  		     3.827101
 1024       16000            31.62              31.55  		     3.851839
 2048       16000            64.22              64.00  		     3.906206
 4096       16000            134.30             133.70 		     4.080196
 8192       16000            196.09             195.74 		     2.986735
 16384      16000            197.66             197.54 		     1.507089
 32768      16000            197.99             197.93 		     0.755060
 65536      16000            198.13             198.09 		     0.377835
 131072     16000            198.16             198.14 		     0.188965
 262144     16000            198.21             198.21 		     0.094513
 524288     16000            198.21             198.21 		     0.047256
 1048576    16000            198.24             198.24 		     0.023632
 2097152    16000            184.56             184.56 		     0.011000
 4194304    16000            163.78             163.78 		     0.004881
 8388608    16000            163.73             163.73 		     0.002440
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f5f56000000
destroying current CUDA Ctx
