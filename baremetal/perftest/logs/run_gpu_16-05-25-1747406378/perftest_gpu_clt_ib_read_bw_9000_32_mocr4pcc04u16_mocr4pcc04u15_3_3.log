initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 67632, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007feb60000000 pointer=0x7feb60000000
using DMA-BUF for GPU buffer address at 0x7feb60000000 aligned at 0x7feb60000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7feb60000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x2574 PSN 0xd2dfc6 OUT 0x10 RKey 0x183000 VAddr 0x007feb70000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2575 PSN 0x249538 OUT 0x10 RKey 0x183000 VAddr 0x007feb70800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2576 PSN 0xb55a22 OUT 0x10 RKey 0x183000 VAddr 0x007feb71000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2577 PSN 0xb08bc9 OUT 0x10 RKey 0x183000 VAddr 0x007feb71800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2578 PSN 0x7fd0a8 OUT 0x10 RKey 0x183000 VAddr 0x007feb72000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2579 PSN 0x5b1cea OUT 0x10 RKey 0x183000 VAddr 0x007feb72800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x257a PSN 0x674d01 OUT 0x10 RKey 0x183000 VAddr 0x007feb73000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x257b PSN 0xdbeb66 OUT 0x10 RKey 0x183000 VAddr 0x007feb73800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x257c PSN 0xf7b812 OUT 0x10 RKey 0x183000 VAddr 0x007feb74000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x257d PSN 0x38092c OUT 0x10 RKey 0x183000 VAddr 0x007feb74800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x257e PSN 0xbaa560 OUT 0x10 RKey 0x183000 VAddr 0x007feb75000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x257f PSN 0xc76a73 OUT 0x10 RKey 0x183000 VAddr 0x007feb75800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2580 PSN 0x9892e3 OUT 0x10 RKey 0x183000 VAddr 0x007feb76000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2581 PSN 0x7e6654 OUT 0x10 RKey 0x183000 VAddr 0x007feb76800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2582 PSN 0xb08e82 OUT 0x10 RKey 0x183000 VAddr 0x007feb77000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2583 PSN 0x57491e OUT 0x10 RKey 0x183000 VAddr 0x007feb77800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2584 PSN 0xa790db OUT 0x10 RKey 0x183000 VAddr 0x007feb78000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2585 PSN 0xc506f9 OUT 0x10 RKey 0x183000 VAddr 0x007feb78800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2586 PSN 0x96ece0 OUT 0x10 RKey 0x183000 VAddr 0x007feb79000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2587 PSN 0xd6844d OUT 0x10 RKey 0x183000 VAddr 0x007feb79800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2588 PSN 0xf9dc2a OUT 0x10 RKey 0x183000 VAddr 0x007feb7a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2589 PSN 0xd175b1 OUT 0x10 RKey 0x183000 VAddr 0x007feb7a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x258a PSN 0xcd99c1 OUT 0x10 RKey 0x183000 VAddr 0x007feb7b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x258b PSN 0x759235 OUT 0x10 RKey 0x183000 VAddr 0x007feb7b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x258c PSN 0xee0f92 OUT 0x10 RKey 0x183000 VAddr 0x007feb7c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x258d PSN 0xb100f5 OUT 0x10 RKey 0x183000 VAddr 0x007feb7c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x258e PSN 0x757e72 OUT 0x10 RKey 0x183000 VAddr 0x007feb7d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x258f PSN 0xc7160c OUT 0x10 RKey 0x183000 VAddr 0x007feb7d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2590 PSN 0xea53b OUT 0x10 RKey 0x183000 VAddr 0x007feb7e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2591 PSN 0xa36321 OUT 0x10 RKey 0x183000 VAddr 0x007feb7e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2592 PSN 0x23e923 OUT 0x10 RKey 0x183000 VAddr 0x007feb7f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x2593 PSN 0x4edcd6 OUT 0x10 RKey 0x183000 VAddr 0x007feb7f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x2574 PSN 0x785643 OUT 0x10 RKey 0x183100 VAddr 0x007f71f0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2575 PSN 0x485671 OUT 0x10 RKey 0x183100 VAddr 0x007f71f0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2576 PSN 0x13d567 OUT 0x10 RKey 0x183100 VAddr 0x007f71f1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2577 PSN 0x47062a OUT 0x10 RKey 0x183100 VAddr 0x007f71f1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2578 PSN 0xf111f5 OUT 0x10 RKey 0x183100 VAddr 0x007f71f2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2579 PSN 0x3b18b3 OUT 0x10 RKey 0x183100 VAddr 0x007f71f2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x257a PSN 0x481796 OUT 0x10 RKey 0x183100 VAddr 0x007f71f3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x257b PSN 0xf00ad7 OUT 0x10 RKey 0x183100 VAddr 0x007f71f3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x257c PSN 0xf4a12f OUT 0x10 RKey 0x183100 VAddr 0x007f71f4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x257d PSN 0x135885 OUT 0x10 RKey 0x183100 VAddr 0x007f71f4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x257e PSN 0x716445 OUT 0x10 RKey 0x183100 VAddr 0x007f71f5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x257f PSN 0x346ff4 OUT 0x10 RKey 0x183100 VAddr 0x007f71f5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2580 PSN 0xe1d0d0 OUT 0x10 RKey 0x183100 VAddr 0x007f71f6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2581 PSN 0xccb23d OUT 0x10 RKey 0x183100 VAddr 0x007f71f6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2582 PSN 0x636b7 OUT 0x10 RKey 0x183100 VAddr 0x007f71f7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2583 PSN 0xcb85af OUT 0x10 RKey 0x183100 VAddr 0x007f71f7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2584 PSN 0x3ba098 OUT 0x10 RKey 0x183100 VAddr 0x007f71f8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2585 PSN 0x2f8872 OUT 0x10 RKey 0x183100 VAddr 0x007f71f8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2586 PSN 0xcec365 OUT 0x10 RKey 0x183100 VAddr 0x007f71f9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2587 PSN 0xf458ee OUT 0x10 RKey 0x183100 VAddr 0x007f71f9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2588 PSN 0x220ab7 OUT 0x10 RKey 0x183100 VAddr 0x007f71fa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2589 PSN 0xbbf5ba OUT 0x10 RKey 0x183100 VAddr 0x007f71fa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x258a PSN 0xfa3396 OUT 0x10 RKey 0x183100 VAddr 0x007f71fb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x258b PSN 0x46fe6 OUT 0x10 RKey 0x183100 VAddr 0x007f71fb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x258c PSN 0x1b79ef OUT 0x10 RKey 0x183100 VAddr 0x007f71fc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x258d PSN 0x52d88e OUT 0x10 RKey 0x183100 VAddr 0x007f71fc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x258e PSN 0x1dc097 OUT 0x10 RKey 0x183100 VAddr 0x007f71fd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x258f PSN 0xf47dcd OUT 0x10 RKey 0x183100 VAddr 0x007f71fd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2590 PSN 0x873868 OUT 0x10 RKey 0x183100 VAddr 0x007f71fe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2591 PSN 0xb07b4a OUT 0x10 RKey 0x183100 VAddr 0x007f71fe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2592 PSN 0x380898 OUT 0x10 RKey 0x183100 VAddr 0x007f71ff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x2593 PSN 0xff5fa7 OUT 0x10 RKey 0x183100 VAddr 0x007f71ff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.056250            0.056157            3.509800
 4          32000            0.11               0.11   		     3.559099
 8          32000            0.23               0.23   		     3.556310
 16         32000            0.46               0.46   		     3.555299
 32         32000            0.91               0.91   		     3.559570
 64         32000            1.82               1.82   		     3.553826
 128        32000            3.65               3.64   		     3.550853
 256        32000            7.30               7.27   		     3.551661
 512        32000            14.58              14.55  		     3.551286
 1024       32000            29.12              29.06  		     3.547188
 2048       32000            57.42              57.12  		     3.486484
 4096       32000            116.47             91.14  		     2.781380
 8192       32000            180.04             135.28 		     2.064158
 16384      32000            183.97             164.35 		     1.253929
 32768      32000            197.33             197.31 		     0.752679
 65536      32000            197.27             197.25 		     0.376218
 131072     32000            197.02             197.00 		     0.187877
 262144     32000            194.93             194.93 		     0.092949
 524288     32000            195.99             195.99 		     0.046727
 1048576    32000            177.73             177.73 		     0.021187
 2097152    32000            163.45             163.45 		     0.009743
 4194304    32000            163.34             163.34 		     0.004868
 8388608    32000            163.38             163.38 		     0.002435
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007feb60000000
destroying current CUDA Ctx
