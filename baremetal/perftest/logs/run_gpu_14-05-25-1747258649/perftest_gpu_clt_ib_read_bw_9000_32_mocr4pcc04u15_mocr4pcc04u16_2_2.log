initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 17091, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f76c0000000 pointer=0x7f76c0000000
using DMA-BUF for GPU buffer address at 0x7f76c0000000 aligned at 0x7f76c0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f76c0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x076e PSN 0xa1f418 OUT 0x10 RKey 0x183100 VAddr 0x007f76d0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x076f PSN 0x29e822 OUT 0x10 RKey 0x183100 VAddr 0x007f76d0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0770 PSN 0x2fe3c4 OUT 0x10 RKey 0x183100 VAddr 0x007f76d1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0771 PSN 0xdcb1c3 OUT 0x10 RKey 0x183100 VAddr 0x007f76d1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0772 PSN 0xe2981a OUT 0x10 RKey 0x183100 VAddr 0x007f76d2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0773 PSN 0xb27474 OUT 0x10 RKey 0x183100 VAddr 0x007f76d2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0774 PSN 0x758ec3 OUT 0x10 RKey 0x183100 VAddr 0x007f76d3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0775 PSN 0xda3700 OUT 0x10 RKey 0x183100 VAddr 0x007f76d3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0776 PSN 0x2244a4 OUT 0x10 RKey 0x183100 VAddr 0x007f76d4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0777 PSN 0x390f56 OUT 0x10 RKey 0x183100 VAddr 0x007f76d4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0778 PSN 0x6c0142 OUT 0x10 RKey 0x183100 VAddr 0x007f76d5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0779 PSN 0x3095ad OUT 0x10 RKey 0x183100 VAddr 0x007f76d5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x077a PSN 0xae1695 OUT 0x10 RKey 0x183100 VAddr 0x007f76d6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x077b PSN 0x11651e OUT 0x10 RKey 0x183100 VAddr 0x007f76d6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x077c PSN 0x688684 OUT 0x10 RKey 0x183100 VAddr 0x007f76d7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x077d PSN 0x55adf8 OUT 0x10 RKey 0x183100 VAddr 0x007f76d7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x077e PSN 0x8c5dad OUT 0x10 RKey 0x183100 VAddr 0x007f76d8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x077f PSN 0xcce863 OUT 0x10 RKey 0x183100 VAddr 0x007f76d8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0780 PSN 0x2f2302 OUT 0x10 RKey 0x183100 VAddr 0x007f76d9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0781 PSN 0xa01cc7 OUT 0x10 RKey 0x183100 VAddr 0x007f76d9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0782 PSN 0x45641c OUT 0x10 RKey 0x183100 VAddr 0x007f76da000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0783 PSN 0x35c3bb OUT 0x10 RKey 0x183100 VAddr 0x007f76da800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0784 PSN 0xd7d003 OUT 0x10 RKey 0x183100 VAddr 0x007f76db000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0785 PSN 0x65f84f OUT 0x10 RKey 0x183100 VAddr 0x007f76db800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0786 PSN 0xfce4a4 OUT 0x10 RKey 0x183100 VAddr 0x007f76dc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0787 PSN 0x7e59f OUT 0x10 RKey 0x183100 VAddr 0x007f76dc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0788 PSN 0x9d96d4 OUT 0x10 RKey 0x183100 VAddr 0x007f76dd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0789 PSN 0x1983c6 OUT 0x10 RKey 0x183100 VAddr 0x007f76dd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x078a PSN 0x34796d OUT 0x10 RKey 0x183100 VAddr 0x007f76de000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x078b PSN 0x7ba86b OUT 0x10 RKey 0x183100 VAddr 0x007f76de800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x078c PSN 0xb1e5a5 OUT 0x10 RKey 0x183100 VAddr 0x007f76df000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x078d PSN 0x782c30 OUT 0x10 RKey 0x183100 VAddr 0x007f76df800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x076e PSN 0xd0da0c OUT 0x10 RKey 0x183000 VAddr 0x007f02f0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x076f PSN 0xab0906 OUT 0x10 RKey 0x183000 VAddr 0x007f02f0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0770 PSN 0xe7bcd8 OUT 0x10 RKey 0x183000 VAddr 0x007f02f1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0771 PSN 0x9c1747 OUT 0x10 RKey 0x183000 VAddr 0x007f02f1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0772 PSN 0x45694e OUT 0x10 RKey 0x183000 VAddr 0x007f02f2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0773 PSN 0xaa3f98 OUT 0x10 RKey 0x183000 VAddr 0x007f02f2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0774 PSN 0xa96517 OUT 0x10 RKey 0x183000 VAddr 0x007f02f3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0775 PSN 0xebf0c4 OUT 0x10 RKey 0x183000 VAddr 0x007f02f3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0776 PSN 0x447518 OUT 0x10 RKey 0x183000 VAddr 0x007f02f4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0777 PSN 0x3fe8ba OUT 0x10 RKey 0x183000 VAddr 0x007f02f4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0778 PSN 0xd668d6 OUT 0x10 RKey 0x183000 VAddr 0x007f02f5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0779 PSN 0xfda7b1 OUT 0x10 RKey 0x183000 VAddr 0x007f02f5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x077a PSN 0xde5a49 OUT 0x10 RKey 0x183000 VAddr 0x007f02f6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x077b PSN 0x61f0c2 OUT 0x10 RKey 0x183000 VAddr 0x007f02f6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x077c PSN 0x595358 OUT 0x10 RKey 0x183000 VAddr 0x007f02f7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x077d PSN 0x535c3c OUT 0x10 RKey 0x183000 VAddr 0x007f02f7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x077e PSN 0xd0a8a1 OUT 0x10 RKey 0x183000 VAddr 0x007f02f8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x077f PSN 0x280a47 OUT 0x10 RKey 0x183000 VAddr 0x007f02f8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0780 PSN 0x9f6916 OUT 0x10 RKey 0x183000 VAddr 0x007f02f9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0781 PSN 0xd3eb4b OUT 0x10 RKey 0x183000 VAddr 0x007f02f9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0782 PSN 0x8eea50 OUT 0x10 RKey 0x183000 VAddr 0x007f02fa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0783 PSN 0x69fdf OUT 0x10 RKey 0x183000 VAddr 0x007f02fa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0784 PSN 0xbde357 OUT 0x10 RKey 0x183000 VAddr 0x007f02fb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0785 PSN 0x29ab13 OUT 0x10 RKey 0x183000 VAddr 0x007f02fb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0786 PSN 0x9c1a18 OUT 0x10 RKey 0x183000 VAddr 0x007f02fc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0787 PSN 0xc7e003 OUT 0x10 RKey 0x183000 VAddr 0x007f02fc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0788 PSN 0x810b68 OUT 0x10 RKey 0x183000 VAddr 0x007f02fd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0789 PSN 0x1f1eca OUT 0x10 RKey 0x183000 VAddr 0x007f02fd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x078a PSN 0x8d1221 OUT 0x10 RKey 0x183000 VAddr 0x007f02fe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x078b PSN 0x56650f OUT 0x10 RKey 0x183000 VAddr 0x007f02fe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x078c PSN 0x7f8f79 OUT 0x10 RKey 0x183000 VAddr 0x007f02ff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x078d PSN 0xdf374 OUT 0x10 RKey 0x183000 VAddr 0x007f02ff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.078603            0.077951            4.871959
 4          32000            0.16               0.16   		     5.006023
 8          32000            0.32               0.32   		     5.011267
 16         32000            0.64               0.64   		     5.020269
 32         32000            1.29               1.29   		     5.036990
 64         32000            2.59               2.58   		     5.039180
 128        32000            5.15               5.13   		     5.012092
 256        32000            10.29              10.26  		     5.011558
 512        32000            20.62              20.58  		     5.023540
 1024       32000            41.23              41.15  		     5.023209
 2048       32000            80.84              80.30  		     4.901375
 4096       32000            164.94             164.57 		     5.022184
 8192       32000            197.40             197.33 		     3.011011
 16384      32000            197.79             197.79 		     1.509011
 32768      32000            198.13             198.06 		     0.755552
 65536      32000            197.93             197.91 		     0.377478
 131072     32000            197.99             197.99 		     0.188816
 262144     32000            198.04             198.04 		     0.094431
 524288     32000            198.01             198.01 		     0.047210
 1048576    32000            178.72             178.72 		     0.021306
 2097152    32000            164.05             164.05 		     0.009778
 4194304    32000            164.02             164.02 		     0.004888
 8388608    32000            164.01             164.01 		     0.002444
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f76c0000000
destroying current CUDA Ctx
