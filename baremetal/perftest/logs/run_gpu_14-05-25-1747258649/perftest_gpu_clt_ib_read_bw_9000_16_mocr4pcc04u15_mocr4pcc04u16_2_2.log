initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 17036, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f8306000000 pointer=0x7f8306000000
using DMA-BUF for GPU buffer address at 0x7f8306000000 aligned at 0x7f8306000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f8306000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x075e PSN 0xc2fa24 OUT 0x10 RKey 0x183000 VAddr 0x007f830e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x075f PSN 0xb8433e OUT 0x10 RKey 0x183000 VAddr 0x007f830e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0760 PSN 0x77d6b0 OUT 0x10 RKey 0x183000 VAddr 0x007f830f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0761 PSN 0x4f283f OUT 0x10 RKey 0x183000 VAddr 0x007f830f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0762 PSN 0x6272e6 OUT 0x10 RKey 0x183000 VAddr 0x007f8310000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0763 PSN 0xc5e550 OUT 0x10 RKey 0x183000 VAddr 0x007f8310800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0764 PSN 0xf2446f OUT 0x10 RKey 0x183000 VAddr 0x007f8311000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0765 PSN 0xbc193c OUT 0x10 RKey 0x183000 VAddr 0x007f8311800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0766 PSN 0xe18030 OUT 0x10 RKey 0x183000 VAddr 0x007f8312000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0767 PSN 0x3531f2 OUT 0x10 RKey 0x183000 VAddr 0x007f8312800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0768 PSN 0xaee5ae OUT 0x10 RKey 0x183000 VAddr 0x007f8313000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0769 PSN 0x74dfa9 OUT 0x10 RKey 0x183000 VAddr 0x007f8313800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x076a PSN 0x89fee1 OUT 0x10 RKey 0x183000 VAddr 0x007f8314000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x076b PSN 0x77957a OUT 0x10 RKey 0x183000 VAddr 0x007f8314800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x076c PSN 0x2dc5b0 OUT 0x10 RKey 0x183000 VAddr 0x007f8315000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x076d PSN 0xa31bb4 OUT 0x10 RKey 0x183000 VAddr 0x007f8315800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x075e PSN 0xb630e OUT 0x10 RKey 0x182f00 VAddr 0x007f088c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x075f PSN 0x872ae0 OUT 0x10 RKey 0x182f00 VAddr 0x007f088c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0760 PSN 0x402aa OUT 0x10 RKey 0x182f00 VAddr 0x007f088d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0761 PSN 0xf87db1 OUT 0x10 RKey 0x182f00 VAddr 0x007f088d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0762 PSN 0x584070 OUT 0x10 RKey 0x182f00 VAddr 0x007f088e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0763 PSN 0x506512 OUT 0x10 RKey 0x182f00 VAddr 0x007f088e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0764 PSN 0x8af609 OUT 0x10 RKey 0x182f00 VAddr 0x007f088f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0765 PSN 0x4813ce OUT 0x10 RKey 0x182f00 VAddr 0x007f088f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0766 PSN 0x325c5a OUT 0x10 RKey 0x182f00 VAddr 0x007f0890000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0767 PSN 0x28abd4 OUT 0x10 RKey 0x182f00 VAddr 0x007f0890800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0768 PSN 0x32d6e8 OUT 0x10 RKey 0x182f00 VAddr 0x007f0891000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0769 PSN 0xd4b15b OUT 0x10 RKey 0x182f00 VAddr 0x007f0891800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x076a PSN 0xd433ab OUT 0x10 RKey 0x182f00 VAddr 0x007f0892000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x076b PSN 0xb58b7c OUT 0x10 RKey 0x182f00 VAddr 0x007f0892800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x076c PSN 0x6d508a OUT 0x10 RKey 0x182f00 VAddr 0x007f0893000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x076d PSN 0x691686 OUT 0x10 RKey 0x182f00 VAddr 0x007f0893800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.081256            0.080853            5.053304
 4          16000            0.17               0.16   		     5.132943
 8          16000            0.33               0.33   		     5.154540
 16         16000            0.66               0.66   		     5.149149
 32         16000            1.32               1.32   		     5.162873
 64         16000            2.65               2.65   		     5.174226
 128        16000            5.31               5.28   		     5.159910
 256        16000            10.62              10.57  		     5.160658
 512        16000            21.19              21.12  		     5.155552
 1024       16000            42.37              42.16  		     5.146581
 2048       16000            84.16              83.74  		     5.110956
 4096       16000            165.31             163.88 		     5.001125
 8192       16000            196.87             196.81 		     3.003082
 16384      16000            197.79             197.69 		     1.508256
 32768      16000            198.05             198.03 		     0.755437
 65536      16000            198.03             198.01 		     0.377670
 131072     16000            198.16             198.15 		     0.188972
 262144     16000            198.19             198.19 		     0.094505
 524288     16000            198.23             198.23 		     0.047262
 1048576    16000            198.20             198.20 		     0.023628
 2097152    16000            184.48             184.48 		     0.010996
 4194304    16000            163.68             163.68 		     0.004878
 8388608    16000            163.71             163.71 		     0.002440
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f8306000000
destroying current CUDA Ctx
