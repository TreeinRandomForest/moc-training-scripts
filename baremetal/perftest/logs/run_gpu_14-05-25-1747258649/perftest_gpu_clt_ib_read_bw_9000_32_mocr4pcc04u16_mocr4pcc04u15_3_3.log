initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 31551, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f2100000000 pointer=0x7f2100000000
using DMA-BUF for GPU buffer address at 0x7f2100000000 aligned at 0x7f2100000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f2100000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x14b8 PSN 0x2abf09 OUT 0x10 RKey 0x183000 VAddr 0x007f2110000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14b9 PSN 0xe8d6bf OUT 0x10 RKey 0x183000 VAddr 0x007f2110800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14ba PSN 0x988a9d OUT 0x10 RKey 0x183000 VAddr 0x007f2111000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14bb PSN 0x5eb228 OUT 0x10 RKey 0x183000 VAddr 0x007f2111800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14bc PSN 0xb3811b OUT 0x10 RKey 0x183000 VAddr 0x007f2112000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14bd PSN 0xe88fe1 OUT 0x10 RKey 0x183000 VAddr 0x007f2112800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14be PSN 0x9f2a2c OUT 0x10 RKey 0x183000 VAddr 0x007f2113000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14bf PSN 0xfdb8b5 OUT 0x10 RKey 0x183000 VAddr 0x007f2113800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14c0 PSN 0xa51cb5 OUT 0x10 RKey 0x183000 VAddr 0x007f2114000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14c1 PSN 0xba5493 OUT 0x10 RKey 0x183000 VAddr 0x007f2114800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14c2 PSN 0xe74a3b OUT 0x10 RKey 0x183000 VAddr 0x007f2115000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14c3 PSN 0xca5db2 OUT 0x10 RKey 0x183000 VAddr 0x007f2115800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14c4 PSN 0x78beb6 OUT 0x10 RKey 0x183000 VAddr 0x007f2116000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14c5 PSN 0xd4a12b OUT 0x10 RKey 0x183000 VAddr 0x007f2116800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14c6 PSN 0x78c60d OUT 0x10 RKey 0x183000 VAddr 0x007f2117000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14c7 PSN 0xa1d14d OUT 0x10 RKey 0x183000 VAddr 0x007f2117800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14c8 PSN 0x11c6de OUT 0x10 RKey 0x183000 VAddr 0x007f2118000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14c9 PSN 0x48b840 OUT 0x10 RKey 0x183000 VAddr 0x007f2118800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14ca PSN 0x63321b OUT 0x10 RKey 0x183000 VAddr 0x007f2119000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14cb PSN 0x67006c OUT 0x10 RKey 0x183000 VAddr 0x007f2119800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14cc PSN 0x968f5d OUT 0x10 RKey 0x183000 VAddr 0x007f211a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14cd PSN 0x8d9468 OUT 0x10 RKey 0x183000 VAddr 0x007f211a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14ce PSN 0x3317ac OUT 0x10 RKey 0x183000 VAddr 0x007f211b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14cf PSN 0x715144 OUT 0x10 RKey 0x183000 VAddr 0x007f211b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14d0 PSN 0x99e2f5 OUT 0x10 RKey 0x183000 VAddr 0x007f211c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14d1 PSN 0x8f41c OUT 0x10 RKey 0x183000 VAddr 0x007f211c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14d2 PSN 0x51100d OUT 0x10 RKey 0x183000 VAddr 0x007f211d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14d3 PSN 0xf9570b OUT 0x10 RKey 0x183000 VAddr 0x007f211d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14d4 PSN 0xed6bce OUT 0x10 RKey 0x183000 VAddr 0x007f211e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14d5 PSN 0x6a01b8 OUT 0x10 RKey 0x183000 VAddr 0x007f211e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14d6 PSN 0x65196e OUT 0x10 RKey 0x183000 VAddr 0x007f211f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x14d7 PSN 0x97cec5 OUT 0x10 RKey 0x183000 VAddr 0x007f211f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x14b8 PSN 0xe699cd OUT 0x10 RKey 0x183100 VAddr 0x007fe3b0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14b9 PSN 0x211433 OUT 0x10 RKey 0x183100 VAddr 0x007fe3b0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14ba PSN 0xb0ed01 OUT 0x10 RKey 0x183100 VAddr 0x007fe3b1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14bb PSN 0x566ebc OUT 0x10 RKey 0x183100 VAddr 0x007fe3b1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14bc PSN 0xbc41f OUT 0x10 RKey 0x183100 VAddr 0x007fe3b2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14bd PSN 0x62b095 OUT 0x10 RKey 0x183100 VAddr 0x007fe3b2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14be PSN 0xf0ced0 OUT 0x10 RKey 0x183100 VAddr 0x007fe3b3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14bf PSN 0xdc2a89 OUT 0x10 RKey 0x183100 VAddr 0x007fe3b3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14c0 PSN 0x100bf9 OUT 0x10 RKey 0x183100 VAddr 0x007fe3b4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14c1 PSN 0xe94c87 OUT 0x10 RKey 0x183100 VAddr 0x007fe3b4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14c2 PSN 0x9c151f OUT 0x10 RKey 0x183100 VAddr 0x007fe3b5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14c3 PSN 0x3d98c6 OUT 0x10 RKey 0x183100 VAddr 0x007fe3b5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14c4 PSN 0xcde3a OUT 0x10 RKey 0x183100 VAddr 0x007fe3b6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14c5 PSN 0xe6a45f OUT 0x10 RKey 0x183100 VAddr 0x007fe3b6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14c6 PSN 0xf4db31 OUT 0x10 RKey 0x183100 VAddr 0x007fe3b7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14c7 PSN 0xa529a1 OUT 0x10 RKey 0x183100 VAddr 0x007fe3b7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14c8 PSN 0x49daa2 OUT 0x10 RKey 0x183100 VAddr 0x007fe3b8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14c9 PSN 0x9b3ab4 OUT 0x10 RKey 0x183100 VAddr 0x007fe3b8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14ca PSN 0xa8f57f OUT 0x10 RKey 0x183100 VAddr 0x007fe3b9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14cb PSN 0xd70a00 OUT 0x10 RKey 0x183100 VAddr 0x007fe3b9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14cc PSN 0x559b61 OUT 0x10 RKey 0x183100 VAddr 0x007fe3ba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14cd PSN 0x614a1c OUT 0x10 RKey 0x183100 VAddr 0x007fe3ba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14ce PSN 0x872d50 OUT 0x10 RKey 0x183100 VAddr 0x007fe3bb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14cf PSN 0xdfe018 OUT 0x10 RKey 0x183100 VAddr 0x007fe3bb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14d0 PSN 0x6f2b39 OUT 0x10 RKey 0x183100 VAddr 0x007fe3bc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14d1 PSN 0x75d110 OUT 0x10 RKey 0x183100 VAddr 0x007fe3bc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14d2 PSN 0x1e5bf1 OUT 0x10 RKey 0x183100 VAddr 0x007fe3bd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14d3 PSN 0xc17f1f OUT 0x10 RKey 0x183100 VAddr 0x007fe3bd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14d4 PSN 0x987452 OUT 0x10 RKey 0x183100 VAddr 0x007fe3be000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14d5 PSN 0x9339ec OUT 0x10 RKey 0x183100 VAddr 0x007fe3be800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14d6 PSN 0x60bf92 OUT 0x10 RKey 0x183100 VAddr 0x007fe3bf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x14d7 PSN 0x31e419 OUT 0x10 RKey 0x183100 VAddr 0x007fe3bf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.076759            0.076204            4.762720
 4          32000            0.16               0.16   		     4.894935
 8          32000            0.32               0.31   		     4.908563
 16         32000            0.63               0.63   		     4.904853
 32         32000            1.25               1.20   		     4.706464
 64         32000            2.52               2.51   		     4.908194
 128        32000            5.04               5.02   		     4.903831
 256        32000            10.04              10.02  		     4.893512
 512        32000            20.08              20.01  		     4.884900
 1024       32000            40.33              40.10  		     4.894463
 2048       32000            78.94              78.31  		     4.779750
 4096       32000            161.33             160.68 		     4.903681
 8192       32000            183.18             133.80 		     2.041596
 16384      32000            186.18             175.44 		     1.338497
 32768      32000            190.51             177.25 		     0.676169
 65536      32000            190.73             186.53 		     0.355783
 131072     32000            192.11             192.10 		     0.183198
 262144     32000            194.36             194.36 		     0.092677
 524288     32000            195.90             195.90 		     0.046706
 1048576    32000            178.15             178.15 		     0.021237
 2097152    32000            163.27             163.27 		     0.009732
 4194304    32000            163.38             163.38 		     0.004869
 8388608    32000            163.47             163.47 		     0.002436
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f2100000000
destroying current CUDA Ctx
