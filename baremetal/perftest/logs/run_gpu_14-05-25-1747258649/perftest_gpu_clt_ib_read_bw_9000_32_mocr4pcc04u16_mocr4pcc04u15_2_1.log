initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 27494, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fc640000000 pointer=0x7fc640000000
using DMA-BUF for GPU buffer address at 0x7fc640000000 aligned at 0x7fc640000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fc640000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0ed0 PSN 0x11683e OUT 0x10 RKey 0x183000 VAddr 0x007fc650000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ed1 PSN 0x8050 OUT 0x10 RKey 0x183000 VAddr 0x007fc650800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ed2 PSN 0xb0035a OUT 0x10 RKey 0x183000 VAddr 0x007fc651000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ed3 PSN 0x12e8a1 OUT 0x10 RKey 0x183000 VAddr 0x007fc651800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ed4 PSN 0xeb68a0 OUT 0x10 RKey 0x183000 VAddr 0x007fc652000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ed5 PSN 0x53a182 OUT 0x10 RKey 0x183000 VAddr 0x007fc652800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ed6 PSN 0x7851b9 OUT 0x10 RKey 0x183000 VAddr 0x007fc653000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ed7 PSN 0xf83dbe OUT 0x10 RKey 0x183000 VAddr 0x007fc653800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ed8 PSN 0x21d78a OUT 0x10 RKey 0x183000 VAddr 0x007fc654000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ed9 PSN 0xd3f44 OUT 0x10 RKey 0x183000 VAddr 0x007fc654800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0eda PSN 0x3c3d98 OUT 0x10 RKey 0x183000 VAddr 0x007fc655000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0edb PSN 0x578a4b OUT 0x10 RKey 0x183000 VAddr 0x007fc655800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0edc PSN 0xb231db OUT 0x10 RKey 0x183000 VAddr 0x007fc656000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0edd PSN 0xd9e5ec OUT 0x10 RKey 0x183000 VAddr 0x007fc656800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ede PSN 0x68723a OUT 0x10 RKey 0x183000 VAddr 0x007fc657000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0edf PSN 0xda8e76 OUT 0x10 RKey 0x183000 VAddr 0x007fc657800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ee0 PSN 0xf92753 OUT 0x10 RKey 0x183000 VAddr 0x007fc658000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ee1 PSN 0x51e811 OUT 0x10 RKey 0x183000 VAddr 0x007fc658800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ee2 PSN 0xee5418 OUT 0x10 RKey 0x183000 VAddr 0x007fc659000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ee3 PSN 0x69c725 OUT 0x10 RKey 0x183000 VAddr 0x007fc659800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ee4 PSN 0xdb6222 OUT 0x10 RKey 0x183000 VAddr 0x007fc65a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ee5 PSN 0xd45049 OUT 0x10 RKey 0x183000 VAddr 0x007fc65a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ee6 PSN 0x893c79 OUT 0x10 RKey 0x183000 VAddr 0x007fc65b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ee7 PSN 0x2b2a8d OUT 0x10 RKey 0x183000 VAddr 0x007fc65b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ee8 PSN 0x3efd0a OUT 0x10 RKey 0x183000 VAddr 0x007fc65c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ee9 PSN 0x1fed0d OUT 0x10 RKey 0x183000 VAddr 0x007fc65c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0eea PSN 0xed94aa OUT 0x10 RKey 0x183000 VAddr 0x007fc65d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0eeb PSN 0x7edbe4 OUT 0x10 RKey 0x183000 VAddr 0x007fc65d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0eec PSN 0x2df233 OUT 0x10 RKey 0x183000 VAddr 0x007fc65e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0eed PSN 0xbdf8b9 OUT 0x10 RKey 0x183000 VAddr 0x007fc65e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0eee PSN 0xfc2adb OUT 0x10 RKey 0x183000 VAddr 0x007fc65f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0eef PSN 0xe282e OUT 0x10 RKey 0x183000 VAddr 0x007fc65f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0ed0 PSN 0xfb2b36 OUT 0x10 RKey 0x183100 VAddr 0x007fb930000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ed1 PSN 0x5353e8 OUT 0x10 RKey 0x183100 VAddr 0x007fb930800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ed2 PSN 0x2eab12 OUT 0x10 RKey 0x183100 VAddr 0x007fb931000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ed3 PSN 0x4fa1f9 OUT 0x10 RKey 0x183100 VAddr 0x007fb931800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ed4 PSN 0x6b6318 OUT 0x10 RKey 0x183100 VAddr 0x007fb932000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ed5 PSN 0x79169a OUT 0x10 RKey 0x183100 VAddr 0x007fb932800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ed6 PSN 0xbebcf1 OUT 0x10 RKey 0x183100 VAddr 0x007fb933000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ed7 PSN 0xe83496 OUT 0x10 RKey 0x183100 VAddr 0x007fb933800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ed8 PSN 0x340182 OUT 0x10 RKey 0x183100 VAddr 0x007fb934000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ed9 PSN 0x1deddc OUT 0x10 RKey 0x183100 VAddr 0x007fb934800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0eda PSN 0x532450 OUT 0x10 RKey 0x183100 VAddr 0x007fb935000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0edb PSN 0x116a3 OUT 0x10 RKey 0x183100 VAddr 0x007fb935800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0edc PSN 0x1a0353 OUT 0x10 RKey 0x183100 VAddr 0x007fb936000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0edd PSN 0xdfe604 OUT 0x10 RKey 0x183100 VAddr 0x007fb936800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ede PSN 0x2c0c72 OUT 0x10 RKey 0x183100 VAddr 0x007fb937000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0edf PSN 0x51884e OUT 0x10 RKey 0x183100 VAddr 0x007fb937800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ee0 PSN 0x39984b OUT 0x10 RKey 0x183100 VAddr 0x007fb938000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ee1 PSN 0xe0d1a9 OUT 0x10 RKey 0x183100 VAddr 0x007fb938800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ee2 PSN 0xc659d0 OUT 0x10 RKey 0x183100 VAddr 0x007fb939000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ee3 PSN 0x27867d OUT 0x10 RKey 0x183100 VAddr 0x007fb939800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ee4 PSN 0xaeea9a OUT 0x10 RKey 0x183100 VAddr 0x007fb93a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ee5 PSN 0x213b61 OUT 0x10 RKey 0x183100 VAddr 0x007fb93a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ee6 PSN 0xa0e5b1 OUT 0x10 RKey 0x183100 VAddr 0x007fb93b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ee7 PSN 0xe68765 OUT 0x10 RKey 0x183100 VAddr 0x007fb93b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ee8 PSN 0x8f9502 OUT 0x10 RKey 0x183100 VAddr 0x007fb93c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ee9 PSN 0x9971a5 OUT 0x10 RKey 0x183100 VAddr 0x007fb93c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0eea PSN 0xeb9962 OUT 0x10 RKey 0x183100 VAddr 0x007fb93d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0eeb PSN 0x842e3c OUT 0x10 RKey 0x183100 VAddr 0x007fb93d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0eec PSN 0x8d11ab OUT 0x10 RKey 0x183100 VAddr 0x007fb93e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0eed PSN 0x242ed1 OUT 0x10 RKey 0x183100 VAddr 0x007fb93e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0eee PSN 0x3ac313 OUT 0x10 RKey 0x183100 VAddr 0x007fb93f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0eef PSN 0x174806 OUT 0x10 RKey 0x183100 VAddr 0x007fb93f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.082380            0.081883            5.117707
 4          32000            0.17               0.17   		     5.280162
 8          32000            0.34               0.34   		     5.287782
 16         32000            0.68               0.68   		     5.296847
 32         32000            1.36               1.36   		     5.303800
 64         32000            2.73               2.72   		     5.308164
 128        32000            5.43               5.40   		     5.277176
 256        32000            10.89              10.85  		     5.297478
 512        32000            21.43              21.37  		     5.216322
 1024       32000            44.74              44.55  		     5.438252
 2048       32000            91.02              90.15  		     5.502565
 4096       32000            174.71             103.34 		     3.153651
 8192       32000            179.17             149.33 		     2.278608
 16384      32000            188.32             161.01 		     1.228383
 32768      32000            191.25             177.63 		     0.677596
 65536      32000            196.74             196.71 		     0.375192
 131072     32000            192.45             192.45 		     0.183531
 262144     32000            197.99             197.99 		     0.094410
 524288     32000            197.98             197.98 		     0.047202
 1048576    32000            178.53             178.53 		     0.021282
 2097152    32000            163.66             163.66 		     0.009755
 4194304    32000            163.74             163.74 		     0.004880
 8388608    32000            163.80             163.80 		     0.002441
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fc640000000
destroying current CUDA Ctx
