initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 12903, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f824e000000 pointer=0x7f824e000000
using DMA-BUF for GPU buffer address at 0x7f824e000000 aligned at 0x7f824e000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f824e000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x046a PSN 0xaf472e OUT 0x10 RKey 0x183000 VAddr 0x007f8256000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x046b PSN 0xc40c80 OUT 0x10 RKey 0x183000 VAddr 0x007f8256800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x046c PSN 0x25d3ca OUT 0x10 RKey 0x183000 VAddr 0x007f8257000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x046d PSN 0xc14851 OUT 0x10 RKey 0x183000 VAddr 0x007f8257800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x046e PSN 0x624690 OUT 0x10 RKey 0x183000 VAddr 0x007f8258000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x046f PSN 0x95c0b2 OUT 0x10 RKey 0x183000 VAddr 0x007f8258800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0470 PSN 0xe4b929 OUT 0x10 RKey 0x183000 VAddr 0x007f8259000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0471 PSN 0x4ee86e OUT 0x10 RKey 0x183000 VAddr 0x007f8259800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0472 PSN 0xa2a47a OUT 0x10 RKey 0x183000 VAddr 0x007f825a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0473 PSN 0x442174 OUT 0x10 RKey 0x183000 VAddr 0x007f825a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0474 PSN 0x11ac08 OUT 0x10 RKey 0x183000 VAddr 0x007f825b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0475 PSN 0xb02ffb OUT 0x10 RKey 0x183000 VAddr 0x007f825b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0476 PSN 0x8cddcb OUT 0x10 RKey 0x183000 VAddr 0x007f825c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0477 PSN 0xaebb1c OUT 0x10 RKey 0x183000 VAddr 0x007f825c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0478 PSN 0xd057aa OUT 0x10 RKey 0x183000 VAddr 0x007f825d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0479 PSN 0x79df26 OUT 0x10 RKey 0x183000 VAddr 0x007f825d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x046a PSN 0x1bb8ee OUT 0x10 RKey 0x182f00 VAddr 0x007fb8fe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x046b PSN 0x22fb40 OUT 0x10 RKey 0x182f00 VAddr 0x007fb8fe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x046c PSN 0x11fb8a OUT 0x10 RKey 0x182f00 VAddr 0x007fb8ff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x046d PSN 0x4b511 OUT 0x10 RKey 0x182f00 VAddr 0x007fb8ff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x046e PSN 0xcc1450 OUT 0x10 RKey 0x182f00 VAddr 0x007fb900000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x046f PSN 0x7cdb72 OUT 0x10 RKey 0x182f00 VAddr 0x007fb900800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0470 PSN 0x539ce9 OUT 0x10 RKey 0x182f00 VAddr 0x007fb901000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0471 PSN 0x24612e OUT 0x10 RKey 0x182f00 VAddr 0x007fb901800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0472 PSN 0x38e3a OUT 0x10 RKey 0x182f00 VAddr 0x007fb902000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0473 PSN 0x8a2834 OUT 0x10 RKey 0x182f00 VAddr 0x007fb902800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0474 PSN 0xf30bc8 OUT 0x10 RKey 0x182f00 VAddr 0x007fb903000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0475 PSN 0xac74bb OUT 0x10 RKey 0x182f00 VAddr 0x007fb903800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0476 PSN 0xbaa38b OUT 0x10 RKey 0x182f00 VAddr 0x007fb904000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0477 PSN 0xd66ddc OUT 0x10 RKey 0x182f00 VAddr 0x007fb904800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0478 PSN 0x4ff36a OUT 0x10 RKey 0x182f00 VAddr 0x007fb905000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0479 PSN 0xbdafe6 OUT 0x10 RKey 0x182f00 VAddr 0x007fb905800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.078431            0.077967            4.872908
 4          16000            0.16               0.16   		     4.971816
 8          16000            0.32               0.32   		     4.974784
 16         16000            0.64               0.64   		     4.970071
 32         16000            1.27               1.26   		     4.941108
 64         16000            2.56               2.55   		     4.975141
 128        16000            5.07               5.05   		     4.934875
 256        16000            10.19              10.16  		     4.962902
 512        16000            20.43              20.37  		     4.973114
 1024       16000            40.51              40.40  		     4.932198
 2048       16000            81.02              80.77  		     4.929979
 4096       16000            159.58             158.68 		     4.842395
 8192       16000            201.44             201.34 		     3.072273
 16384      16000            202.41             202.41 		     1.544258
 32768      16000            202.76             202.71 		     0.773283
 65536      16000            202.83             202.80 		     0.386811
 131072     16000            202.85             202.84 		     0.193445
 262144     16000            202.90             202.89 		     0.096746
 524288     16000            202.92             202.92 		     0.048380
 1048576    16000            202.93             202.93 		     0.024191
 2097152    16000            189.71             189.71 		     0.011307
 4194304    16000            169.90             169.90 		     0.005064
 8388608    16000            169.94             169.94 		     0.002532
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f824e000000
destroying current CUDA Ctx
