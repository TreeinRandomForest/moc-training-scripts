initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 20876, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fc1a0000000 pointer=0x7fc1a0000000
using DMA-BUF for GPU buffer address at 0x7fc1a0000000 aligned at 0x7fc1a0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fc1a0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0a62 PSN 0x468836 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a63 PSN 0xf7ece8 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a64 PSN 0xb9d012 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a65 PSN 0xcc62f9 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a66 PSN 0xef9018 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a67 PSN 0x2e3f9a OUT 0x10 RKey 0x183000 VAddr 0x007fc1b2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a68 PSN 0xb731f1 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a69 PSN 0xd00596 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a6a PSN 0xadfe82 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a6b PSN 0x5ca6dc OUT 0x10 RKey 0x183000 VAddr 0x007fc1b4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a6c PSN 0x3de950 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a6d PSN 0xf4f7a3 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a6e PSN 0x16d053 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a6f PSN 0xb12f04 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a70 PSN 0xde2172 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a71 PSN 0x2794e OUT 0x10 RKey 0x183000 VAddr 0x007fc1b7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a72 PSN 0x16354b OUT 0x10 RKey 0x183000 VAddr 0x007fc1b8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a73 PSN 0xddaaa9 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a74 PSN 0x64bed0 OUT 0x10 RKey 0x183000 VAddr 0x007fc1b9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a75 PSN 0x56877d OUT 0x10 RKey 0x183000 VAddr 0x007fc1b9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a76 PSN 0x98579a OUT 0x10 RKey 0x183000 VAddr 0x007fc1ba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a77 PSN 0x72a461 OUT 0x10 RKey 0x183000 VAddr 0x007fc1ba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a78 PSN 0xa09ab1 OUT 0x10 RKey 0x183000 VAddr 0x007fc1bb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a79 PSN 0x649865 OUT 0x10 RKey 0x183000 VAddr 0x007fc1bb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a7a PSN 0x82d202 OUT 0x10 RKey 0x183000 VAddr 0x007fc1bc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a7b PSN 0xf86aa5 OUT 0x10 RKey 0x183000 VAddr 0x007fc1bc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a7c PSN 0x119e62 OUT 0x10 RKey 0x183000 VAddr 0x007fc1bd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a7d PSN 0x324f3c OUT 0x10 RKey 0x183000 VAddr 0x007fc1bd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a7e PSN 0x571eab OUT 0x10 RKey 0x183000 VAddr 0x007fc1be000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a7f PSN 0xd9b7d1 OUT 0x10 RKey 0x183000 VAddr 0x007fc1be800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a80 PSN 0x9c1813 OUT 0x10 RKey 0x183000 VAddr 0x007fc1bf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a81 PSN 0xe67906 OUT 0x10 RKey 0x183000 VAddr 0x007fc1bf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0a62 PSN 0xc1789e OUT 0x10 RKey 0x183100 VAddr 0x007f9f90000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a63 PSN 0x2db930 OUT 0x10 RKey 0x183100 VAddr 0x007f9f90800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a64 PSN 0x8a7aba OUT 0x10 RKey 0x183100 VAddr 0x007f9f91000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a65 PSN 0xd7fc81 OUT 0x10 RKey 0x183100 VAddr 0x007f9f91800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a66 PSN 0x301f00 OUT 0x10 RKey 0x183100 VAddr 0x007f9f92000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a67 PSN 0xef8862 OUT 0x10 RKey 0x183100 VAddr 0x007f9f92800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a68 PSN 0xc6df19 OUT 0x10 RKey 0x183100 VAddr 0x007f9f93000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a69 PSN 0xeeaf9e OUT 0x10 RKey 0x183100 VAddr 0x007f9f93800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a6a PSN 0xdf93ea OUT 0x10 RKey 0x183100 VAddr 0x007f9f94000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a6b PSN 0x94b424 OUT 0x10 RKey 0x183100 VAddr 0x007f9f94800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a6c PSN 0x6a40f8 OUT 0x10 RKey 0x183100 VAddr 0x007f9f95000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a6d PSN 0x773a2b OUT 0x10 RKey 0x183100 VAddr 0x007f9f95800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a6e PSN 0xb3543b OUT 0x10 RKey 0x183100 VAddr 0x007f9f96000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a6f PSN 0xb7c8cc OUT 0x10 RKey 0x183100 VAddr 0x007f9f96800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a70 PSN 0x374b9a OUT 0x10 RKey 0x183100 VAddr 0x007f9f97000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a71 PSN 0xb95c56 OUT 0x10 RKey 0x183100 VAddr 0x007f9f97800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a72 PSN 0x4e0fb3 OUT 0x10 RKey 0x183100 VAddr 0x007f9f98000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a73 PSN 0xbf18f1 OUT 0x10 RKey 0x183100 VAddr 0x007f9f98800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a74 PSN 0xd56378 OUT 0x10 RKey 0x183100 VAddr 0x007f9f99000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a75 PSN 0x1b9305 OUT 0x10 RKey 0x183100 VAddr 0x007f9f99800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a76 PSN 0x3a7082 OUT 0x10 RKey 0x183100 VAddr 0x007f9f9a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a77 PSN 0xb7af29 OUT 0x10 RKey 0x183100 VAddr 0x007f9f9a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a78 PSN 0x15e1d9 OUT 0x10 RKey 0x183100 VAddr 0x007f9f9b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a79 PSN 0x21d46d OUT 0x10 RKey 0x183100 VAddr 0x007f9f9b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a7a PSN 0x64916a OUT 0x10 RKey 0x183100 VAddr 0x007f9f9c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a7b PSN 0xee59ed OUT 0x10 RKey 0x183100 VAddr 0x007f9f9c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a7c PSN 0x23300a OUT 0x10 RKey 0x183100 VAddr 0x007f9f9d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a7d PSN 0x6a43c4 OUT 0x10 RKey 0x183100 VAddr 0x007f9f9d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a7e PSN 0x3c6c93 OUT 0x10 RKey 0x183100 VAddr 0x007f9f9e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a7f PSN 0x5a5399 OUT 0x10 RKey 0x183100 VAddr 0x007f9f9e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a80 PSN 0xb41c3b OUT 0x10 RKey 0x183100 VAddr 0x007f9f9f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a81 PSN 0xbc2e0e OUT 0x10 RKey 0x183100 VAddr 0x007f9f9f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.056782            0.056450            3.528107
 4          32000            0.12               0.12   		     3.599218
 8          32000            0.23               0.23   		     3.600842
 16         32000            0.46               0.46   		     3.599736
 32         32000            0.92               0.92   		     3.590761
 64         32000            1.85               1.84   		     3.598797
 128        32000            3.68               3.68   		     3.589255
 256        32000            7.40               7.38   		     3.601527
 512        32000            14.75              14.72  		     3.593463
 1024       32000            29.49              29.42  		     3.591269
 2048       32000            58.79              58.68  		     3.581558
 4096       32000            117.40             116.77 		     3.563653
 8192       32000            196.87             196.78 		     3.002623
 16384      32000            205.51             205.43 		     1.567282
 32768      32000            205.94             205.93 		     0.785563
 65536      32000            207.75             207.75 		     0.396253
 131072     32000            208.64             208.63 		     0.198962
 262144     32000            209.19             209.18 		     0.099747
 524288     32000            209.25             209.25 		     0.049890
 1048576    32000            186.78             186.78 		     0.022266
 2097152    32000            171.33             171.33 		     0.010212
 4194304    32000            171.22             171.22 		     0.005103
 8388608    32000            171.20             171.20 		     0.002551
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fc1a0000000
destroying current CUDA Ctx
