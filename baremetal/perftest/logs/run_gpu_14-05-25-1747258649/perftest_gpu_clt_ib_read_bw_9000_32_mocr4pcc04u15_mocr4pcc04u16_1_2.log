initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 14341, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f44e0000000 pointer=0x7f44e0000000
using DMA-BUF for GPU buffer address at 0x7f44e0000000 aligned at 0x7f44e0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f44e0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0576 PSN 0x17b0ff OUT 0x10 RKey 0x183100 VAddr 0x007f44f0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0577 PSN 0x6d53b4 OUT 0x10 RKey 0x183100 VAddr 0x007f44f0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0578 PSN 0xab69b8 OUT 0x10 RKey 0x183100 VAddr 0x007f44f1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0579 PSN 0x477f70 OUT 0x10 RKey 0x183100 VAddr 0x007f44f1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x057a PSN 0x180bfa OUT 0x10 RKey 0x183100 VAddr 0x007f44f2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x057b PSN 0x99979e OUT 0x10 RKey 0x183100 VAddr 0x007f44f2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x057c PSN 0xb8d06f OUT 0x10 RKey 0x183100 VAddr 0x007f44f3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x057d PSN 0x974206 OUT 0x10 RKey 0x183100 VAddr 0x007f44f3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x057e PSN 0x98e6fc OUT 0x10 RKey 0x183100 VAddr 0x007f44f4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x057f PSN 0x40cb97 OUT 0x10 RKey 0x183100 VAddr 0x007f44f4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0580 PSN 0x3c0225 OUT 0x10 RKey 0x183100 VAddr 0x007f44f5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0581 PSN 0x475b8b OUT 0x10 RKey 0x183100 VAddr 0x007f44f5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0582 PSN 0x5756e5 OUT 0x10 RKey 0x183100 VAddr 0x007f44f6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0583 PSN 0x3333f7 OUT 0x10 RKey 0x183100 VAddr 0x007f44f6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0584 PSN 0x27021f OUT 0x10 RKey 0x183100 VAddr 0x007f44f7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0585 PSN 0xd8042d OUT 0x10 RKey 0x183100 VAddr 0x007f44f7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0586 PSN 0xd12375 OUT 0x10 RKey 0x183100 VAddr 0x007f44f8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0587 PSN 0xb05b54 OUT 0x10 RKey 0x183100 VAddr 0x007f44f8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0588 PSN 0xee0cd6 OUT 0x10 RKey 0x183100 VAddr 0x007f44f9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0589 PSN 0xf7b0d4 OUT 0x10 RKey 0x183100 VAddr 0x007f44f9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x058a PSN 0x58edb OUT 0x10 RKey 0x183100 VAddr 0x007f44fa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x058b PSN 0xfa0445 OUT 0x10 RKey 0x183100 VAddr 0x007f44fa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x058c PSN 0x24d38f OUT 0x10 RKey 0x183100 VAddr 0x007f44fb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x058d PSN 0xf9cfb5 OUT 0x10 RKey 0x183100 VAddr 0x007f44fb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x058e PSN 0x6cbdc OUT 0x10 RKey 0x183100 VAddr 0x007f44fc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x058f PSN 0x253541 OUT 0x10 RKey 0x183100 VAddr 0x007f44fc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0590 PSN 0x859798 OUT 0x10 RKey 0x183100 VAddr 0x007f44fd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0591 PSN 0xcb7c04 OUT 0x10 RKey 0x183100 VAddr 0x007f44fd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0592 PSN 0xb46c9c OUT 0x10 RKey 0x183100 VAddr 0x007f44fe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0593 PSN 0x3ce0a5 OUT 0x10 RKey 0x183100 VAddr 0x007f44fe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0594 PSN 0x7c7f20 OUT 0x10 RKey 0x183100 VAddr 0x007f44ff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0595 PSN 0x7a7ac6 OUT 0x10 RKey 0x183100 VAddr 0x007f44ff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0576 PSN 0x786069 OUT 0x10 RKey 0x183000 VAddr 0x007f3930000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0577 PSN 0x72cc9f OUT 0x10 RKey 0x183000 VAddr 0x007f3930800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0578 PSN 0xbd7afd OUT 0x10 RKey 0x183000 VAddr 0x007f3931000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0579 PSN 0x8f4b08 OUT 0x10 RKey 0x183000 VAddr 0x007f3931800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x057a PSN 0x3dd87b OUT 0x10 RKey 0x183000 VAddr 0x007f3932000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x057b PSN 0xd003c1 OUT 0x10 RKey 0x183000 VAddr 0x007f3932800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x057c PSN 0xc6c08c OUT 0x10 RKey 0x183000 VAddr 0x007f3933000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x057d PSN 0x72ff95 OUT 0x10 RKey 0x183000 VAddr 0x007f3933800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x057e PSN 0xc18a15 OUT 0x10 RKey 0x183000 VAddr 0x007f3934000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x057f PSN 0x992673 OUT 0x10 RKey 0x183000 VAddr 0x007f3934800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0580 PSN 0xd5e69b OUT 0x10 RKey 0x183000 VAddr 0x007f3935000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0581 PSN 0x613292 OUT 0x10 RKey 0x183000 VAddr 0x007f3935800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0582 PSN 0x72a216 OUT 0x10 RKey 0x183000 VAddr 0x007f3936000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0583 PSN 0x2b10b OUT 0x10 RKey 0x183000 VAddr 0x007f3936800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0584 PSN 0xd8c86d OUT 0x10 RKey 0x183000 VAddr 0x007f3937000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0585 PSN 0x25142d OUT 0x10 RKey 0x183000 VAddr 0x007f3937800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0586 PSN 0x8a803e OUT 0x10 RKey 0x183000 VAddr 0x007f3938000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0587 PSN 0xbbe620 OUT 0x10 RKey 0x183000 VAddr 0x007f3938800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0588 PSN 0x24fa7b OUT 0x10 RKey 0x183000 VAddr 0x007f3939000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0589 PSN 0x6f914c OUT 0x10 RKey 0x183000 VAddr 0x007f3939800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x058a PSN 0xe57ebd OUT 0x10 RKey 0x183000 VAddr 0x007f393a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x058b PSN 0xb9c048 OUT 0x10 RKey 0x183000 VAddr 0x007f393a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x058c PSN 0xed060c OUT 0x10 RKey 0x183000 VAddr 0x007f393b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x058d PSN 0x461024 OUT 0x10 RKey 0x183000 VAddr 0x007f393b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x058e PSN 0x2c6855 OUT 0x10 RKey 0x183000 VAddr 0x007f393c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x058f PSN 0xbffdfc OUT 0x10 RKey 0x183000 VAddr 0x007f393c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0590 PSN 0x9f846d OUT 0x10 RKey 0x183000 VAddr 0x007f393d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0591 PSN 0x6f23eb OUT 0x10 RKey 0x183000 VAddr 0x007f393d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0592 PSN 0xa6e72e OUT 0x10 RKey 0x183000 VAddr 0x007f393e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0593 PSN 0xbbc998 OUT 0x10 RKey 0x183000 VAddr 0x007f393e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0594 PSN 0x4a73ce OUT 0x10 RKey 0x183000 VAddr 0x007f393f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0595 PSN 0xf189a5 OUT 0x10 RKey 0x183000 VAddr 0x007f393f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.081818            0.081205            5.075321
 4          32000            0.17               0.17   		     5.237230
 8          32000            0.34               0.34   		     5.240970
 16         32000            0.67               0.67   		     5.210284
 32         32000            1.34               1.34   		     5.227485
 64         32000            2.68               2.67   		     5.212270
 128        32000            5.36               5.35   		     5.222111
 256        32000            10.72              10.67  		     5.212219
 512        32000            21.48              21.42  		     5.228673
 1024       32000            42.87              42.70  		     5.211930
 2048       32000            85.33              85.18  		     5.198775
 4096       32000            171.46             171.10 		     5.221498
 8192       32000            202.27             202.05 		     3.083069
 16384      32000            202.55             202.54 		     1.545294
 32768      32000            202.76             202.71 		     0.773274
 65536      32000            202.62             202.61 		     0.386443
 131072     32000            202.74             202.73 		     0.193339
 262144     32000            202.81             202.81 		     0.096706
 524288     32000            202.81             202.80 		     0.048352
 1048576    32000            184.15             184.15 		     0.021953
 2097152    32000            170.17             170.17 		     0.010143
 4194304    32000            170.13             170.13 		     0.005070
 8388608    32000            170.14             170.14 		     0.002535
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f44e0000000
destroying current CUDA Ctx
