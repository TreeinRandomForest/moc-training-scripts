initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 18294, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f4e20000000 pointer=0x7f4e20000000
using DMA-BUF for GPU buffer address at 0x7f4e20000000 aligned at 0x7f4e20000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f4e20000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x07ec PSN 0xc61eca OUT 0x10 RKey 0x183100 VAddr 0x007f4e30000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07ed PSN 0x401ec OUT 0x10 RKey 0x183100 VAddr 0x007f4e30800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07ee PSN 0x705ac6 OUT 0x10 RKey 0x183100 VAddr 0x007f4e31000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07ef PSN 0x13299d OUT 0x10 RKey 0x183100 VAddr 0x007f4e31800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07f0 PSN 0xb97bec OUT 0x10 RKey 0x183100 VAddr 0x007f4e32000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07f1 PSN 0x7820de OUT 0x10 RKey 0x183100 VAddr 0x007f4e32800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07f2 PSN 0x3f33e5 OUT 0x10 RKey 0x183100 VAddr 0x007f4e33000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07f3 PSN 0x6a127a OUT 0x10 RKey 0x183100 VAddr 0x007f4e33800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07f4 PSN 0xa5396 OUT 0x10 RKey 0x183100 VAddr 0x007f4e34000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07f5 PSN 0x8cd860 OUT 0x10 RKey 0x183100 VAddr 0x007f4e34800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07f6 PSN 0xef9684 OUT 0x10 RKey 0x183100 VAddr 0x007f4e35000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07f7 PSN 0x286ec7 OUT 0x10 RKey 0x183100 VAddr 0x007f4e35800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07f8 PSN 0x3ae2a7 OUT 0x10 RKey 0x183100 VAddr 0x007f4e36000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07f9 PSN 0xf474c8 OUT 0x10 RKey 0x183100 VAddr 0x007f4e36800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07fa PSN 0xe0ede6 OUT 0x10 RKey 0x183100 VAddr 0x007f4e37000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07fb PSN 0xd3beb2 OUT 0x10 RKey 0x183100 VAddr 0x007f4e37800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07fc PSN 0xb898df OUT 0x10 RKey 0x183100 VAddr 0x007f4e38000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07fd PSN 0xe908ad OUT 0x10 RKey 0x183100 VAddr 0x007f4e38800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07fe PSN 0x635e84 OUT 0x10 RKey 0x183100 VAddr 0x007f4e39000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07ff PSN 0x2c3f21 OUT 0x10 RKey 0x183100 VAddr 0x007f4e39800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0800 PSN 0xc4e06e OUT 0x10 RKey 0x183100 VAddr 0x007f4e3a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0801 PSN 0xc75ea5 OUT 0x10 RKey 0x183100 VAddr 0x007f4e3a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0802 PSN 0xbd01a5 OUT 0x10 RKey 0x183100 VAddr 0x007f4e3b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0803 PSN 0xeba649 OUT 0x10 RKey 0x183100 VAddr 0x007f4e3b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0804 PSN 0xae9416 OUT 0x10 RKey 0x183100 VAddr 0x007f4e3c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0805 PSN 0x680529 OUT 0x10 RKey 0x183100 VAddr 0x007f4e3c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0806 PSN 0x190096 OUT 0x10 RKey 0x183100 VAddr 0x007f4e3d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0807 PSN 0x81d760 OUT 0x10 RKey 0x183100 VAddr 0x007f4e3d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0808 PSN 0xb46dff OUT 0x10 RKey 0x183100 VAddr 0x007f4e3e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0809 PSN 0x49f695 OUT 0x10 RKey 0x183100 VAddr 0x007f4e3e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x080a PSN 0x7ae987 OUT 0x10 RKey 0x183100 VAddr 0x007f4e3f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x080b PSN 0xe3df6a OUT 0x10 RKey 0x183100 VAddr 0x007f4e3f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x07ec PSN 0xab0cd8 OUT 0x10 RKey 0x183000 VAddr 0x007f1f90000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07ed PSN 0x45f1e2 OUT 0x10 RKey 0x183000 VAddr 0x007f1f90800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07ee PSN 0xe28a84 OUT 0x10 RKey 0x183000 VAddr 0x007f1f91000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07ef PSN 0xbe3183 OUT 0x10 RKey 0x183000 VAddr 0x007f1f91800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07f0 PSN 0xac7cda OUT 0x10 RKey 0x183000 VAddr 0x007f1f92000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07f1 PSN 0x2d5a34 OUT 0x10 RKey 0x183000 VAddr 0x007f1f92800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07f2 PSN 0x33e183 OUT 0x10 RKey 0x183000 VAddr 0x007f1f93000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07f3 PSN 0x3bf2c0 OUT 0x10 RKey 0x183000 VAddr 0x007f1f93800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07f4 PSN 0x6db564 OUT 0x10 RKey 0x183000 VAddr 0x007f1f94000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07f5 PSN 0xa49116 OUT 0x10 RKey 0x183000 VAddr 0x007f1f94800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07f6 PSN 0xc4c002 OUT 0x10 RKey 0x183000 VAddr 0x007f1f95000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07f7 PSN 0x5a4d6d OUT 0x10 RKey 0x183000 VAddr 0x007f1f95800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07f8 PSN 0x87d355 OUT 0x10 RKey 0x183000 VAddr 0x007f1f96000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07f9 PSN 0x5b42de OUT 0x10 RKey 0x183000 VAddr 0x007f1f96800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07fa PSN 0x167144 OUT 0x10 RKey 0x183000 VAddr 0x007f1f97000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07fb PSN 0x4b21b8 OUT 0x10 RKey 0x183000 VAddr 0x007f1f97800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07fc PSN 0xd266d OUT 0x10 RKey 0x183000 VAddr 0x007f1f98000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07fd PSN 0xfee223 OUT 0x10 RKey 0x183000 VAddr 0x007f1f98800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07fe PSN 0xd8f9c2 OUT 0x10 RKey 0x183000 VAddr 0x007f1f99000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07ff PSN 0xe10c87 OUT 0x10 RKey 0x183000 VAddr 0x007f1f99800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0800 PSN 0x51f8dc OUT 0x10 RKey 0x183000 VAddr 0x007f1f9a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0801 PSN 0x35997b OUT 0x10 RKey 0x183000 VAddr 0x007f1f9a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0802 PSN 0xd052c3 OUT 0x10 RKey 0x183000 VAddr 0x007f1f9b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0803 PSN 0xae240f OUT 0x10 RKey 0x183000 VAddr 0x007f1f9b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0804 PSN 0x60564 OUT 0x10 RKey 0x183000 VAddr 0x007f1f9c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0805 PSN 0x57575f OUT 0x10 RKey 0x183000 VAddr 0x007f1f9c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0806 PSN 0xa38594 OUT 0x10 RKey 0x183000 VAddr 0x007f1f9d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0807 PSN 0x20ab86 OUT 0x10 RKey 0x183000 VAddr 0x007f1f9d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0808 PSN 0xf6e62d OUT 0x10 RKey 0x183000 VAddr 0x007f1f9e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0809 PSN 0xf8762b OUT 0x10 RKey 0x183000 VAddr 0x007f1f9e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x080a PSN 0xb00065 OUT 0x10 RKey 0x183000 VAddr 0x007f1f9f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x080b PSN 0xb20ff0 OUT 0x10 RKey 0x183000 VAddr 0x007f1f9f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.077253            0.076815            4.800912
 4          32000            0.16               0.16   		     4.931369
 8          32000            0.32               0.32   		     4.944674
 16         32000            0.63               0.63   		     4.927155
 32         32000            1.27               1.27   		     4.941429
 64         32000            2.55               2.54   		     4.958227
 128        32000            5.05               5.02   		     4.906937
 256        32000            10.11              10.10  		     4.932737
 512        32000            20.25              20.21  		     4.934282
 1024       32000            40.51              40.40  		     4.931567
 2048       32000            80.84              80.64  		     4.922032
 4096       32000            158.89             153.24 		     4.676454
 8192       32000            197.40             197.37 		     3.011700
 16384      32000            197.79             197.79 		     1.508991
 32768      32000            198.06             198.02 		     0.755400
 65536      32000            197.89             197.86 		     0.377396
 131072     32000            198.01             198.00 		     0.188825
 262144     32000            198.04             198.03 		     0.094427
 524288     32000            198.07             198.07 		     0.047224
 1048576    32000            178.96             178.96 		     0.021333
 2097152    32000            164.05             164.05 		     0.009778
 4194304    32000            164.00             164.00 		     0.004888
 8388608    32000            164.01             164.01 		     0.002444
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f4e20000000
destroying current CUDA Ctx
