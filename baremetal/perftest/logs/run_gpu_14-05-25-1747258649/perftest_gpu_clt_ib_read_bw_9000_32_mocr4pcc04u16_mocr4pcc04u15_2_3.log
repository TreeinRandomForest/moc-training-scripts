initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 28845, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f8de0000000 pointer=0x7f8de0000000
using DMA-BUF for GPU buffer address at 0x7f8de0000000 aligned at 0x7f8de0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f8de0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0fcc PSN 0xf480b2 OUT 0x10 RKey 0x183000 VAddr 0x007f8df0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fcd PSN 0x1094eb OUT 0x10 RKey 0x183000 VAddr 0x007f8df0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fce PSN 0x799823 OUT 0x10 RKey 0x183000 VAddr 0x007f8df1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fcf PSN 0x6964ff OUT 0x10 RKey 0x183000 VAddr 0x007f8df1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fd0 PSN 0x9943dd OUT 0x10 RKey 0x183000 VAddr 0x007f8df2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fd1 PSN 0x185545 OUT 0x10 RKey 0x183000 VAddr 0x007f8df2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fd2 PSN 0x79a8a OUT 0x10 RKey 0x183000 VAddr 0x007f8df3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fd3 PSN 0x9b9185 OUT 0x10 RKey 0x183000 VAddr 0x007f8df3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fd4 PSN 0xeeda0f OUT 0x10 RKey 0x183000 VAddr 0x007f8df4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fd5 PSN 0xc05cae OUT 0x10 RKey 0x183000 VAddr 0x007f8df4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fd6 PSN 0x1b72f0 OUT 0x10 RKey 0x183000 VAddr 0x007f8df5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fd7 PSN 0xe4c3fa OUT 0x10 RKey 0x183000 VAddr 0x007f8df5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fd8 PSN 0x848828 OUT 0x10 RKey 0x183000 VAddr 0x007f8df6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fd9 PSN 0x775f7e OUT 0x10 RKey 0x183000 VAddr 0x007f8df6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fda PSN 0xbcd49a OUT 0x10 RKey 0x183000 VAddr 0x007f8df7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fdb PSN 0x21248c OUT 0x10 RKey 0x183000 VAddr 0x007f8df7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fdc PSN 0x9d45e8 OUT 0x10 RKey 0x183000 VAddr 0x007f8df8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fdd PSN 0x92584b OUT 0x10 RKey 0x183000 VAddr 0x007f8df8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fde PSN 0x20ac01 OUT 0x10 RKey 0x183000 VAddr 0x007f8df9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fdf PSN 0x2a1823 OUT 0x10 RKey 0x183000 VAddr 0x007f8df9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fe0 PSN 0x20857e OUT 0x10 RKey 0x183000 VAddr 0x007f8dfa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fe1 PSN 0x4f79ac OUT 0x10 RKey 0x183000 VAddr 0x007f8dfa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fe2 PSN 0xf65a6a OUT 0x10 RKey 0x183000 VAddr 0x007f8dfb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fe3 PSN 0x3cfcf4 OUT 0x10 RKey 0x183000 VAddr 0x007f8dfb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fe4 PSN 0x5ba9af OUT 0x10 RKey 0x183000 VAddr 0x007f8dfc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fe5 PSN 0x173a18 OUT 0x10 RKey 0x183000 VAddr 0x007f8dfc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fe6 PSN 0x1ed123 OUT 0x10 RKey 0x183000 VAddr 0x007f8dfd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fe7 PSN 0xdfde33 OUT 0x10 RKey 0x183000 VAddr 0x007f8dfd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fe8 PSN 0xec749f OUT 0x10 RKey 0x183000 VAddr 0x007f8dfe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fe9 PSN 0xefbec OUT 0x10 RKey 0x183000 VAddr 0x007f8dfe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0fea PSN 0xe7e65b OUT 0x10 RKey 0x183000 VAddr 0x007f8dff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0feb PSN 0x5870e5 OUT 0x10 RKey 0x183000 VAddr 0x007f8dff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0fcc PSN 0x70fef OUT 0x10 RKey 0x183100 VAddr 0x007f9d90000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fcd PSN 0xe45fe4 OUT 0x10 RKey 0x183100 VAddr 0x007f9d90800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fce PSN 0x8eba28 OUT 0x10 RKey 0x183100 VAddr 0x007f9d91000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fcf PSN 0x955f20 OUT 0x10 RKey 0x183100 VAddr 0x007f9d91800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fd0 PSN 0x7869ea OUT 0x10 RKey 0x183100 VAddr 0x007f9d92000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fd1 PSN 0x4736ce OUT 0x10 RKey 0x183100 VAddr 0x007f9d92800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fd2 PSN 0xeab7df OUT 0x10 RKey 0x183100 VAddr 0x007f9d93000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fd3 PSN 0x56cb6 OUT 0x10 RKey 0x183100 VAddr 0x007f9d93800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fd4 PSN 0x1b33ec OUT 0x10 RKey 0x183100 VAddr 0x007f9d94000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fd5 PSN 0x1b2dc7 OUT 0x10 RKey 0x183100 VAddr 0x007f9d94800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fd6 PSN 0xaef095 OUT 0x10 RKey 0x183100 VAddr 0x007f9d95000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fd7 PSN 0xaf813b OUT 0x10 RKey 0x183100 VAddr 0x007f9d95800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fd8 PSN 0xcb82d5 OUT 0x10 RKey 0x183100 VAddr 0x007f9d96000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fd9 PSN 0x638927 OUT 0x10 RKey 0x183100 VAddr 0x007f9d96800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fda PSN 0x84678f OUT 0x10 RKey 0x183100 VAddr 0x007f9d97000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fdb PSN 0xfed4dd OUT 0x10 RKey 0x183100 VAddr 0x007f9d97800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fdc PSN 0x161e65 OUT 0x10 RKey 0x183100 VAddr 0x007f9d98000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fdd PSN 0xc2d384 OUT 0x10 RKey 0x183100 VAddr 0x007f9d98800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fde PSN 0x65946 OUT 0x10 RKey 0x183100 VAddr 0x007f9d99000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fdf PSN 0x3cdc84 OUT 0x10 RKey 0x183100 VAddr 0x007f9d99800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fe0 PSN 0xf948cb OUT 0x10 RKey 0x183100 VAddr 0x007f9d9a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fe1 PSN 0xdcf75 OUT 0x10 RKey 0x183100 VAddr 0x007f9d9a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fe2 PSN 0x5f76ff OUT 0x10 RKey 0x183100 VAddr 0x007f9d9b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fe3 PSN 0x80665 OUT 0x10 RKey 0x183100 VAddr 0x007f9d9b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fe4 PSN 0x7634cc OUT 0x10 RKey 0x183100 VAddr 0x007f9d9c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fe5 PSN 0x1c8371 OUT 0x10 RKey 0x183100 VAddr 0x007f9d9c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fe6 PSN 0x510208 OUT 0x10 RKey 0x183100 VAddr 0x007f9d9d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fe7 PSN 0x486db4 OUT 0x10 RKey 0x183100 VAddr 0x007f9d9d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fe8 PSN 0x4b748c OUT 0x10 RKey 0x183100 VAddr 0x007f9d9e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fe9 PSN 0xece1d5 OUT 0x10 RKey 0x183100 VAddr 0x007f9d9e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0fea PSN 0xbe2090 OUT 0x10 RKey 0x183100 VAddr 0x007f9d9f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0feb PSN 0xb6d776 OUT 0x10 RKey 0x183100 VAddr 0x007f9d9f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.078091            0.077902            4.868890
 4          32000            0.16               0.16   		     4.970913
 8          32000            0.32               0.32   		     4.987042
 16         32000            0.64               0.64   		     4.986816
 32         32000            1.28               1.28   		     4.998297
 64         32000            2.57               2.56   		     4.993228
 128        32000            5.10               5.08   		     4.957359
 256        32000            10.24              10.20  		     4.982016
 512        32000            20.39              20.34  		     4.966653
 1024       32000            40.78              40.67  		     4.964689
 2048       32000            74.62              71.21  		     4.346403
 4096       32000            163.48             163.00 		     4.974490
 8192       32000            194.01             193.81 		     2.957325
 16384      32000            197.93             197.90 		     1.509840
 32768      32000            197.99             197.96 		     0.755149
 65536      32000            197.36             197.34 		     0.376388
 131072     32000            197.71             197.71 		     0.188548
 262144     32000            195.27             195.27 		     0.093112
 524288     32000            197.70             197.69 		     0.047133
 1048576    32000            178.22             178.22 		     0.021245
 2097152    32000            163.84             163.84 		     0.009766
 4194304    32000            163.78             163.78 		     0.004881
 8388608    32000            163.76             163.76 		     0.002440
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f8de0000000
destroying current CUDA Ctx
