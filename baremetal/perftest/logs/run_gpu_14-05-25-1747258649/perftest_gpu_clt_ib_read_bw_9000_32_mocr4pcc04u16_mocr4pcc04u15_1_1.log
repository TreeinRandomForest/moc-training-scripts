initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 24293, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f8520000000 pointer=0x7f8520000000
using DMA-BUF for GPU buffer address at 0x7f8520000000 aligned at 0x7f8520000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f8520000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0cd8 PSN 0x3dd15f OUT 0x10 RKey 0x183000 VAddr 0x007f8530000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cd9 PSN 0x3f5c94 OUT 0x10 RKey 0x183000 VAddr 0x007f8530800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cda PSN 0x927118 OUT 0x10 RKey 0x183000 VAddr 0x007f8531000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cdb PSN 0xc5e350 OUT 0x10 RKey 0x183000 VAddr 0x007f8531800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cdc PSN 0x23d25a OUT 0x10 RKey 0x183000 VAddr 0x007f8532000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cdd PSN 0x574e7e OUT 0x10 RKey 0x183000 VAddr 0x007f8532800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cde PSN 0x4cedcf OUT 0x10 RKey 0x183000 VAddr 0x007f8533000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cdf PSN 0x8c03e6 OUT 0x10 RKey 0x183000 VAddr 0x007f8533800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ce0 PSN 0x7eb35c OUT 0x10 RKey 0x183000 VAddr 0x007f8534000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ce1 PSN 0x371077 OUT 0x10 RKey 0x183000 VAddr 0x007f8534800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ce2 PSN 0x789585 OUT 0x10 RKey 0x183000 VAddr 0x007f8535000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ce3 PSN 0xfa5b6b OUT 0x10 RKey 0x183000 VAddr 0x007f8535800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ce4 PSN 0xf18945 OUT 0x10 RKey 0x183000 VAddr 0x007f8536000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ce5 PSN 0x9ce6d7 OUT 0x10 RKey 0x183000 VAddr 0x007f8536800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ce6 PSN 0x5d6b7f OUT 0x10 RKey 0x183000 VAddr 0x007f8537000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ce7 PSN 0x2f220d OUT 0x10 RKey 0x183000 VAddr 0x007f8537800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ce8 PSN 0x401bd5 OUT 0x10 RKey 0x183000 VAddr 0x007f8538000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ce9 PSN 0x965c34 OUT 0x10 RKey 0x183000 VAddr 0x007f8538800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cea PSN 0x25ac36 OUT 0x10 RKey 0x183000 VAddr 0x007f8539000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ceb PSN 0x56ccb4 OUT 0x10 RKey 0x183000 VAddr 0x007f8539800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cec PSN 0xfad3b OUT 0x10 RKey 0x183000 VAddr 0x007f853a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ced PSN 0x133325 OUT 0x10 RKey 0x183000 VAddr 0x007f853a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cee PSN 0x7b08ef OUT 0x10 RKey 0x183000 VAddr 0x007f853b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cef PSN 0x22c995 OUT 0x10 RKey 0x183000 VAddr 0x007f853b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cf0 PSN 0x78703c OUT 0x10 RKey 0x183000 VAddr 0x007f853c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cf1 PSN 0xb67221 OUT 0x10 RKey 0x183000 VAddr 0x007f853c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cf2 PSN 0x8dc2f8 OUT 0x10 RKey 0x183000 VAddr 0x007f853d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cf3 PSN 0xbe33e4 OUT 0x10 RKey 0x183000 VAddr 0x007f853d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cf4 PSN 0xbff6fc OUT 0x10 RKey 0x183000 VAddr 0x007f853e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cf5 PSN 0xf90b85 OUT 0x10 RKey 0x183000 VAddr 0x007f853e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cf6 PSN 0xa00080 OUT 0x10 RKey 0x183000 VAddr 0x007f853f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0cf7 PSN 0x54d0a6 OUT 0x10 RKey 0x183000 VAddr 0x007f853f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0cd8 PSN 0x7b9205 OUT 0x10 RKey 0x183100 VAddr 0x007fdd50000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cd9 PSN 0xa78742 OUT 0x10 RKey 0x183100 VAddr 0x007fdd50800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cda PSN 0xacf12e OUT 0x10 RKey 0x183100 VAddr 0x007fdd51000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cdb PSN 0x6a30ae OUT 0x10 RKey 0x183100 VAddr 0x007fdd51800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cdc PSN 0x433760 OUT 0x10 RKey 0x183100 VAddr 0x007fdd52000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cdd PSN 0xb60c OUT 0x10 RKey 0x183100 VAddr 0x007fdd52800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cde PSN 0x5f9945 OUT 0x10 RKey 0x183100 VAddr 0x007fdd53000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cdf PSN 0x530924 OUT 0x10 RKey 0x183100 VAddr 0x007fdd53800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ce0 PSN 0x19a2c2 OUT 0x10 RKey 0x183100 VAddr 0x007fdd54000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ce1 PSN 0x4ca2e5 OUT 0x10 RKey 0x183100 VAddr 0x007fdd54800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ce2 PSN 0x9ec25b OUT 0x10 RKey 0x183100 VAddr 0x007fdd55000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ce3 PSN 0xcbb689 OUT 0x10 RKey 0x183100 VAddr 0x007fdd55800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ce4 PSN 0x9a490b OUT 0x10 RKey 0x183100 VAddr 0x007fdd56000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ce5 PSN 0x4a7225 OUT 0x10 RKey 0x183100 VAddr 0x007fdd56800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ce6 PSN 0x51cfb5 OUT 0x10 RKey 0x183100 VAddr 0x007fdd57000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ce7 PSN 0xe510b OUT 0x10 RKey 0x183100 VAddr 0x007fdd57800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ce8 PSN 0xa751fb OUT 0x10 RKey 0x183100 VAddr 0x007fdd58000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ce9 PSN 0x368e62 OUT 0x10 RKey 0x183100 VAddr 0x007fdd58800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cea PSN 0xd85dcc OUT 0x10 RKey 0x183100 VAddr 0x007fdd59000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ceb PSN 0x412d92 OUT 0x10 RKey 0x183100 VAddr 0x007fdd59800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cec PSN 0x8a5fc1 OUT 0x10 RKey 0x183100 VAddr 0x007fdd5a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ced PSN 0x3d9a33 OUT 0x10 RKey 0x183100 VAddr 0x007fdd5a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cee PSN 0x77de5 OUT 0x10 RKey 0x183100 VAddr 0x007fdd5b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cef PSN 0xcd9a53 OUT 0x10 RKey 0x183100 VAddr 0x007fdd5b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cf0 PSN 0xe60522 OUT 0x10 RKey 0x183100 VAddr 0x007fdd5c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cf1 PSN 0x2d7c0f OUT 0x10 RKey 0x183100 VAddr 0x007fdd5c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cf2 PSN 0x90d14e OUT 0x10 RKey 0x183100 VAddr 0x007fdd5d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cf3 PSN 0x349282 OUT 0x10 RKey 0x183100 VAddr 0x007fdd5d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cf4 PSN 0xd03442 OUT 0x10 RKey 0x183100 VAddr 0x007fdd5e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cf5 PSN 0x780653 OUT 0x10 RKey 0x183100 VAddr 0x007fdd5e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cf6 PSN 0xedde36 OUT 0x10 RKey 0x183100 VAddr 0x007fdd5f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0cf7 PSN 0x75bb24 OUT 0x10 RKey 0x183100 VAddr 0x007fdd5f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.083916            0.082429            5.151826
 4          32000            0.17               0.17   		     5.304890
 8          32000            0.35               0.35   		     5.401546
 16         32000            0.69               0.69   		     5.394535
 32         32000            1.38               1.38   		     5.379797
 64         32000            2.77               2.76   		     5.385058
 128        32000            5.51               5.50   		     5.367137
 256        32000            11.05              11.01  		     5.374733
 512        32000            21.94              21.88  		     5.342603
 1024       32000            45.29              45.19  		     5.515815
 2048       32000            92.85              91.91  		     5.609731
 4096       32000            198.19             197.64 		     6.031534
 8192       32000            200.62             200.48 		     3.059031
 16384      32000            198.73             198.65 		     1.515543
 32768      32000            200.89             200.87 		     0.766247
 65536      32000            199.53             199.53 		     0.380570
 131072     32000            199.16             199.16 		     0.189937
 262144     32000            200.37             200.37 		     0.095544
 524288     32000            199.59             199.59 		     0.047587
 1048576    32000            183.08             181.90 		     0.021684
 2097152    32000            168.34             168.33 		     0.010034
 4194304    32000            169.23             167.70 		     0.004998
 8388608    32000            167.90             167.31 		     0.002493
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f8520000000
destroying current CUDA Ctx
