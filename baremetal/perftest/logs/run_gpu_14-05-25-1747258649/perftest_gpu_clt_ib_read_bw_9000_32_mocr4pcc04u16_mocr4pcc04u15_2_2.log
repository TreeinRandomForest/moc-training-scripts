initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 28167, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fbbe0000000 pointer=0x7fbbe0000000
using DMA-BUF for GPU buffer address at 0x7fbbe0000000 aligned at 0x7fbbe0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fbbe0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0f4e PSN 0x5fa4fa OUT 0x10 RKey 0x183000 VAddr 0x007fbbf0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f4f PSN 0x31445c OUT 0x10 RKey 0x183000 VAddr 0x007fbbf0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f50 PSN 0xa64476 OUT 0x10 RKey 0x183000 VAddr 0x007fbbf1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f51 PSN 0x3bc98d OUT 0x10 RKey 0x183000 VAddr 0x007fbbf1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f52 PSN 0xf7351c OUT 0x10 RKey 0x183000 VAddr 0x007fbbf2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f53 PSN 0x611a4e OUT 0x10 RKey 0x183000 VAddr 0x007fbbf2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f54 PSN 0xcc0895 OUT 0x10 RKey 0x183000 VAddr 0x007fbbf3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f55 PSN 0xb6c16a OUT 0x10 RKey 0x183000 VAddr 0x007fbbf3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f56 PSN 0x1c6fc6 OUT 0x10 RKey 0x183000 VAddr 0x007fbbf4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f57 PSN 0xd5f8d0 OUT 0x10 RKey 0x183000 VAddr 0x007fbbf4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f58 PSN 0x770634 OUT 0x10 RKey 0x183000 VAddr 0x007fbbf5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f59 PSN 0x6b1cb7 OUT 0x10 RKey 0x183000 VAddr 0x007fbbf5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f5a PSN 0x2491d7 OUT 0x10 RKey 0x183000 VAddr 0x007fbbf6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f5b PSN 0x192c38 OUT 0x10 RKey 0x183000 VAddr 0x007fbbf6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f5c PSN 0x91a896 OUT 0x10 RKey 0x183000 VAddr 0x007fbbf7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f5d PSN 0xd5ba2 OUT 0x10 RKey 0x183000 VAddr 0x007fbbf7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f5e PSN 0x800b0f OUT 0x10 RKey 0x183000 VAddr 0x007fbbf8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f5f PSN 0xabc71d OUT 0x10 RKey 0x183000 VAddr 0x007fbbf8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f60 PSN 0xa71434 OUT 0x10 RKey 0x183000 VAddr 0x007fbbf9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f61 PSN 0x7cbb11 OUT 0x10 RKey 0x183000 VAddr 0x007fbbf9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f62 PSN 0xa3459e OUT 0x10 RKey 0x183000 VAddr 0x007fbbfa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f63 PSN 0xa19415 OUT 0x10 RKey 0x183000 VAddr 0x007fbbfa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f64 PSN 0xe86255 OUT 0x10 RKey 0x183000 VAddr 0x007fbbfb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f65 PSN 0x81f139 OUT 0x10 RKey 0x183000 VAddr 0x007fbbfb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f66 PSN 0x401c46 OUT 0x10 RKey 0x183000 VAddr 0x007fbbfc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f67 PSN 0xfa2199 OUT 0x10 RKey 0x183000 VAddr 0x007fbbfc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f68 PSN 0x1bbc46 OUT 0x10 RKey 0x183000 VAddr 0x007fbbfd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f69 PSN 0x8be150 OUT 0x10 RKey 0x183000 VAddr 0x007fbbfd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f6a PSN 0x28492f OUT 0x10 RKey 0x183000 VAddr 0x007fbbfe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f6b PSN 0xcb6a05 OUT 0x10 RKey 0x183000 VAddr 0x007fbbfe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f6c PSN 0x8fb037 OUT 0x10 RKey 0x183000 VAddr 0x007fbbff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0f6d PSN 0x7e985a OUT 0x10 RKey 0x183000 VAddr 0x007fbbff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0f4e PSN 0x681f66 OUT 0x10 RKey 0x183100 VAddr 0x007fe110000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f4f PSN 0x5a6c58 OUT 0x10 RKey 0x183100 VAddr 0x007fe110800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f50 PSN 0x68b2c2 OUT 0x10 RKey 0x183100 VAddr 0x007fe111000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f51 PSN 0x2d07e9 OUT 0x10 RKey 0x183100 VAddr 0x007fe111800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f52 PSN 0x856a48 OUT 0x10 RKey 0x183100 VAddr 0x007fe112000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f53 PSN 0x43460a OUT 0x10 RKey 0x183100 VAddr 0x007fe112800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f54 PSN 0xb38fa1 OUT 0x10 RKey 0x183100 VAddr 0x007fe113000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f55 PSN 0xb00986 OUT 0x10 RKey 0x183100 VAddr 0x007fe113800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f56 PSN 0xd94bb2 OUT 0x10 RKey 0x183100 VAddr 0x007fe114000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f57 PSN 0x65a44c OUT 0x10 RKey 0x183100 VAddr 0x007fe114800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f58 PSN 0x47200 OUT 0x10 RKey 0x183100 VAddr 0x007fe115000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f59 PSN 0x8b4a93 OUT 0x10 RKey 0x183100 VAddr 0x007fe115800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f5a PSN 0xdbc083 OUT 0x10 RKey 0x183100 VAddr 0x007fe116000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f5b PSN 0x969374 OUT 0x10 RKey 0x183100 VAddr 0x007fe116800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f5c PSN 0x68522 OUT 0x10 RKey 0x183100 VAddr 0x007fe117000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f5d PSN 0x50b3e OUT 0x10 RKey 0x183100 VAddr 0x007fe117800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f5e PSN 0x8bf87b OUT 0x10 RKey 0x183100 VAddr 0x007fe118000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f5f PSN 0x9ee619 OUT 0x10 RKey 0x183100 VAddr 0x007fe118800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f60 PSN 0x51ad80 OUT 0x10 RKey 0x183100 VAddr 0x007fe119000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f61 PSN 0xea486d OUT 0x10 RKey 0x183100 VAddr 0x007fe119800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f62 PSN 0x191dca OUT 0x10 RKey 0x183100 VAddr 0x007fe11a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f63 PSN 0x9626d1 OUT 0x10 RKey 0x183100 VAddr 0x007fe11a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f64 PSN 0x2fc461 OUT 0x10 RKey 0x183100 VAddr 0x007fe11b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f65 PSN 0xd7855 OUT 0x10 RKey 0x183100 VAddr 0x007fe11b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f66 PSN 0xdbcb32 OUT 0x10 RKey 0x183100 VAddr 0x007fe11c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f67 PSN 0xfba415 OUT 0x10 RKey 0x183100 VAddr 0x007fe11c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f68 PSN 0x4bb312 OUT 0x10 RKey 0x183100 VAddr 0x007fe11d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f69 PSN 0xc33e2c OUT 0x10 RKey 0x183100 VAddr 0x007fe11d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f6a PSN 0xf87adb OUT 0x10 RKey 0x183100 VAddr 0x007fe11e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f6b PSN 0xa11841 OUT 0x10 RKey 0x183100 VAddr 0x007fe11e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f6c PSN 0x64c7c3 OUT 0x10 RKey 0x183100 VAddr 0x007fe11f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0f6d PSN 0x7166f6 OUT 0x10 RKey 0x183100 VAddr 0x007fe11f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.076923            0.076492            4.780743
 4          32000            0.16               0.16   		     4.913801
 8          32000            0.32               0.31   		     4.919648
 16         32000            0.63               0.63   		     4.931126
 32         32000            1.27               1.26   		     4.931600
 64         32000            2.53               2.52   		     4.918688
 128        32000            5.04               5.02   		     4.905026
 256        32000            9.87               9.74   		     4.757530
 512        32000            20.17              20.11  		     4.910694
 1024       32000            40.33              40.16  		     4.902900
 2048       32000            80.14              79.95  		     4.879819
 4096       32000            156.53             99.97  		     3.050949
 8192       32000            182.50             168.61 		     2.572794
 16384      32000            195.95             195.95 		     1.494976
 32768      32000            197.00             196.97 		     0.751385
 65536      32000            190.60             190.35 		     0.363069
 131072     32000            192.66             192.64 		     0.183719
 262144     32000            195.18             195.17 		     0.093064
 524288     32000            197.96             197.96 		     0.047198
 1048576    32000            178.11             178.10 		     0.021232
 2097152    32000            163.68             163.68 		     0.009756
 4194304    32000            163.81             163.81 		     0.004882
 8388608    32000            163.81             163.81 		     0.002441
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fbbe0000000
destroying current CUDA Ctx
