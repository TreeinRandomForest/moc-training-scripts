initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 21446, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 134217728 bytes GPU buffer
allocated GPU buffer address at 00007f41d4000000 pointer=0x7f41d4000000
using DMA-BUF for GPU buffer address at 0x7f41d4000000 aligned at 0x7f41d4000000 with aligned size 134217728
Calling ibv_reg_dmabuf_mr(offset=0, size=134217728, addr=0x7f41d4000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 8		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0ac8 PSN 0x714c21 OUT 0x10 RKey 0x182f00 VAddr 0x007f41d8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ac9 PSN 0xd679f7 OUT 0x10 RKey 0x182f00 VAddr 0x007f41d8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0aca PSN 0xb5975 OUT 0x10 RKey 0x182f00 VAddr 0x007f41d9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0acb PSN 0x36d420 OUT 0x10 RKey 0x182f00 VAddr 0x007f41d9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0acc PSN 0xdec7b3 OUT 0x10 RKey 0x182f00 VAddr 0x007f41da000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0acd PSN 0xe22e99 OUT 0x10 RKey 0x182f00 VAddr 0x007f41da800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ace PSN 0x210e84 OUT 0x10 RKey 0x182f00 VAddr 0x007f41db000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0acf PSN 0x93022d OUT 0x10 RKey 0x182f00 VAddr 0x007f41db800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0ac8 PSN 0xa3fe5a OUT 0x10 RKey 0x182f00 VAddr 0x007f042e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ac9 PSN 0x17923c OUT 0x10 RKey 0x182f00 VAddr 0x007f042e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0aca PSN 0x2cacd6 OUT 0x10 RKey 0x182f00 VAddr 0x007f042f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0acb PSN 0xbc7a6d OUT 0x10 RKey 0x182f00 VAddr 0x007f042f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0acc PSN 0x2bc47c OUT 0x10 RKey 0x182f00 VAddr 0x007f0430000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0acd PSN 0x12662e OUT 0x10 RKey 0x182f00 VAddr 0x007f0430800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ace PSN 0xf496f5 OUT 0x10 RKey 0x182f00 VAddr 0x007f0431000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0acf PSN 0x65a04a OUT 0x10 RKey 0x182f00 VAddr 0x007f0431800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          8000           0.085302            0.084231            5.264425
 4          8000             0.17               0.17   		     5.163594
 8          8000             0.35               0.33   		     5.191812
 16         8000             0.70               0.66   		     5.185330
 32         8000             1.39               1.33   		     5.179195
 64         8000             2.78               2.66   		     5.205015
 128        8000             5.57               5.55   		     5.422956
 256        8000             11.02              10.54  		     5.147645
 512        8000             22.15              21.97  		     5.363283
 1024       8000             45.62              43.28  		     5.283324
 2048       8000             95.01              87.39  		     5.333919
 4096       8000             189.04             164.74 		     5.027435
 8192       8000             194.53             184.38 		     2.813413
 16384      8000             193.25             192.56 		     1.469103
 32768      8000             209.22             209.19 		     0.798000
 65536      8000             209.41             209.38 		     0.399353
 131072     8000             209.49             209.48 		     0.199772
 262144     8000             209.53             209.52 		     0.099909
 524288     8000             209.56             209.56 		     0.049963
 1048576    8000             209.57             209.57 		     0.024982
 2097152    8000             209.33             209.33 		     0.012477
 4194304    8000             201.81             201.81 		     0.006015
 8388608    8000             171.36             171.31 		     0.002553
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f41d4000000
destroying current CUDA Ctx
