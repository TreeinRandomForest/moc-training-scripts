initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 16408, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007eff40000000 pointer=0x7eff40000000
using DMA-BUF for GPU buffer address at 0x7eff40000000 aligned at 0x7eff40000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7eff40000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x06f0 PSN 0xb20d3a OUT 0x10 RKey 0x183100 VAddr 0x007eff50000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06f1 PSN 0xf1279c OUT 0x10 RKey 0x183100 VAddr 0x007eff50800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06f2 PSN 0x8586b6 OUT 0x10 RKey 0x183100 VAddr 0x007eff51000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06f3 PSN 0xd07ecd OUT 0x10 RKey 0x183100 VAddr 0x007eff51800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06f4 PSN 0x1fe15c OUT 0x10 RKey 0x183100 VAddr 0x007eff52000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06f5 PSN 0x73f18e OUT 0x10 RKey 0x183100 VAddr 0x007eff52800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06f6 PSN 0x352ed5 OUT 0x10 RKey 0x183100 VAddr 0x007eff53000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06f7 PSN 0xd98aaa OUT 0x10 RKey 0x183100 VAddr 0x007eff53800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06f8 PSN 0xbba006 OUT 0x10 RKey 0x183100 VAddr 0x007eff54000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06f9 PSN 0xf70410 OUT 0x10 RKey 0x183100 VAddr 0x007eff54800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06fa PSN 0xa45074 OUT 0x10 RKey 0x183100 VAddr 0x007eff55000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06fb PSN 0x6939f7 OUT 0x10 RKey 0x183100 VAddr 0x007eff55800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06fc PSN 0x9e8617 OUT 0x10 RKey 0x183100 VAddr 0x007eff56000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06fd PSN 0x77ab78 OUT 0x10 RKey 0x183100 VAddr 0x007eff56800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06fe PSN 0x2156d6 OUT 0x10 RKey 0x183100 VAddr 0x007eff57000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x06ff PSN 0xc80ce2 OUT 0x10 RKey 0x183100 VAddr 0x007eff57800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0700 PSN 0x3d034f OUT 0x10 RKey 0x183100 VAddr 0x007eff58000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0701 PSN 0x2afa5d OUT 0x10 RKey 0x183100 VAddr 0x007eff58800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0702 PSN 0xdb6674 OUT 0x10 RKey 0x183100 VAddr 0x007eff59000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0703 PSN 0xa94051 OUT 0x10 RKey 0x183100 VAddr 0x007eff59800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0704 PSN 0x4f81de OUT 0x10 RKey 0x183100 VAddr 0x007eff5a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0705 PSN 0x18bb55 OUT 0x10 RKey 0x183100 VAddr 0x007eff5a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0706 PSN 0xe79895 OUT 0x10 RKey 0x183100 VAddr 0x007eff5b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0707 PSN 0xe98a79 OUT 0x10 RKey 0x183100 VAddr 0x007eff5b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0708 PSN 0xbdc86 OUT 0x10 RKey 0x183100 VAddr 0x007eff5c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0709 PSN 0x747cd9 OUT 0x10 RKey 0x183100 VAddr 0x007eff5c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x070a PSN 0x301686 OUT 0x10 RKey 0x183100 VAddr 0x007eff5d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x070b PSN 0x4bce90 OUT 0x10 RKey 0x183100 VAddr 0x007eff5d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x070c PSN 0x7cd6f OUT 0x10 RKey 0x183100 VAddr 0x007eff5e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x070d PSN 0xc83945 OUT 0x10 RKey 0x183100 VAddr 0x007eff5e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x070e PSN 0x676e77 OUT 0x10 RKey 0x183100 VAddr 0x007eff5f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x070f PSN 0x48199a OUT 0x10 RKey 0x183100 VAddr 0x007eff5f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x06f0 PSN 0xf778cf OUT 0x10 RKey 0x183000 VAddr 0x007fbf10000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06f1 PSN 0xfa4744 OUT 0x10 RKey 0x183000 VAddr 0x007fbf10800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06f2 PSN 0x427e08 OUT 0x10 RKey 0x183000 VAddr 0x007fbf11000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06f3 PSN 0x9b0580 OUT 0x10 RKey 0x183000 VAddr 0x007fbf11800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06f4 PSN 0xda80ca OUT 0x10 RKey 0x183000 VAddr 0x007fbf12000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06f5 PSN 0x18342e OUT 0x10 RKey 0x183000 VAddr 0x007fbf12800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06f6 PSN 0xad9bf OUT 0x10 RKey 0x183000 VAddr 0x007fbf13000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06f7 PSN 0xa31916 OUT 0x10 RKey 0x183000 VAddr 0x007fbf13800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06f8 PSN 0x9bd8cc OUT 0x10 RKey 0x183000 VAddr 0x007fbf14000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06f9 PSN 0x82a127 OUT 0x10 RKey 0x183000 VAddr 0x007fbf14800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06fa PSN 0xe35075 OUT 0x10 RKey 0x183000 VAddr 0x007fbf15000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06fb PSN 0x9f939b OUT 0x10 RKey 0x183000 VAddr 0x007fbf15800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06fc PSN 0x595b5 OUT 0x10 RKey 0x183000 VAddr 0x007fbf16000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06fd PSN 0x92d287 OUT 0x10 RKey 0x183000 VAddr 0x007fbf16800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06fe PSN 0x12e56f OUT 0x10 RKey 0x183000 VAddr 0x007fbf17000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x06ff PSN 0x41ad3d OUT 0x10 RKey 0x183000 VAddr 0x007fbf17800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0700 PSN 0x727f45 OUT 0x10 RKey 0x183000 VAddr 0x007fbf18000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0701 PSN 0xa152e4 OUT 0x10 RKey 0x183000 VAddr 0x007fbf18800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0702 PSN 0xb2d526 OUT 0x10 RKey 0x183000 VAddr 0x007fbf19000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0703 PSN 0x78dae4 OUT 0x10 RKey 0x183000 VAddr 0x007fbf19800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0704 PSN 0x8ed7ab OUT 0x10 RKey 0x183000 VAddr 0x007fbf1a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0705 PSN 0x98e4d5 OUT 0x10 RKey 0x183000 VAddr 0x007fbf1a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0706 PSN 0x4bd0df OUT 0x10 RKey 0x183000 VAddr 0x007fbf1b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0707 PSN 0xe98ac5 OUT 0x10 RKey 0x183000 VAddr 0x007fbf1b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0708 PSN 0xe9d1ac OUT 0x10 RKey 0x183000 VAddr 0x007fbf1c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0709 PSN 0xc78ed1 OUT 0x10 RKey 0x183000 VAddr 0x007fbf1c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x070a PSN 0xdd19e8 OUT 0x10 RKey 0x183000 VAddr 0x007fbf1d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x070b PSN 0xe1d814 OUT 0x10 RKey 0x183000 VAddr 0x007fbf1d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x070c PSN 0xafff6c OUT 0x10 RKey 0x183000 VAddr 0x007fbf1e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x070d PSN 0x14335 OUT 0x10 RKey 0x183000 VAddr 0x007fbf1e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x070e PSN 0x67d670 OUT 0x10 RKey 0x183000 VAddr 0x007fbf1f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x070f PSN 0xe087d6 OUT 0x10 RKey 0x183000 VAddr 0x007fbf1f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.059504            0.059302            3.706393
 4          32000            0.12               0.12   		     3.778085
 8          32000            0.24               0.24   		     3.792233
 16         32000            0.49               0.48   		     3.784564
 32         32000            0.97               0.97   		     3.798806
 64         32000            1.95               1.94   		     3.798648
 128        32000            3.90               3.89   		     3.799803
 256        32000            7.78               7.75   		     3.785226
 512        32000            15.73              15.70  		     3.833961
 1024       32000            31.51              31.46  		     3.840688
 2048       32000            63.89              63.77  		     3.892385
 4096       32000            132.60             131.71 		     4.019580
 8192       32000            197.13             196.98 		     3.005640
 16384      32000            197.79             197.75 		     1.508701
 32768      32000            198.06             198.01 		     0.755360
 65536      32000            198.03             198.01 		     0.377672
 131072     32000            197.98             197.96 		     0.188792
 262144     32000            198.01             198.01 		     0.094417
 524288     32000            198.05             198.05 		     0.047218
 1048576    32000            178.62             178.62 		     0.021293
 2097152    32000            164.02             164.02 		     0.009777
 4194304    32000            163.99             163.99 		     0.004887
 8388608    32000            164.01             164.01 		     0.002444
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007eff40000000
destroying current CUDA Ctx
