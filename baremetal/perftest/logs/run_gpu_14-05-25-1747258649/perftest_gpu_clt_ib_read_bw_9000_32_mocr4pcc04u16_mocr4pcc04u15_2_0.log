initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 26558, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fd840000000 pointer=0x7fd840000000
using DMA-BUF for GPU buffer address at 0x7fd840000000 aligned at 0x7fd840000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fd840000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0e52 PSN 0x339841 OUT 0x10 RKey 0x183000 VAddr 0x007fd850000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e53 PSN 0x75a397 OUT 0x10 RKey 0x183000 VAddr 0x007fd850800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e54 PSN 0xb5d295 OUT 0x10 RKey 0x183000 VAddr 0x007fd851000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e55 PSN 0x1f26c0 OUT 0x10 RKey 0x183000 VAddr 0x007fd851800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e56 PSN 0x85b5d3 OUT 0x10 RKey 0x183000 VAddr 0x007fd852000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e57 PSN 0x665239 OUT 0x10 RKey 0x183000 VAddr 0x007fd852800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e58 PSN 0xe5f9a4 OUT 0x10 RKey 0x183000 VAddr 0x007fd853000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e59 PSN 0x29decd OUT 0x10 RKey 0x183000 VAddr 0x007fd853800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e5a PSN 0xcae4ed OUT 0x10 RKey 0x183000 VAddr 0x007fd854000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e5b PSN 0x52e46b OUT 0x10 RKey 0x183000 VAddr 0x007fd854800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e5c PSN 0x389933 OUT 0x10 RKey 0x183000 VAddr 0x007fd855000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e5d PSN 0xfbcd4a OUT 0x10 RKey 0x183000 VAddr 0x007fd855800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e5e PSN 0xe7d26e OUT 0x10 RKey 0x183000 VAddr 0x007fd856000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e5f PSN 0x775683 OUT 0x10 RKey 0x183000 VAddr 0x007fd856800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e60 PSN 0xcd0c85 OUT 0x10 RKey 0x183000 VAddr 0x007fd857000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e61 PSN 0x73a265 OUT 0x10 RKey 0x183000 VAddr 0x007fd857800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e62 PSN 0x635e16 OUT 0x10 RKey 0x183000 VAddr 0x007fd858000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e63 PSN 0x826b18 OUT 0x10 RKey 0x183000 VAddr 0x007fd858800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e64 PSN 0xc26813 OUT 0x10 RKey 0x183000 VAddr 0x007fd859000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e65 PSN 0xdcb04 OUT 0x10 RKey 0x183000 VAddr 0x007fd859800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e66 PSN 0xbf6215 OUT 0x10 RKey 0x183000 VAddr 0x007fd85a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e67 PSN 0xe09cc0 OUT 0x10 RKey 0x183000 VAddr 0x007fd85a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e68 PSN 0x2cb524 OUT 0x10 RKey 0x183000 VAddr 0x007fd85b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e69 PSN 0xd32d5c OUT 0x10 RKey 0x183000 VAddr 0x007fd85b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e6a PSN 0x22292d OUT 0x10 RKey 0x183000 VAddr 0x007fd85c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e6b PSN 0xc529f4 OUT 0x10 RKey 0x183000 VAddr 0x007fd85c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e6c PSN 0xf40d05 OUT 0x10 RKey 0x183000 VAddr 0x007fd85d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e6d PSN 0x45dca3 OUT 0x10 RKey 0x183000 VAddr 0x007fd85d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e6e PSN 0xa8dd86 OUT 0x10 RKey 0x183000 VAddr 0x007fd85e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e6f PSN 0x4bd10 OUT 0x10 RKey 0x183000 VAddr 0x007fd85e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e70 PSN 0xb7ede6 OUT 0x10 RKey 0x183000 VAddr 0x007fd85f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e71 PSN 0x6015dd OUT 0x10 RKey 0x183000 VAddr 0x007fd85f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0e52 PSN 0x5aee0 OUT 0x10 RKey 0x183100 VAddr 0x007f9d30000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e53 PSN 0x469281 OUT 0x10 RKey 0x183100 VAddr 0x007f9d30800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e54 PSN 0x935501 OUT 0x10 RKey 0x183100 VAddr 0x007f9d31000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e55 PSN 0xb64385 OUT 0x10 RKey 0x183100 VAddr 0x007f9d31800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e56 PSN 0xc866eb OUT 0x10 RKey 0x183100 VAddr 0x007f9d32000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e57 PSN 0x90d63b OUT 0x10 RKey 0x183100 VAddr 0x007f9d32800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e58 PSN 0xfb8748 OUT 0x10 RKey 0x183100 VAddr 0x007f9d33000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e59 PSN 0x52126b OUT 0x10 RKey 0x183100 VAddr 0x007f9d33800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e5a PSN 0x7a5ffd OUT 0x10 RKey 0x183100 VAddr 0x007f9d34000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e5b PSN 0xe43704 OUT 0x10 RKey 0x183100 VAddr 0x007f9d34800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e5c PSN 0xd0ad8e OUT 0x10 RKey 0x183100 VAddr 0x007f9d35000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e5d PSN 0x60ad40 OUT 0x10 RKey 0x183100 VAddr 0x007f9d35800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e5e PSN 0x63bef6 OUT 0x10 RKey 0x183100 VAddr 0x007f9d36000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e5f PSN 0xa6c934 OUT 0x10 RKey 0x183100 VAddr 0x007f9d36800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e60 PSN 0xae5b18 OUT 0x10 RKey 0x183100 VAddr 0x007f9d37000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e61 PSN 0xf49c32 OUT 0x10 RKey 0x183100 VAddr 0x007f9d37800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e62 PSN 0x2e5b96 OUT 0x10 RKey 0x183100 VAddr 0x007f9d38000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e63 PSN 0x3ae761 OUT 0x10 RKey 0x183100 VAddr 0x007f9d38800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e64 PSN 0xbb5c5f OUT 0x10 RKey 0x183100 VAddr 0x007f9d39000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e65 PSN 0x23a429 OUT 0x10 RKey 0x183100 VAddr 0x007f9d39800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e66 PSN 0xb6880c OUT 0x10 RKey 0x183100 VAddr 0x007f9d3a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e67 PSN 0x622422 OUT 0x10 RKey 0x183100 VAddr 0x007f9d3a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e68 PSN 0xd6f2a8 OUT 0x10 RKey 0x183100 VAddr 0x007f9d3b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e69 PSN 0xcd835a OUT 0x10 RKey 0x183100 VAddr 0x007f9d3b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e6a PSN 0xac871d OUT 0x10 RKey 0x183100 VAddr 0x007f9d3c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e6b PSN 0xde55ee OUT 0x10 RKey 0x183100 VAddr 0x007f9d3c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e6c PSN 0x2fef41 OUT 0x10 RKey 0x183100 VAddr 0x007f9d3d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e6d PSN 0xe0a4f9 OUT 0x10 RKey 0x183100 VAddr 0x007f9d3d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e6e PSN 0x5efaed OUT 0x10 RKey 0x183100 VAddr 0x007f9d3e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e6f PSN 0x643f22 OUT 0x10 RKey 0x183100 VAddr 0x007f9d3e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e70 PSN 0x600859 OUT 0x10 RKey 0x183100 VAddr 0x007f9d3f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e71 PSN 0x311e0b OUT 0x10 RKey 0x183100 VAddr 0x007f9d3f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.080178            0.079075            4.942192
 4          32000            0.17               0.16   		     5.143446
 8          32000            0.33               0.33   		     5.145249
 16         32000            0.66               0.66   		     5.126907
 32         32000            1.32               1.32   		     5.142058
 64         32000            2.64               2.63   		     5.139250
 128        32000            5.27               5.25   		     5.123853
 256        32000            10.52              10.49  		     5.120609
 512        32000            21.04              20.98  		     5.121188
 1024       32000            42.08              41.84  		     5.106812
 2048       32000            81.38              71.70  		     4.376368
 4096       32000            165.31             100.84 		     3.077533
 8192       32000            183.63             136.71 		     2.086074
 16384      32000            197.00             196.96 		     1.502702
 32768      32000            191.25             178.02 		     0.679101
 65536      32000            197.86             197.86 		     0.377381
 131072     32000            197.99             197.98 		     0.188810
 262144     32000            197.76             197.76 		     0.094299
 524288     32000            196.50             196.50 		     0.046849
 1048576    32000            178.59             178.59 		     0.021290
 2097152    32000            163.89             163.89 		     0.009768
 4194304    32000            163.83             163.82 		     0.004882
 8388608    32000            163.76             163.76 		     0.002440
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fd840000000
destroying current CUDA Ctx
