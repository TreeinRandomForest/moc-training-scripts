initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 20819, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007ff720000000 pointer=0x7ff720000000
using DMA-BUF for GPU buffer address at 0x7ff720000000 aligned at 0x7ff720000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7ff720000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0a52 PSN 0x3e167b OUT 0x10 RKey 0x182f00 VAddr 0x007ff728000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a53 PSN 0x43f180 OUT 0x10 RKey 0x182f00 VAddr 0x007ff728800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a54 PSN 0xe1e194 OUT 0x10 RKey 0x182f00 VAddr 0x007ff729000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a55 PSN 0xf8301c OUT 0x10 RKey 0x182f00 VAddr 0x007ff729800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a56 PSN 0x9dcd36 OUT 0x10 RKey 0x182f00 VAddr 0x007ff72a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a57 PSN 0x78c62a OUT 0x10 RKey 0x182f00 VAddr 0x007ff72a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a58 PSN 0xa16a0b OUT 0x10 RKey 0x182f00 VAddr 0x007ff72b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a59 PSN 0x72d172 OUT 0x10 RKey 0x182f00 VAddr 0x007ff72b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a5a PSN 0x7ffff8 OUT 0x10 RKey 0x182f00 VAddr 0x007ff72c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a5b PSN 0x68d6e3 OUT 0x10 RKey 0x182f00 VAddr 0x007ff72c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a5c PSN 0x7f1981 OUT 0x10 RKey 0x182f00 VAddr 0x007ff72d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a5d PSN 0xa4f5b7 OUT 0x10 RKey 0x182f00 VAddr 0x007ff72d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a5e PSN 0x4583a1 OUT 0x10 RKey 0x182f00 VAddr 0x007ff72e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a5f PSN 0x1d2803 OUT 0x10 RKey 0x182f00 VAddr 0x007ff72e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a60 PSN 0x16b33b OUT 0x10 RKey 0x182f00 VAddr 0x007ff72f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0a61 PSN 0xd59519 OUT 0x10 RKey 0x182f00 VAddr 0x007ff72f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0a52 PSN 0x6fdf22 OUT 0x10 RKey 0x183000 VAddr 0x007fbcae000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a53 PSN 0xb06a9b OUT 0x10 RKey 0x183000 VAddr 0x007fbcae800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a54 PSN 0xc3b413 OUT 0x10 RKey 0x183000 VAddr 0x007fbcaf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a55 PSN 0x50ea2f OUT 0x10 RKey 0x183000 VAddr 0x007fbcaf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a56 PSN 0x16194d OUT 0x10 RKey 0x183000 VAddr 0x007fbcb0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a57 PSN 0x41d5f5 OUT 0x10 RKey 0x183000 VAddr 0x007fbcb0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a58 PSN 0x91857a OUT 0x10 RKey 0x183000 VAddr 0x007fbcb1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a59 PSN 0xa839b5 OUT 0x10 RKey 0x183000 VAddr 0x007fbcb1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a5a PSN 0xad967f OUT 0x10 RKey 0x183000 VAddr 0x007fbcb2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a5b PSN 0x83385e OUT 0x10 RKey 0x183000 VAddr 0x007fbcb2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a5c PSN 0xb31ce0 OUT 0x10 RKey 0x183000 VAddr 0x007fbcb3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a5d PSN 0x65bf2a OUT 0x10 RKey 0x183000 VAddr 0x007fbcb3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a5e PSN 0x5c9b98 OUT 0x10 RKey 0x183000 VAddr 0x007fbcb4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a5f PSN 0x2e462e OUT 0x10 RKey 0x183000 VAddr 0x007fbcb4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a60 PSN 0x1f2d8a OUT 0x10 RKey 0x183000 VAddr 0x007fbcb5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0a61 PSN 0x28a2bc OUT 0x10 RKey 0x183000 VAddr 0x007fbcb5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.080357            0.079938            4.996112
 4          16000            0.16               0.16   		     5.085597
 8          16000            0.33               0.32   		     5.066418
 16         16000            0.65               0.65   		     5.083916
 32         16000            1.30               1.29   		     5.045743
 64         16000            2.61               2.59   		     5.064189
 128        16000            5.19               5.17   		     5.048879
 256        16000            10.38              10.34  		     5.048991
 512        16000            20.76              20.68  		     5.049071
 1024       16000            41.33              41.21  		     5.030181
 2048       16000            81.20              80.42  		     4.908472
 4096       16000            163.12             162.79 		     4.968064
 8192       16000            186.42             186.23 		     2.841666
 16384      16000            209.01             208.93 		     1.594011
 32768      16000            209.31             209.25 		     0.798224
 65536      16000            209.38             209.35 		     0.399303
 131072     16000            209.42             209.40 		     0.199701
 262144     16000            208.79             208.78 		     0.099556
 524288     16000            209.25             209.24 		     0.049887
 1048576    16000            209.34             209.34 		     0.024955
 2097152    16000            194.69             194.60 		     0.011599
 4194304    16000            171.18             171.18 		     0.005102
 8388608    16000            171.09             171.09 		     0.002549
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007ff720000000
destroying current CUDA Ctx
