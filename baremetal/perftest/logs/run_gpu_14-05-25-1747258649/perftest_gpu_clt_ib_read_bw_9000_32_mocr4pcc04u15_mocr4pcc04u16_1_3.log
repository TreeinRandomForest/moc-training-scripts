initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 15027, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007ff700000000 pointer=0x7ff700000000
using DMA-BUF for GPU buffer address at 0x7ff700000000 aligned at 0x7ff700000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7ff700000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x05f4 PSN 0x9848d9 OUT 0x10 RKey 0x183100 VAddr 0x007ff710000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x05f5 PSN 0x1d644f OUT 0x10 RKey 0x183100 VAddr 0x007ff710800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x05f6 PSN 0xe830ed OUT 0x10 RKey 0x183100 VAddr 0x007ff711000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x05f7 PSN 0x746238 OUT 0x10 RKey 0x183100 VAddr 0x007ff711800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x05f8 PSN 0xddd7eb OUT 0x10 RKey 0x183100 VAddr 0x007ff712000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x05f9 PSN 0xae6671 OUT 0x10 RKey 0x183100 VAddr 0x007ff712800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x05fa PSN 0x60e57c OUT 0x10 RKey 0x183100 VAddr 0x007ff713000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x05fb PSN 0x8459c5 OUT 0x10 RKey 0x183100 VAddr 0x007ff713800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x05fc PSN 0x6c1085 OUT 0x10 RKey 0x183100 VAddr 0x007ff714000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x05fd PSN 0x3d0423 OUT 0x10 RKey 0x183100 VAddr 0x007ff714800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x05fe PSN 0x76a8b OUT 0x10 RKey 0x183100 VAddr 0x007ff715000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x05ff PSN 0x3fffc2 OUT 0x10 RKey 0x183100 VAddr 0x007ff715800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0600 PSN 0xe91f86 OUT 0x10 RKey 0x183100 VAddr 0x007ff716000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0601 PSN 0x68b9bb OUT 0x10 RKey 0x183100 VAddr 0x007ff716800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0602 PSN 0x589b5d OUT 0x10 RKey 0x183100 VAddr 0x007ff717000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0603 PSN 0x55845d OUT 0x10 RKey 0x183100 VAddr 0x007ff717800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0604 PSN 0x3564ae OUT 0x10 RKey 0x183100 VAddr 0x007ff718000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0605 PSN 0xfbc9d0 OUT 0x10 RKey 0x183100 VAddr 0x007ff718800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0606 PSN 0x290c6b OUT 0x10 RKey 0x183100 VAddr 0x007ff719000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0607 PSN 0x88d47c OUT 0x10 RKey 0x183100 VAddr 0x007ff719800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0608 PSN 0x443a2d OUT 0x10 RKey 0x183100 VAddr 0x007ff71a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0609 PSN 0xb62ef8 OUT 0x10 RKey 0x183100 VAddr 0x007ff71a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x060a PSN 0x1a46fc OUT 0x10 RKey 0x183100 VAddr 0x007ff71b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x060b PSN 0x225654 OUT 0x10 RKey 0x183100 VAddr 0x007ff71b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x060c PSN 0x456ac5 OUT 0x10 RKey 0x183100 VAddr 0x007ff71c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x060d PSN 0xd6a7ac OUT 0x10 RKey 0x183100 VAddr 0x007ff71c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x060e PSN 0xf9e45d OUT 0x10 RKey 0x183100 VAddr 0x007ff71d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x060f PSN 0x5b9d1b OUT 0x10 RKey 0x183100 VAddr 0x007ff71d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0610 PSN 0x77a09e OUT 0x10 RKey 0x183100 VAddr 0x007ff71e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0611 PSN 0x755e48 OUT 0x10 RKey 0x183100 VAddr 0x007ff71e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0612 PSN 0x24e2be OUT 0x10 RKey 0x183100 VAddr 0x007ff71f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0613 PSN 0xde65d5 OUT 0x10 RKey 0x183100 VAddr 0x007ff71f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x05f4 PSN 0xdcb357 OUT 0x10 RKey 0x183000 VAddr 0x007efe70000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x05f5 PSN 0x13eff5 OUT 0x10 RKey 0x183000 VAddr 0x007efe70800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x05f6 PSN 0x60ca9b OUT 0x10 RKey 0x183000 VAddr 0x007efe71000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x05f7 PSN 0x48254e OUT 0x10 RKey 0x183000 VAddr 0x007efe71800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x05f8 PSN 0x95ac49 OUT 0x10 RKey 0x183000 VAddr 0x007efe72000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x05f9 PSN 0x684677 OUT 0x10 RKey 0x183000 VAddr 0x007efe72800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x05fa PSN 0x52ac0a OUT 0x10 RKey 0x183000 VAddr 0x007efe73000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x05fb PSN 0xc1783b OUT 0x10 RKey 0x183000 VAddr 0x007efe73800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x05fc PSN 0x980cc3 OUT 0x10 RKey 0x183000 VAddr 0x007efe74000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x05fd PSN 0xbf1e89 OUT 0x10 RKey 0x183000 VAddr 0x007efe74800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x05fe PSN 0x2c4bf9 OUT 0x10 RKey 0x183000 VAddr 0x007efe75000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x05ff PSN 0xe4cf98 OUT 0x10 RKey 0x183000 VAddr 0x007efe75800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0600 PSN 0x17e1a4 OUT 0x10 RKey 0x183000 VAddr 0x007efe76000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0601 PSN 0x605481 OUT 0x10 RKey 0x183000 VAddr 0x007efe76800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0602 PSN 0x5b65ab OUT 0x10 RKey 0x183000 VAddr 0x007efe77000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0603 PSN 0x2fbb93 OUT 0x10 RKey 0x183000 VAddr 0x007efe77800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0604 PSN 0x816aac OUT 0x10 RKey 0x183000 VAddr 0x007efe78000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0605 PSN 0xe48af6 OUT 0x10 RKey 0x183000 VAddr 0x007efe78800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0606 PSN 0xd36d99 OUT 0x10 RKey 0x183000 VAddr 0x007efe79000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0607 PSN 0xcb8912 OUT 0x10 RKey 0x183000 VAddr 0x007efe79800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0608 PSN 0x31e20b OUT 0x10 RKey 0x183000 VAddr 0x007efe7a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0609 PSN 0x601c7e OUT 0x10 RKey 0x183000 VAddr 0x007efe7a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x060a PSN 0x62cd0a OUT 0x10 RKey 0x183000 VAddr 0x007efe7b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x060b PSN 0x5bfe4a OUT 0x10 RKey 0x183000 VAddr 0x007efe7b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x060c PSN 0x80f283 OUT 0x10 RKey 0x183000 VAddr 0x007efe7c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x060d PSN 0x4c2792 OUT 0x10 RKey 0x183000 VAddr 0x007efe7c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x060e PSN 0xf1fd4b OUT 0x10 RKey 0x183000 VAddr 0x007efe7d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x060f PSN 0xcc0e71 OUT 0x10 RKey 0x183000 VAddr 0x007efe7d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0610 PSN 0x73263c OUT 0x10 RKey 0x183000 VAddr 0x007efe7e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0611 PSN 0x41368e OUT 0x10 RKey 0x183000 VAddr 0x007efe7e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0612 PSN 0xc6dc8c OUT 0x10 RKey 0x183000 VAddr 0x007efe7f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0613 PSN 0x2cd68b OUT 0x10 RKey 0x183000 VAddr 0x007efe7f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.077088            0.076691            4.793175
 4          32000            0.16               0.16   		     4.952947
 8          32000            0.32               0.32   		     4.955463
 16         32000            0.64               0.63   		     4.953514
 32         32000            1.27               1.27   		     4.955762
 64         32000            2.54               2.54   		     4.956461
 128        32000            5.07               5.06   		     4.942909
 256        32000            10.15              10.11  		     4.938112
 512        32000            20.30              20.23  		     4.939872
 1024       32000            40.51              40.42  		     4.933543
 2048       32000            79.11              78.56  		     4.794812
 4096       32000            162.04             161.69 		     4.934517
 8192       32000            202.27             202.06 		     3.083253
 16384      32000            202.55             202.52 		     1.545105
 32768      32000            202.76             202.70 		     0.773237
 65536      32000            202.65             202.63 		     0.386486
 131072     32000            202.74             202.73 		     0.193336
 262144     32000            202.78             202.78 		     0.096693
 524288     32000            202.80             202.79 		     0.048350
 1048576    32000            184.17             184.17 		     0.021955
 2097152    32000            170.17             170.17 		     0.010143
 4194304    32000            170.13             170.13 		     0.005070
 8388608    32000            170.15             170.15 		     0.002535
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007ff700000000
destroying current CUDA Ctx
