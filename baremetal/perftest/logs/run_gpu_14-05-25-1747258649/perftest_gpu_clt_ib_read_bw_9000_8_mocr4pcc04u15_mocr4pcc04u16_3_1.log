initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 19545, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 134217728 bytes GPU buffer
allocated GPU buffer address at 00007fa53c000000 pointer=0x7fa53c000000
using DMA-BUF for GPU buffer address at 0x7fa53c000000 aligned at 0x7fa53c000000 with aligned size 134217728
Calling ibv_reg_dmabuf_mr(offset=0, size=134217728, addr=0x7fa53c000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 8		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x08d0 PSN 0x4a2967 OUT 0x10 RKey 0x182f00 VAddr 0x007fa540000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08d1 PSN 0x8194c5 OUT 0x10 RKey 0x182f00 VAddr 0x007fa540800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08d2 PSN 0xe2d72b OUT 0x10 RKey 0x182f00 VAddr 0x007fa541000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08d3 PSN 0xb0de9e OUT 0x10 RKey 0x182f00 VAddr 0x007fa541800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08d4 PSN 0x6a7359 OUT 0x10 RKey 0x182f00 VAddr 0x007fa542000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08d5 PSN 0x996847 OUT 0x10 RKey 0x182f00 VAddr 0x007fa542800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08d6 PSN 0x5ef19a OUT 0x10 RKey 0x182f00 VAddr 0x007fa543000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08d7 PSN 0x3a768b OUT 0x10 RKey 0x182f00 VAddr 0x007fa543800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x08d0 PSN 0x845851 OUT 0x10 RKey 0x182f00 VAddr 0x007f5ae0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08d1 PSN 0x25ca67 OUT 0x10 RKey 0x182f00 VAddr 0x007f5ae0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08d2 PSN 0x553925 OUT 0x10 RKey 0x182f00 VAddr 0x007f5ae1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08d3 PSN 0xe33210 OUT 0x10 RKey 0x182f00 VAddr 0x007f5ae1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08d4 PSN 0xe866e3 OUT 0x10 RKey 0x182f00 VAddr 0x007f5ae2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08d5 PSN 0x401609 OUT 0x10 RKey 0x182f00 VAddr 0x007f5ae2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08d6 PSN 0x4b3934 OUT 0x10 RKey 0x182f00 VAddr 0x007f5ae3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08d7 PSN 0x214f1d OUT 0x10 RKey 0x182f00 VAddr 0x007f5ae3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          8000           0.085511            0.084415            5.275965
 4          8000             0.17               0.17   		     5.353104
 8          8000             0.35               0.35   		     5.398585
 16         8000             0.70               0.69   		     5.402668
 32         8000             1.39               1.38   		     5.407963
 64         8000             2.77               2.76   		     5.395547
 128        8000             5.54               5.52   		     5.391888
 256        8000             11.08              10.99  		     5.366643
 512        8000             22.10              22.07  		     5.386988
 1024       8000             45.18              45.08  		     5.502896
 2048       8000             94.52              93.52  		     5.708088
 4096       8000             185.71             184.53 		     5.631304
 8192       8000             195.05             194.90 		     2.973956
 16384      8000             196.87             196.76 		     1.501163
 32768      8000             197.20             197.17 		     0.752142
 65536      8000             197.46             197.44 		     0.376591
 131072     8000             197.45             197.44 		     0.188294
 262144     8000             197.51             197.51 		     0.094180
 524288     8000             197.59             197.59 		     0.047109
 1048576    8000             197.55             197.55 		     0.023550
 2097152    8000             197.53             197.53 		     0.011773
 4194304    8000             193.33             193.33 		     0.005762
 8388608    8000             163.55             163.55 		     0.002437
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fa53c000000
destroying current CUDA Ctx
