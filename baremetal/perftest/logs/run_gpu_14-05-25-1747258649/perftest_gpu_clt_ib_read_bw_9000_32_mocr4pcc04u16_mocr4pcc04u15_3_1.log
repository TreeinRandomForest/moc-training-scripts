initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 30194, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f5f60000000 pointer=0x7f5f60000000
using DMA-BUF for GPU buffer address at 0x7f5f60000000 aligned at 0x7f5f60000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f5f60000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x10c8 PSN 0x38416e OUT 0x10 RKey 0x183000 VAddr 0x007f5f70000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10c9 PSN 0xec19c0 OUT 0x10 RKey 0x183000 VAddr 0x007f5f70800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10ca PSN 0x1af80a OUT 0x10 RKey 0x183000 VAddr 0x007f5f71000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10cb PSN 0xb33791 OUT 0x10 RKey 0x183000 VAddr 0x007f5f71800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10cc PSN 0x58a4d0 OUT 0x10 RKey 0x183000 VAddr 0x007f5f72000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10cd PSN 0x2961f2 OUT 0x10 RKey 0x183000 VAddr 0x007f5f72800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10ce PSN 0x9fe169 OUT 0x10 RKey 0x183000 VAddr 0x007f5f73000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10cf PSN 0x288bae OUT 0x10 RKey 0x183000 VAddr 0x007f5f73800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10d0 PSN 0xf8a6ba OUT 0x10 RKey 0x183000 VAddr 0x007f5f74000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10d1 PSN 0xe896b4 OUT 0x10 RKey 0x183000 VAddr 0x007f5f74800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10d2 PSN 0x6f1848 OUT 0x10 RKey 0x183000 VAddr 0x007f5f75000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10d3 PSN 0xb8c73b OUT 0x10 RKey 0x183000 VAddr 0x007f5f75800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10d4 PSN 0x18c40b OUT 0x10 RKey 0x183000 VAddr 0x007f5f76000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10d5 PSN 0x1d445c OUT 0x10 RKey 0x183000 VAddr 0x007f5f76800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10d6 PSN 0x3047ea OUT 0x10 RKey 0x183000 VAddr 0x007f5f77000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10d7 PSN 0x2caa66 OUT 0x10 RKey 0x183000 VAddr 0x007f5f77800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10d8 PSN 0x48ac83 OUT 0x10 RKey 0x183000 VAddr 0x007f5f78000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10d9 PSN 0x16bd81 OUT 0x10 RKey 0x183000 VAddr 0x007f5f78800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10da PSN 0xbfd4c8 OUT 0x10 RKey 0x183000 VAddr 0x007f5f79000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10db PSN 0x7bb215 OUT 0x10 RKey 0x183000 VAddr 0x007f5f79800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10dc PSN 0xd00a52 OUT 0x10 RKey 0x183000 VAddr 0x007f5f7a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10dd PSN 0x5b0cb9 OUT 0x10 RKey 0x183000 VAddr 0x007f5f7a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10de PSN 0x741829 OUT 0x10 RKey 0x183000 VAddr 0x007f5f7b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10df PSN 0xcad47d OUT 0x10 RKey 0x183000 VAddr 0x007f5f7b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10e0 PSN 0x27f83a OUT 0x10 RKey 0x183000 VAddr 0x007f5f7c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10e1 PSN 0x40007d OUT 0x10 RKey 0x183000 VAddr 0x007f5f7c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10e2 PSN 0x4c7b5a OUT 0x10 RKey 0x183000 VAddr 0x007f5f7d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10e3 PSN 0x6934d4 OUT 0x10 RKey 0x183000 VAddr 0x007f5f7d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10e4 PSN 0x1d7063 OUT 0x10 RKey 0x183000 VAddr 0x007f5f7e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10e5 PSN 0x55d329 OUT 0x10 RKey 0x183000 VAddr 0x007f5f7e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10e6 PSN 0x24cc8b OUT 0x10 RKey 0x183000 VAddr 0x007f5f7f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x10e7 PSN 0xdf201e OUT 0x10 RKey 0x183000 VAddr 0x007f5f7f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x10c8 PSN 0x60b16e OUT 0x10 RKey 0x183100 VAddr 0x007fe1f0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10c9 PSN 0xc3c9c0 OUT 0x10 RKey 0x183100 VAddr 0x007fe1f0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10ca PSN 0x10e80a OUT 0x10 RKey 0x183100 VAddr 0x007fe1f1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10cb PSN 0xa6791 OUT 0x10 RKey 0x183100 VAddr 0x007fe1f1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10cc PSN 0x9814d0 OUT 0x10 RKey 0x183100 VAddr 0x007fe1f2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10cd PSN 0xcc11f2 OUT 0x10 RKey 0x183100 VAddr 0x007fe1f2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10ce PSN 0x4d169 OUT 0x10 RKey 0x183100 VAddr 0x007fe1f3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10cf PSN 0xc2bbae OUT 0x10 RKey 0x183100 VAddr 0x007fe1f3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10d0 PSN 0xbf16ba OUT 0x10 RKey 0x183100 VAddr 0x007fe1f4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10d1 PSN 0x646b4 OUT 0x10 RKey 0x183100 VAddr 0x007fe1f4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10d2 PSN 0x330848 OUT 0x10 RKey 0x183100 VAddr 0x007fe1f5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10d3 PSN 0xc5f73b OUT 0x10 RKey 0x183100 VAddr 0x007fe1f5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10d4 PSN 0xd6340b OUT 0x10 RKey 0x183100 VAddr 0x007fe1f6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10d5 PSN 0x65f45c OUT 0x10 RKey 0x183100 VAddr 0x007fe1f6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10d6 PSN 0x4337ea OUT 0x10 RKey 0x183100 VAddr 0x007fe1f7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10d7 PSN 0xdcda66 OUT 0x10 RKey 0x183100 VAddr 0x007fe1f7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10d8 PSN 0x6d1c83 OUT 0x10 RKey 0x183100 VAddr 0x007fe1f8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10d9 PSN 0x3a6d81 OUT 0x10 RKey 0x183100 VAddr 0x007fe1f8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10da PSN 0x11c4c8 OUT 0x10 RKey 0x183100 VAddr 0x007fe1f9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10db PSN 0xfee215 OUT 0x10 RKey 0x183100 VAddr 0x007fe1f9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10dc PSN 0xcb7a52 OUT 0x10 RKey 0x183100 VAddr 0x007fe1fa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10dd PSN 0x9bcb9 OUT 0x10 RKey 0x183100 VAddr 0x007fe1fa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10de PSN 0xf50829 OUT 0x10 RKey 0x183100 VAddr 0x007fe1fb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10df PSN 0x51047d OUT 0x10 RKey 0x183100 VAddr 0x007fe1fb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10e0 PSN 0x6a683a OUT 0x10 RKey 0x183100 VAddr 0x007fe1fc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10e1 PSN 0x29b07d OUT 0x10 RKey 0x183100 VAddr 0x007fe1fc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10e2 PSN 0xec6b5a OUT 0x10 RKey 0x183100 VAddr 0x007fe1fd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10e3 PSN 0x2264d4 OUT 0x10 RKey 0x183100 VAddr 0x007fe1fd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10e4 PSN 0x16e063 OUT 0x10 RKey 0x183100 VAddr 0x007fe1fe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10e5 PSN 0x2a8329 OUT 0x10 RKey 0x183100 VAddr 0x007fe1fe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10e6 PSN 0xd3bc8b OUT 0x10 RKey 0x183100 VAddr 0x007fe1ff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x10e7 PSN 0xfb501e OUT 0x10 RKey 0x183100 VAddr 0x007fe1ff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.085714            0.085291            5.330686
 4          32000            0.18               0.18   		     5.500976
 8          32000            0.35               0.35   		     5.489350
 16         32000            0.71               0.70   		     5.494232
 32         32000            1.41               1.41   		     5.495092
 64         32000            2.82               2.81   		     5.486326
 128        32000            5.61               5.58   		     5.448121
 256        32000            11.24              11.18  		     5.459342
 512        32000            22.42              22.35  		     5.456522
 1024       32000            46.43              46.33  		     5.655265
 2048       32000            96.25              84.53  		     5.159393
 4096       32000            190.51             189.78 		     5.791528
 8192       32000            193.51             193.33 		     2.949982
 16384      32000            188.31             160.71 		     1.226124
 32768      32000            190.32             177.36 		     0.676589
 65536      32000            190.54             186.46 		     0.355642
 131072     32000            191.89             191.88 		     0.182992
 262144     32000            197.40             197.40 		     0.094126
 524288     32000            197.40             197.40 		     0.047063
 1048576    32000            177.67             177.67 		     0.021180
 2097152    32000            163.26             163.26 		     0.009731
 4194304    32000            163.39             163.38 		     0.004869
 8388608    32000            163.40             163.40 		     0.002435
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f5f60000000
destroying current CUDA Ctx
