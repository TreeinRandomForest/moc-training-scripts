initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 22927, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fade0000000 pointer=0x7fade0000000
using DMA-BUF for GPU buffer address at 0x7fade0000000 aligned at 0x7fade0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fade0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0bdc PSN 0x2129f7 OUT 0x10 RKey 0x183000 VAddr 0x007fadf0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bdd PSN 0x4e3215 OUT 0x10 RKey 0x183000 VAddr 0x007fadf0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bde PSN 0x17b23b OUT 0x10 RKey 0x183000 VAddr 0x007fadf1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bdf PSN 0xc2846e OUT 0x10 RKey 0x183000 VAddr 0x007fadf1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0be0 PSN 0xa6ece9 OUT 0x10 RKey 0x183000 VAddr 0x007fadf2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0be1 PSN 0x508a97 OUT 0x10 RKey 0x183000 VAddr 0x007fadf2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0be2 PSN 0xec6daa OUT 0x10 RKey 0x183000 VAddr 0x007fadf3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0be3 PSN 0xaea95b OUT 0x10 RKey 0x183000 VAddr 0x007fadf3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0be4 PSN 0x38b763 OUT 0x10 RKey 0x183000 VAddr 0x007fadf4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0be5 PSN 0xf384a9 OUT 0x10 RKey 0x183000 VAddr 0x007fadf4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0be6 PSN 0xbc8799 OUT 0x10 RKey 0x183000 VAddr 0x007fadf5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0be7 PSN 0x5ff2b8 OUT 0x10 RKey 0x183000 VAddr 0x007fadf5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0be8 PSN 0x949644 OUT 0x10 RKey 0x183000 VAddr 0x007fadf6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0be9 PSN 0x40fca1 OUT 0x10 RKey 0x183000 VAddr 0x007fadf6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bea PSN 0x8fbb4b OUT 0x10 RKey 0x183000 VAddr 0x007fadf7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0beb PSN 0xe5f0b3 OUT 0x10 RKey 0x183000 VAddr 0x007fadf7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bec PSN 0x50c94c OUT 0x10 RKey 0x183000 VAddr 0x007fadf8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bed PSN 0xb39516 OUT 0x10 RKey 0x183000 VAddr 0x007fadf8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bee PSN 0x937d39 OUT 0x10 RKey 0x183000 VAddr 0x007fadf9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bef PSN 0x1bf032 OUT 0x10 RKey 0x183000 VAddr 0x007fadf9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bf0 PSN 0x948aab OUT 0x10 RKey 0x183000 VAddr 0x007fadfa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bf1 PSN 0x61a89e OUT 0x10 RKey 0x183000 VAddr 0x007fadfa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bf2 PSN 0x7036aa OUT 0x10 RKey 0x183000 VAddr 0x007fadfb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bf3 PSN 0x77b76a OUT 0x10 RKey 0x183000 VAddr 0x007fadfb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bf4 PSN 0x218523 OUT 0x10 RKey 0x183000 VAddr 0x007fadfc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bf5 PSN 0xe655b2 OUT 0x10 RKey 0x183000 VAddr 0x007fadfc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bf6 PSN 0x8860eb OUT 0x10 RKey 0x183000 VAddr 0x007fadfd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bf7 PSN 0xd63991 OUT 0x10 RKey 0x183000 VAddr 0x007fadfd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bf8 PSN 0x642dc OUT 0x10 RKey 0x183000 VAddr 0x007fadfe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bf9 PSN 0x1c26ae OUT 0x10 RKey 0x183000 VAddr 0x007fadfe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bfa PSN 0x3bda2c OUT 0x10 RKey 0x183000 VAddr 0x007fadff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bfb PSN 0x5a93ab OUT 0x10 RKey 0x183000 VAddr 0x007fadff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0bdc PSN 0x5f28b0 OUT 0x10 RKey 0x183100 VAddr 0x007f9330000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bdd PSN 0x19dcda OUT 0x10 RKey 0x183100 VAddr 0x007f9330800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bde PSN 0xd8661c OUT 0x10 RKey 0x183100 VAddr 0x007f9331000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bdf PSN 0xd7413b OUT 0x10 RKey 0x183100 VAddr 0x007f9331800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0be0 PSN 0x177e32 OUT 0x10 RKey 0x183100 VAddr 0x007f9332000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0be1 PSN 0x11fcac OUT 0x10 RKey 0x183100 VAddr 0x007f9332800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0be2 PSN 0x24de9b OUT 0x10 RKey 0x183100 VAddr 0x007f9333000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0be3 PSN 0x5b45f8 OUT 0x10 RKey 0x183100 VAddr 0x007f9333800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0be4 PSN 0x28743c OUT 0x10 RKey 0x183100 VAddr 0x007f9334000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0be5 PSN 0xbde30e OUT 0x10 RKey 0x183100 VAddr 0x007f9334800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0be6 PSN 0xd1769a OUT 0x10 RKey 0x183100 VAddr 0x007f9335000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0be7 PSN 0xf09c25 OUT 0x10 RKey 0x183100 VAddr 0x007f9335800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0be8 PSN 0xe0a7ad OUT 0x10 RKey 0x183100 VAddr 0x007f9336000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0be9 PSN 0x14bc56 OUT 0x10 RKey 0x183100 VAddr 0x007f9336800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bea PSN 0xd0f95c OUT 0x10 RKey 0x183100 VAddr 0x007f9337000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0beb PSN 0x1ca3f0 OUT 0x10 RKey 0x183100 VAddr 0x007f9337800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bec PSN 0xdfe845 OUT 0x10 RKey 0x183100 VAddr 0x007f9338000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bed PSN 0x37b1b OUT 0x10 RKey 0x183100 VAddr 0x007f9338800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bee PSN 0xdceb5a OUT 0x10 RKey 0x183100 VAddr 0x007f9339000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bef PSN 0xbd7a3f OUT 0x10 RKey 0x183100 VAddr 0x007f9339800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bf0 PSN 0x600034 OUT 0x10 RKey 0x183100 VAddr 0x007f933a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bf1 PSN 0xe7c9f3 OUT 0x10 RKey 0x183100 VAddr 0x007f933a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bf2 PSN 0xdac5db OUT 0x10 RKey 0x183100 VAddr 0x007f933b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bf3 PSN 0xa8b547 OUT 0x10 RKey 0x183100 VAddr 0x007f933b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bf4 PSN 0xce2a3c OUT 0x10 RKey 0x183100 VAddr 0x007f933c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bf5 PSN 0xc91757 OUT 0x10 RKey 0x183100 VAddr 0x007f933c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bf6 PSN 0x2b122c OUT 0x10 RKey 0x183100 VAddr 0x007f933d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bf7 PSN 0x48183e OUT 0x10 RKey 0x183100 VAddr 0x007f933d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bf8 PSN 0xd8085 OUT 0x10 RKey 0x183100 VAddr 0x007f933e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bf9 PSN 0x633da3 OUT 0x10 RKey 0x183100 VAddr 0x007f933e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bfa PSN 0xfcbe7d OUT 0x10 RKey 0x183100 VAddr 0x007f933f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bfb PSN 0x489028 OUT 0x10 RKey 0x183100 VAddr 0x007f933f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.057785            0.057044            3.565277
 4          32000            0.12               0.12   		     3.666596
 8          32000            0.23               0.23   		     3.660385
 16         32000            0.47               0.47   		     3.679827
 32         32000            0.94               0.94   		     3.671422
 64         32000            1.89               1.88   		     3.665647
 128        32000            3.75               3.74   		     3.652414
 256        32000            7.52               7.49   		     3.655701
 512        32000            14.99              14.95  		     3.650913
 1024       32000            29.92              29.84  		     3.643103
 2048       32000            59.75              59.69  		     3.643261
 4096       32000            120.27             120.04 		     3.663259
 8192       32000            204.52             204.25 		     3.116609
 16384      32000            206.81             206.76 		     1.577460
 32768      32000            206.16             206.09 		     0.786169
 65536      32000            206.77             206.77 		     0.394377
 131072     32000            208.12             208.11 		     0.198471
 262144     32000            208.61             208.61 		     0.099471
 524288     32000            209.06             209.05 		     0.049842
 1048576    32000            186.99             186.99 		     0.022291
 2097152    32000            171.23             171.23 		     0.010206
 4194304    32000            171.22             171.22 		     0.005103
 8388608    32000            171.21             171.21 		     0.002551
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fade0000000
destroying current CUDA Ctx
