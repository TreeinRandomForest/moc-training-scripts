initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 22871, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f8674000000 pointer=0x7f8674000000
using DMA-BUF for GPU buffer address at 0x7f8674000000 aligned at 0x7f8674000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f8674000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0bcc PSN 0x2b537a OUT 0x10 RKey 0x182f00 VAddr 0x007f867c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bcd PSN 0x280413 OUT 0x10 RKey 0x182f00 VAddr 0x007f867c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bce PSN 0x31dc2b OUT 0x10 RKey 0x182f00 VAddr 0x007f867d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bcf PSN 0x5d8c67 OUT 0x10 RKey 0x182f00 VAddr 0x007f867d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bd0 PSN 0xd57b25 OUT 0x10 RKey 0x182f00 VAddr 0x007f867e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bd1 PSN 0xc68eed OUT 0x10 RKey 0x182f00 VAddr 0x007f867e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bd2 PSN 0xe31712 OUT 0x10 RKey 0x182f00 VAddr 0x007f867f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bd3 PSN 0x51c76d OUT 0x10 RKey 0x182f00 VAddr 0x007f867f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bd4 PSN 0xd23dd7 OUT 0x10 RKey 0x182f00 VAddr 0x007f8680000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bd5 PSN 0x9788d6 OUT 0x10 RKey 0x182f00 VAddr 0x007f8680800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bd6 PSN 0x452ff8 OUT 0x10 RKey 0x182f00 VAddr 0x007f8681000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bd7 PSN 0xdf7062 OUT 0x10 RKey 0x182f00 VAddr 0x007f8681800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bd8 PSN 0x56070 OUT 0x10 RKey 0x182f00 VAddr 0x007f8682000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bd9 PSN 0x42626 OUT 0x10 RKey 0x182f00 VAddr 0x007f8682800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bda PSN 0x85a22 OUT 0x10 RKey 0x182f00 VAddr 0x007f8683000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0bdb PSN 0xa12f74 OUT 0x10 RKey 0x182f00 VAddr 0x007f8683800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0bcc PSN 0x5febde OUT 0x10 RKey 0x183000 VAddr 0x007fc376000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bcd PSN 0x304b70 OUT 0x10 RKey 0x183000 VAddr 0x007fc376800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bce PSN 0x83ffa OUT 0x10 RKey 0x183000 VAddr 0x007fc377000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bcf PSN 0x9c78c1 OUT 0x10 RKey 0x183000 VAddr 0x007fc377800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bd0 PSN 0x7a8640 OUT 0x10 RKey 0x183000 VAddr 0x007fc378000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bd1 PSN 0x60fea2 OUT 0x10 RKey 0x183000 VAddr 0x007fc378800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bd2 PSN 0x53b859 OUT 0x10 RKey 0x183000 VAddr 0x007fc379000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bd3 PSN 0x16afde OUT 0x10 RKey 0x183000 VAddr 0x007fc379800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bd4 PSN 0x212f2a OUT 0x10 RKey 0x183000 VAddr 0x007fc37a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bd5 PSN 0xff4e64 OUT 0x10 RKey 0x183000 VAddr 0x007fc37a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bd6 PSN 0x636e38 OUT 0x10 RKey 0x183000 VAddr 0x007fc37b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bd7 PSN 0x36fe6b OUT 0x10 RKey 0x183000 VAddr 0x007fc37b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bd8 PSN 0xab637b OUT 0x10 RKey 0x183000 VAddr 0x007fc37c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bd9 PSN 0x9c70c OUT 0x10 RKey 0x183000 VAddr 0x007fc37c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bda PSN 0x8e0cda OUT 0x10 RKey 0x183000 VAddr 0x007fc37d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0bdb PSN 0x492496 OUT 0x10 RKey 0x183000 VAddr 0x007fc37d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.080348            0.080054            5.003363
 4          16000            0.16               0.16   		     5.099131
 8          16000            0.33               0.33   		     5.094308
 16         16000            0.65               0.65   		     5.074661
 32         16000            1.30               1.30   		     5.061257
 64         16000            2.60               2.59   		     5.066289
 128        16000            5.19               5.19   		     5.064257
 256        16000            10.38              10.33  		     5.044056
 512        16000            20.76              20.64  		     5.037847
 1024       16000            41.70              41.46  		     5.060918
 2048       16000            82.47              82.11  		     5.011762
 4096       16000            161.33             160.05 		     4.884347
 8192       16000            192.00             191.85 		     2.927358
 16384      16000            196.35             196.30 		     1.497637
 32768      16000            203.18             203.14 		     0.774900
 65536      16000            207.50             207.47 		     0.395711
 131072     16000            208.92             208.91 		     0.199236
 262144     16000            208.67             208.66 		     0.099497
 524288     16000            209.16             209.15 		     0.049866
 1048576    16000            209.54             209.54 		     0.024979
 2097152    16000            194.93             194.40 		     0.011587
 4194304    16000            171.16             171.16 		     0.005101
 8388608    16000            171.10             171.10 		     0.002550
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f8674000000
destroying current CUDA Ctx
