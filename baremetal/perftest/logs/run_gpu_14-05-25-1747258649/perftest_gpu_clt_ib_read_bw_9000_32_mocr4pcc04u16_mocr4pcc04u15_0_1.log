initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 21559, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007f9320000000 pointer=0x7f9320000000
using DMA-BUF for GPU buffer address at 0x7f9320000000 aligned at 0x7f9320000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7f9320000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0ae0 PSN 0xdc6b05 OUT 0x10 RKey 0x183000 VAddr 0x007f9330000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ae1 PSN 0xd9ec42 OUT 0x10 RKey 0x183000 VAddr 0x007f9330800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ae2 PSN 0xdff22e OUT 0x10 RKey 0x183000 VAddr 0x007f9331000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ae3 PSN 0x79dae OUT 0x10 RKey 0x183000 VAddr 0x007f9331800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ae4 PSN 0x38a060 OUT 0x10 RKey 0x183000 VAddr 0x007f9332000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ae5 PSN 0xd46b0c OUT 0x10 RKey 0x183000 VAddr 0x007f9332800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ae6 PSN 0x21aa45 OUT 0x10 RKey 0x183000 VAddr 0x007f9333000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ae7 PSN 0x3a4624 OUT 0x10 RKey 0x183000 VAddr 0x007f9333800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ae8 PSN 0x5c9bc2 OUT 0x10 RKey 0x183000 VAddr 0x007f9334000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ae9 PSN 0x86a7e5 OUT 0x10 RKey 0x183000 VAddr 0x007f9334800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0aea PSN 0xd0e35b OUT 0x10 RKey 0x183000 VAddr 0x007f9335000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0aeb PSN 0xc9c389 OUT 0x10 RKey 0x183000 VAddr 0x007f9335800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0aec PSN 0x73d20b OUT 0x10 RKey 0x183000 VAddr 0x007f9336000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0aed PSN 0xffc725 OUT 0x10 RKey 0x183000 VAddr 0x007f9336800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0aee PSN 0xe500b5 OUT 0x10 RKey 0x183000 VAddr 0x007f9337000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0aef PSN 0xc02e0b OUT 0x10 RKey 0x183000 VAddr 0x007f9337800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0af0 PSN 0xf06afb OUT 0x10 RKey 0x183000 VAddr 0x007f9338000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0af1 PSN 0xcc3362 OUT 0x10 RKey 0x183000 VAddr 0x007f9338800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0af2 PSN 0xcd9ecc OUT 0x10 RKey 0x183000 VAddr 0x007f9339000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0af3 PSN 0x13da92 OUT 0x10 RKey 0x183000 VAddr 0x007f9339800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0af4 PSN 0xac08c1 OUT 0x10 RKey 0x183000 VAddr 0x007f933a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0af5 PSN 0x688f33 OUT 0x10 RKey 0x183000 VAddr 0x007f933a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0af6 PSN 0x6fcee5 OUT 0x10 RKey 0x183000 VAddr 0x007f933b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0af7 PSN 0xfe1753 OUT 0x10 RKey 0x183000 VAddr 0x007f933b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0af8 PSN 0xd93e22 OUT 0x10 RKey 0x183000 VAddr 0x007f933c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0af9 PSN 0xf2c10f OUT 0x10 RKey 0x183000 VAddr 0x007f933c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0afa PSN 0x8d324e OUT 0x10 RKey 0x183000 VAddr 0x007f933d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0afb PSN 0xcfdf82 OUT 0x10 RKey 0x183000 VAddr 0x007f933d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0afc PSN 0x1dfd42 OUT 0x10 RKey 0x183000 VAddr 0x007f933e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0afd PSN 0x2c9b53 OUT 0x10 RKey 0x183000 VAddr 0x007f933e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0afe PSN 0xaf4f36 OUT 0x10 RKey 0x183000 VAddr 0x007f933f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0aff PSN 0x58d824 OUT 0x10 RKey 0x183000 VAddr 0x007f933f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0ae0 PSN 0x167104 OUT 0x10 RKey 0x183100 VAddr 0x007f1f10000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ae1 PSN 0x8f209e OUT 0x10 RKey 0x183100 VAddr 0x007f1f10800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ae2 PSN 0x585890 OUT 0x10 RKey 0x183100 VAddr 0x007f1f11000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ae3 PSN 0x15b49f OUT 0x10 RKey 0x183100 VAddr 0x007f1f11800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ae4 PSN 0x8a77c6 OUT 0x10 RKey 0x183100 VAddr 0x007f1f12000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ae5 PSN 0xb138b0 OUT 0x10 RKey 0x183100 VAddr 0x007f1f12800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ae6 PSN 0x8d044f OUT 0x10 RKey 0x183100 VAddr 0x007f1f13000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ae7 PSN 0x830b9c OUT 0x10 RKey 0x183100 VAddr 0x007f1f13800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ae8 PSN 0xd8f310 OUT 0x10 RKey 0x183100 VAddr 0x007f1f14000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ae9 PSN 0x465b52 OUT 0x10 RKey 0x183100 VAddr 0x007f1f14800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0aea PSN 0xa9c38e OUT 0x10 RKey 0x183100 VAddr 0x007f1f15000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0aeb PSN 0x1c9809 OUT 0x10 RKey 0x183100 VAddr 0x007f1f15800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0aec PSN 0x19bfc1 OUT 0x10 RKey 0x183100 VAddr 0x007f1f16000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0aed PSN 0x75f4da OUT 0x10 RKey 0x183100 VAddr 0x007f1f16800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0aee PSN 0xaca190 OUT 0x10 RKey 0x183100 VAddr 0x007f1f17000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0aef PSN 0xb1fa14 OUT 0x10 RKey 0x183100 VAddr 0x007f1f17800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0af0 PSN 0x9ed99 OUT 0x10 RKey 0x183100 VAddr 0x007f1f18000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0af1 PSN 0x2137df OUT 0x10 RKey 0x183100 VAddr 0x007f1f18800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0af2 PSN 0xce62ce OUT 0x10 RKey 0x183100 VAddr 0x007f1f19000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0af3 PSN 0xcf8ea3 OUT 0x10 RKey 0x183100 VAddr 0x007f1f19800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0af4 PSN 0x9486c8 OUT 0x10 RKey 0x183100 VAddr 0x007f1f1a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0af5 PSN 0x9e0ef7 OUT 0x10 RKey 0x183100 VAddr 0x007f1f1a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0af6 PSN 0x27c08f OUT 0x10 RKey 0x183100 VAddr 0x007f1f1b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0af7 PSN 0x9d2beb OUT 0x10 RKey 0x183100 VAddr 0x007f1f1b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0af8 PSN 0xac0610 OUT 0x10 RKey 0x183100 VAddr 0x007f1f1c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0af9 PSN 0x30289b OUT 0x10 RKey 0x183100 VAddr 0x007f1f1c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0afa PSN 0x408420 OUT 0x10 RKey 0x183100 VAddr 0x007f1f1d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0afb PSN 0xbad522 OUT 0x10 RKey 0x183100 VAddr 0x007f1f1d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0afc PSN 0xccc599 OUT 0x10 RKey 0x183100 VAddr 0x007f1f1e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0afd PSN 0x539f27 OUT 0x10 RKey 0x183100 VAddr 0x007f1f1e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0afe PSN 0xa2dbb1 OUT 0x10 RKey 0x183100 VAddr 0x007f1f1f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0aff PSN 0x2fb74c OUT 0x10 RKey 0x183100 VAddr 0x007f1f1f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.059504            0.059205            3.700299
 4          32000            0.12               0.12   		     3.777514
 8          32000            0.24               0.24   		     3.781724
 16         32000            0.48               0.48   		     3.776431
 32         32000            0.97               0.97   		     3.777536
 64         32000            1.94               1.93   		     3.772735
 128        32000            3.88               3.87   		     3.777839
 256        32000            7.78               7.76   		     3.789718
 512        32000            15.70              15.67  		     3.824870
 1024       32000            31.40              31.32  		     3.823361
 2048       32000            63.56              63.34  		     3.865817
 4096       32000            132.13             131.33 		     4.007770
 8192       32000            208.57             208.39 		     3.179830
 16384      32000            209.16             209.10 		     1.595291
 32768      32000            208.12             208.10 		     0.793844
 65536      32000            207.17             207.15 		     0.395108
 131072     32000            208.38             208.37 		     0.198713
 262144     32000            208.73             208.72 		     0.099528
 524288     32000            208.91             208.91 		     0.049808
 1048576    32000            186.62             186.62 		     0.022247
 2097152    32000            171.37             171.37 		     0.010215
 4194304    32000            171.27             171.27 		     0.005104
 8388608    32000            171.24             171.24 		     0.002552
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f9320000000
destroying current CUDA Ctx
