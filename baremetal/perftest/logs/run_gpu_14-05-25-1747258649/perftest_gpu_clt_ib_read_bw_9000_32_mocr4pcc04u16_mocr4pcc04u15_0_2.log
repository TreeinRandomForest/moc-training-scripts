initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 22242, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fb020000000 pointer=0x7fb020000000
using DMA-BUF for GPU buffer address at 0x7fb020000000 aligned at 0x7fb020000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fb020000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0b5e PSN 0xfd8d08 OUT 0x10 RKey 0x183000 VAddr 0x007fb030000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b5f PSN 0xd1a652 OUT 0x10 RKey 0x183000 VAddr 0x007fb030800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b60 PSN 0xbafe34 OUT 0x10 RKey 0x183000 VAddr 0x007fb031000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b61 PSN 0x179373 OUT 0x10 RKey 0x183000 VAddr 0x007fb031800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b62 PSN 0xf8d00a OUT 0x10 RKey 0x183000 VAddr 0x007fb032000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b63 PSN 0xa9e5a4 OUT 0x10 RKey 0x183000 VAddr 0x007fb032800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b64 PSN 0xc1e033 OUT 0x10 RKey 0x183000 VAddr 0x007fb033000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b65 PSN 0xc383b0 OUT 0x10 RKey 0x183000 VAddr 0x007fb033800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b66 PSN 0x9e0b94 OUT 0x10 RKey 0x183000 VAddr 0x007fb034000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b67 PSN 0xe86386 OUT 0x10 RKey 0x183000 VAddr 0x007fb034800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b68 PSN 0xf5f9b2 OUT 0x10 RKey 0x183000 VAddr 0x007fb035000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b69 PSN 0x63fd5d OUT 0x10 RKey 0x183000 VAddr 0x007fb035800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b6a PSN 0xf95c85 OUT 0x10 RKey 0x183000 VAddr 0x007fb036000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b6b PSN 0x33cc4e OUT 0x10 RKey 0x183000 VAddr 0x007fb036800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b6c PSN 0x395f4 OUT 0x10 RKey 0x183000 VAddr 0x007fb037000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b6d PSN 0x79e0a8 OUT 0x10 RKey 0x183000 VAddr 0x007fb037800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b6e PSN 0xc0129d OUT 0x10 RKey 0x183000 VAddr 0x007fb038000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b6f PSN 0xa09293 OUT 0x10 RKey 0x183000 VAddr 0x007fb038800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b70 PSN 0x75b972 OUT 0x10 RKey 0x183000 VAddr 0x007fb039000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b71 PSN 0x16ca77 OUT 0x10 RKey 0x183000 VAddr 0x007fb039800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b72 PSN 0x19780c OUT 0x10 RKey 0x183000 VAddr 0x007fb03a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b73 PSN 0xabe0eb OUT 0x10 RKey 0x183000 VAddr 0x007fb03a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b74 PSN 0x9b5d73 OUT 0x10 RKey 0x183000 VAddr 0x007fb03b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b75 PSN 0xfbd0ff OUT 0x10 RKey 0x183000 VAddr 0x007fb03b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b76 PSN 0xb84794 OUT 0x10 RKey 0x183000 VAddr 0x007fb03c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b77 PSN 0xf4a5cf OUT 0x10 RKey 0x183000 VAddr 0x007fb03c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b78 PSN 0x568b44 OUT 0x10 RKey 0x183000 VAddr 0x007fb03d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b79 PSN 0xb63776 OUT 0x10 RKey 0x183000 VAddr 0x007fb03d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b7a PSN 0x9d1b5d OUT 0x10 RKey 0x183000 VAddr 0x007fb03e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b7b PSN 0xc63b9b OUT 0x10 RKey 0x183000 VAddr 0x007fb03e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b7c PSN 0xefb115 OUT 0x10 RKey 0x183000 VAddr 0x007fb03f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0b7d PSN 0xce6ae0 OUT 0x10 RKey 0x183000 VAddr 0x007fb03f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0b5e PSN 0x33e06c OUT 0x10 RKey 0x183100 VAddr 0x007f3b70000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b5f PSN 0xeffe6 OUT 0x10 RKey 0x183100 VAddr 0x007f3b70800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b60 PSN 0xc51a38 OUT 0x10 RKey 0x183100 VAddr 0x007f3b71000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b61 PSN 0x411927 OUT 0x10 RKey 0x183100 VAddr 0x007f3b71800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b62 PSN 0xb675ae OUT 0x10 RKey 0x183100 VAddr 0x007f3b72000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b63 PSN 0x6ac478 OUT 0x10 RKey 0x183100 VAddr 0x007f3b72800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b64 PSN 0x833877 OUT 0x10 RKey 0x183100 VAddr 0x007f3b73000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b65 PSN 0x1330a4 OUT 0x10 RKey 0x183100 VAddr 0x007f3b73800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b66 PSN 0xdde778 OUT 0x10 RKey 0x183100 VAddr 0x007f3b74000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b67 PSN 0xd7db9a OUT 0x10 RKey 0x183100 VAddr 0x007f3b74800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b68 PSN 0x3e1236 OUT 0x10 RKey 0x183100 VAddr 0x007f3b75000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b69 PSN 0xcd0591 OUT 0x10 RKey 0x183100 VAddr 0x007f3b75800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b6a PSN 0x92a9 OUT 0x10 RKey 0x183100 VAddr 0x007f3b76000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b6b PSN 0x1a31a2 OUT 0x10 RKey 0x183100 VAddr 0x007f3b76800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b6c PSN 0x9632b8 OUT 0x10 RKey 0x183100 VAddr 0x007f3b77000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b6d PSN 0x6eb81c OUT 0x10 RKey 0x183100 VAddr 0x007f3b77800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b6e PSN 0x820701 OUT 0x10 RKey 0x183100 VAddr 0x007f3b78000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b6f PSN 0xf77927 OUT 0x10 RKey 0x183100 VAddr 0x007f3b78800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b70 PSN 0xede76 OUT 0x10 RKey 0x183100 VAddr 0x007f3b79000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b71 PSN 0x3d252b OUT 0x10 RKey 0x183100 VAddr 0x007f3b79800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b72 PSN 0xdbceb0 OUT 0x10 RKey 0x183100 VAddr 0x007f3b7a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b73 PSN 0x721cbf OUT 0x10 RKey 0x183100 VAddr 0x007f3b7a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b74 PSN 0x334eb7 OUT 0x10 RKey 0x183100 VAddr 0x007f3b7b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b75 PSN 0x20a2f3 OUT 0x10 RKey 0x183100 VAddr 0x007f3b7b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b76 PSN 0xf6e478 OUT 0x10 RKey 0x183100 VAddr 0x007f3b7c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b77 PSN 0xc24ae3 OUT 0x10 RKey 0x183100 VAddr 0x007f3b7c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b78 PSN 0xa5ccc8 OUT 0x10 RKey 0x183100 VAddr 0x007f3b7d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b79 PSN 0x1b4aa OUT 0x10 RKey 0x183100 VAddr 0x007f3b7d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b7a PSN 0x2e2281 OUT 0x10 RKey 0x183100 VAddr 0x007f3b7e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b7b PSN 0x209def OUT 0x10 RKey 0x183100 VAddr 0x007f3b7e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b7c PSN 0x3306d9 OUT 0x10 RKey 0x183100 VAddr 0x007f3b7f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0b7d PSN 0x380754 OUT 0x10 RKey 0x183100 VAddr 0x007f3b7f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.080178            0.079429            4.964334
 4          32000            0.16               0.16   		     5.115937
 8          32000            0.33               0.33   		     5.124058
 16         32000            0.66               0.66   		     5.122918
 32         32000            1.32               1.31   		     5.111405
 64         32000            2.62               2.61   		     5.103025
 128        32000            5.27               5.24   		     5.112801
 256        32000            10.47              10.44  		     5.099650
 512        32000            21.04              20.96  		     5.116374
 1024       32000            41.89              41.79  		     5.101602
 2048       32000            82.28              81.73  		     4.988359
 4096       32000            167.95             167.50 		     5.111699
 8192       32000            196.61             196.57 		     2.999479
 16384      32000            203.11             202.99 		     1.548705
 32768      32000            208.20             208.14 		     0.794009
 65536      32000            206.92             206.92 		     0.394662
 131072     32000            208.23             208.23 		     0.198587
 262144     32000            209.30             209.29 		     0.099796
 524288     32000            209.06             209.06 		     0.049845
 1048576    32000            186.70             186.70 		     0.022256
 2097152    32000            171.24             171.24 		     0.010206
 4194304    32000            171.28             171.28 		     0.005104
 8388608    32000            171.24             171.24 		     0.002552
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fb020000000
destroying current CUDA Ctx
