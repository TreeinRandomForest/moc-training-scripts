initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 26501, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007ff1b4000000 pointer=0x7ff1b4000000
using DMA-BUF for GPU buffer address at 0x7ff1b4000000 aligned at 0x7ff1b4000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7ff1b4000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0e42 PSN 0x6994fe OUT 0x10 RKey 0x182f00 VAddr 0x007ff1bc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e43 PSN 0x368147 OUT 0x10 RKey 0x182f00 VAddr 0x007ff1bc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e44 PSN 0xc9e34f OUT 0x10 RKey 0x182f00 VAddr 0x007ff1bd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e45 PSN 0xb2eebb OUT 0x10 RKey 0x182f00 VAddr 0x007ff1bd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e46 PSN 0xf7d0e9 OUT 0x10 RKey 0x182f00 VAddr 0x007ff1be000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e47 PSN 0x232b61 OUT 0x10 RKey 0x182f00 VAddr 0x007ff1be800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e48 PSN 0xd1ec76 OUT 0x10 RKey 0x182f00 VAddr 0x007ff1bf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e49 PSN 0xea7b01 OUT 0x10 RKey 0x182f00 VAddr 0x007ff1bf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e4a PSN 0x9dabdb OUT 0x10 RKey 0x182f00 VAddr 0x007ff1c0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e4b PSN 0xbcf88a OUT 0x10 RKey 0x182f00 VAddr 0x007ff1c0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e4c PSN 0x81779c OUT 0x10 RKey 0x182f00 VAddr 0x007ff1c1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e4d PSN 0x174936 OUT 0x10 RKey 0x182f00 VAddr 0x007ff1c1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e4e PSN 0xb2ab4 OUT 0x10 RKey 0x182f00 VAddr 0x007ff1c2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e4f PSN 0xe45d1a OUT 0x10 RKey 0x182f00 VAddr 0x007ff1c2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e50 PSN 0xcef806 OUT 0x10 RKey 0x182f00 VAddr 0x007ff1c3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0e51 PSN 0x3d4188 OUT 0x10 RKey 0x182f00 VAddr 0x007ff1c3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0e42 PSN 0xf3dae OUT 0x10 RKey 0x183000 VAddr 0x007fb50e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e43 PSN 0x170100 OUT 0x10 RKey 0x183000 VAddr 0x007fb50e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e44 PSN 0x22ee4a OUT 0x10 RKey 0x183000 VAddr 0x007fb50f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e45 PSN 0x5490d1 OUT 0x10 RKey 0x183000 VAddr 0x007fb50f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e46 PSN 0x3b2510 OUT 0x10 RKey 0x183000 VAddr 0x007fb510000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e47 PSN 0xd37d32 OUT 0x10 RKey 0x183000 VAddr 0x007fb510800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e48 PSN 0x88fba9 OUT 0x10 RKey 0x183000 VAddr 0x007fb511000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e49 PSN 0xfe38ee OUT 0x10 RKey 0x183000 VAddr 0x007fb511800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e4a PSN 0x9aeafa OUT 0x10 RKey 0x183000 VAddr 0x007fb512000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e4b PSN 0x5125f4 OUT 0x10 RKey 0x183000 VAddr 0x007fb512800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e4c PSN 0xa79688 OUT 0x10 RKey 0x183000 VAddr 0x007fb513000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e4d PSN 0x34087b OUT 0x10 RKey 0x183000 VAddr 0x007fb513800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e4e PSN 0x330c4b OUT 0x10 RKey 0x183000 VAddr 0x007fb514000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e4f PSN 0x37879c OUT 0x10 RKey 0x183000 VAddr 0x007fb514800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e50 PSN 0xca6a2a OUT 0x10 RKey 0x183000 VAddr 0x007fb515000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0e51 PSN 0x92bfa6 OUT 0x10 RKey 0x183000 VAddr 0x007fb515800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.076759            0.075508            4.719235
 4          16000            0.16               0.16   		     4.861360
 8          16000            0.31               0.31   		     4.867498
 16         16000            0.62               0.62   		     4.842102
 32         16000            1.25               1.25   		     4.876518
 64         16000            2.50               2.49   		     4.865618
 128        16000            5.00               4.97   		     4.852455
 256        16000            10.00              9.96   		     4.861730
 512        16000            20.08              19.93  		     4.865337
 1024       16000            39.64              39.54  		     4.826284
 2048       16000            79.45              79.11  		     4.828683
 4096       16000            157.54             157.40 		     4.803334
 8192       16000            190.02             189.54 		     2.892195
 16384      16000            182.38             137.40 		     1.048244
 32768      16000            196.02             196.00 		     0.747695
 65536      16000            198.16             198.15 		     0.377941
 131072     16000            198.16             198.15 		     0.188971
 262144     16000            194.16             194.16 		     0.092584
 524288     16000            195.36             195.36 		     0.046577
 1048576    16000            196.39             196.39 		     0.023411
 2097152    16000            184.90             184.90 		     0.011021
 4194304    16000            163.63             163.63 		     0.004877
 8388608    16000            163.71             163.71 		     0.002439
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007ff1b4000000
destroying current CUDA Ctx
