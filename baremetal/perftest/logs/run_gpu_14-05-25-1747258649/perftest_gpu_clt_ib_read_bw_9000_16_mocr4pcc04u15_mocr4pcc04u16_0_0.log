initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 10159, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f5c14000000 pointer=0x7f5c14000000
using DMA-BUF for GPU buffer address at 0x7f5c14000000 aligned at 0x7f5c14000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f5c14000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0272 PSN 0xf0cc6e OUT 0x10 RKey 0x183000 VAddr 0x007f5c1c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0273 PSN 0x6148c0 OUT 0x10 RKey 0x183000 VAddr 0x007f5c1c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0274 PSN 0x39fb0a OUT 0x10 RKey 0x183000 VAddr 0x007f5c1d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0275 PSN 0x997e91 OUT 0x10 RKey 0x183000 VAddr 0x007f5c1d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0276 PSN 0x2edfd0 OUT 0x10 RKey 0x183000 VAddr 0x007f5c1e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0277 PSN 0x6280f2 OUT 0x10 RKey 0x183000 VAddr 0x007f5c1e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0278 PSN 0xcc1469 OUT 0x10 RKey 0x183000 VAddr 0x007f5c1f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0279 PSN 0xcc42ae OUT 0x10 RKey 0x183000 VAddr 0x007f5c1f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x027a PSN 0x1791ba OUT 0x10 RKey 0x183000 VAddr 0x007f5c20000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x027b PSN 0x34a5b4 OUT 0x10 RKey 0x183000 VAddr 0x007f5c20800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x027c PSN 0x4b7b48 OUT 0x10 RKey 0x183000 VAddr 0x007f5c21000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x027d PSN 0x80ee3b OUT 0x10 RKey 0x183000 VAddr 0x007f5c21800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x027e PSN 0x5b5f0b OUT 0x10 RKey 0x183000 VAddr 0x007f5c22000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x027f PSN 0xbb435c OUT 0x10 RKey 0x183000 VAddr 0x007f5c22800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0280 PSN 0x8fdaea OUT 0x10 RKey 0x183000 VAddr 0x007f5c23000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0281 PSN 0xf04166 OUT 0x10 RKey 0x183000 VAddr 0x007f5c23800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0272 PSN 0xd9346e OUT 0x10 RKey 0x182f00 VAddr 0x007fddb6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0273 PSN 0xc590c0 OUT 0x10 RKey 0x182f00 VAddr 0x007fddb6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0274 PSN 0x9ca30a OUT 0x10 RKey 0x182f00 VAddr 0x007fddb7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0275 PSN 0x8b0691 OUT 0x10 RKey 0x182f00 VAddr 0x007fddb7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0276 PSN 0x35c7d0 OUT 0x10 RKey 0x182f00 VAddr 0x007fddb8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0277 PSN 0xc348f2 OUT 0x10 RKey 0x182f00 VAddr 0x007fddb8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0278 PSN 0xb13c69 OUT 0x10 RKey 0x182f00 VAddr 0x007fddb9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0279 PSN 0x4e4aae OUT 0x10 RKey 0x182f00 VAddr 0x007fddb9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x027a PSN 0xa4f9ba OUT 0x10 RKey 0x182f00 VAddr 0x007fddba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x027b PSN 0xd9edb4 OUT 0x10 RKey 0x182f00 VAddr 0x007fddba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x027c PSN 0x5b2348 OUT 0x10 RKey 0x182f00 VAddr 0x007fddbb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x027d PSN 0x1b763b OUT 0x10 RKey 0x182f00 VAddr 0x007fddbb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x027e PSN 0x57470b OUT 0x10 RKey 0x182f00 VAddr 0x007fddbc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x027f PSN 0x6d0b5c OUT 0x10 RKey 0x182f00 VAddr 0x007fddbc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0280 PSN 0xf202ea OUT 0x10 RKey 0x182f00 VAddr 0x007fddbd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0281 PSN 0xab4966 OUT 0x10 RKey 0x182f00 VAddr 0x007fddbd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.082380            0.082168            5.135513
 4          16000            0.17               0.17   		     5.247781
 8          16000            0.34               0.34   		     5.248810
 16         16000            0.67               0.67   		     5.224268
 32         16000            1.33               1.33   		     5.185663
 64         16000            2.67               2.66   		     5.195261
 128        16000            5.35               5.28   		     5.159709
 256        16000            10.72              10.71  		     5.228091
 512        16000            21.43              21.38  		     5.219734
 1024       16000            42.87              42.73  		     5.215906
 2048       16000            85.33              85.02  		     5.189279
 4096       16000            170.67             170.20 		     5.194113
 8192       16000            207.98             207.59 		     3.167520
 16384      16000            208.71             208.68 		     1.592122
 32768      16000            209.22             209.19 		     0.797986
 65536      16000            209.27             209.25 		     0.399112
 131072     16000            209.34             209.34 		     0.199642
 262144     16000            209.41             209.40 		     0.099849
 524288     16000            209.44             209.43 		     0.049933
 1048576    16000            209.45             209.45 		     0.024968
 2097152    16000            191.95             191.95 		     0.011441
 4194304    16000            171.03             171.03 		     0.005097
 8388608    16000            171.03             171.03 		     0.002549
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f5c14000000
destroying current CUDA Ctx
