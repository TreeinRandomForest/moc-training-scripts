initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 12274, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007ff3c0000000 pointer=0x7ff3c0000000
using DMA-BUF for GPU buffer address at 0x7ff3c0000000 aligned at 0x7ff3c0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7ff3c0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x03fc PSN 0x130852 OUT 0x10 RKey 0x183100 VAddr 0x007ff3d0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x03fd PSN 0xf3a0d4 OUT 0x10 RKey 0x183100 VAddr 0x007ff3d0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x03fe PSN 0x1b738e OUT 0x10 RKey 0x183100 VAddr 0x007ff3d1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x03ff PSN 0x9066c5 OUT 0x10 RKey 0x183100 VAddr 0x007ff3d1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0400 PSN 0xde75f4 OUT 0x10 RKey 0x183100 VAddr 0x007ff3d2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0401 PSN 0x39c646 OUT 0x10 RKey 0x183100 VAddr 0x007ff3d2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0402 PSN 0x2e112d OUT 0x10 RKey 0x183100 VAddr 0x007ff3d3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0403 PSN 0x4cfa22 OUT 0x10 RKey 0x183100 VAddr 0x007ff3d3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0404 PSN 0xa7e61e OUT 0x10 RKey 0x183100 VAddr 0x007ff3d4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0405 PSN 0xaa6c48 OUT 0x10 RKey 0x183100 VAddr 0x007ff3d4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0406 PSN 0x4a004c OUT 0x10 RKey 0x183100 VAddr 0x007ff3d5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0407 PSN 0x1128ef OUT 0x10 RKey 0x183100 VAddr 0x007ff3d5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0408 PSN 0x7215af OUT 0x10 RKey 0x183100 VAddr 0x007ff3d6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0409 PSN 0xae5f30 OUT 0x10 RKey 0x183100 VAddr 0x007ff3d6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x040a PSN 0x832c2e OUT 0x10 RKey 0x183100 VAddr 0x007ff3d7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x040b PSN 0x3cf35a OUT 0x10 RKey 0x183100 VAddr 0x007ff3d7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x040c PSN 0xb2f467 OUT 0x10 RKey 0x183100 VAddr 0x007ff3d8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x040d PSN 0x1e3195 OUT 0x10 RKey 0x183100 VAddr 0x007ff3d8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x040e PSN 0xa6394c OUT 0x10 RKey 0x183100 VAddr 0x007ff3d9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x040f PSN 0x931649 OUT 0x10 RKey 0x183100 VAddr 0x007ff3d9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0410 PSN 0xbc6c76 OUT 0x10 RKey 0x183100 VAddr 0x007ff3da000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0411 PSN 0x5d2e0d OUT 0x10 RKey 0x183100 VAddr 0x007ff3da800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0412 PSN 0xbdc0ed OUT 0x10 RKey 0x183100 VAddr 0x007ff3db000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0413 PSN 0x77c7f1 OUT 0x10 RKey 0x183100 VAddr 0x007ff3db800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0414 PSN 0x75d89e OUT 0x10 RKey 0x183100 VAddr 0x007ff3dc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0415 PSN 0x326311 OUT 0x10 RKey 0x183100 VAddr 0x007ff3dc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0416 PSN 0x816c5e OUT 0x10 RKey 0x183100 VAddr 0x007ff3dd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0417 PSN 0x2d6b88 OUT 0x10 RKey 0x183100 VAddr 0x007ff3dd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0418 PSN 0xbe7307 OUT 0x10 RKey 0x183100 VAddr 0x007ff3de000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0419 PSN 0x734afd OUT 0x10 RKey 0x183100 VAddr 0x007ff3de800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x041a PSN 0xc949cf OUT 0x10 RKey 0x183100 VAddr 0x007ff3df000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x041b PSN 0x238e12 OUT 0x10 RKey 0x183100 VAddr 0x007ff3df800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03fc PSN 0x795574 OUT 0x10 RKey 0x183000 VAddr 0x007f0b30000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x03fd PSN 0x27044e OUT 0x10 RKey 0x183000 VAddr 0x007f0b30800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x03fe PSN 0xd46a80 OUT 0x10 RKey 0x183000 VAddr 0x007f0b31000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x03ff PSN 0x46f7cf OUT 0x10 RKey 0x183000 VAddr 0x007f0b31800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0400 PSN 0x213336 OUT 0x10 RKey 0x183000 VAddr 0x007f0b32000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0401 PSN 0x85a760 OUT 0x10 RKey 0x183000 VAddr 0x007f0b32800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0402 PSN 0xb2453f OUT 0x10 RKey 0x183000 VAddr 0x007f0b33000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0403 PSN 0xf751cc OUT 0x10 RKey 0x183000 VAddr 0x007f0b33800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0404 PSN 0xa9f580 OUT 0x10 RKey 0x183000 VAddr 0x007f0b34000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0405 PSN 0xb50502 OUT 0x10 RKey 0x183000 VAddr 0x007f0b34800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0406 PSN 0x7c237e OUT 0x10 RKey 0x183000 VAddr 0x007f0b35000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0407 PSN 0x211139 OUT 0x10 RKey 0x183000 VAddr 0x007f0b35800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0408 PSN 0x227931 OUT 0x10 RKey 0x183000 VAddr 0x007f0b36000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0409 PSN 0x7898a OUT 0x10 RKey 0x183000 VAddr 0x007f0b36800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x040a PSN 0x7f1080 OUT 0x10 RKey 0x183000 VAddr 0x007f0b37000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x040b PSN 0x36d644 OUT 0x10 RKey 0x183000 VAddr 0x007f0b37800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x040c PSN 0xaece09 OUT 0x10 RKey 0x183000 VAddr 0x007f0b38000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x040d PSN 0x39678f OUT 0x10 RKey 0x183000 VAddr 0x007f0b38800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x040e PSN 0x32d0be OUT 0x10 RKey 0x183000 VAddr 0x007f0b39000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x040f PSN 0x97fdd3 OUT 0x10 RKey 0x183000 VAddr 0x007f0b39800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0410 PSN 0x10fe38 OUT 0x10 RKey 0x183000 VAddr 0x007f0b3a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0411 PSN 0x2b89a7 OUT 0x10 RKey 0x183000 VAddr 0x007f0b3a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0412 PSN 0xdf1d7f OUT 0x10 RKey 0x183000 VAddr 0x007f0b3b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0413 PSN 0x6f5e1b OUT 0x10 RKey 0x183000 VAddr 0x007f0b3b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0414 PSN 0x828480 OUT 0x10 RKey 0x183000 VAddr 0x007f0b3c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0415 PSN 0x5c9e4b OUT 0x10 RKey 0x183000 VAddr 0x007f0b3c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0416 PSN 0x2ac010 OUT 0x10 RKey 0x183000 VAddr 0x007f0b3d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0417 PSN 0x8ffa52 OUT 0x10 RKey 0x183000 VAddr 0x007f0b3d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0418 PSN 0x36bb09 OUT 0x10 RKey 0x183000 VAddr 0x007f0b3e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0419 PSN 0x33bfd7 OUT 0x10 RKey 0x183000 VAddr 0x007f0b3e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x041a PSN 0xaee6a1 OUT 0x10 RKey 0x183000 VAddr 0x007f0b3f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x041b PSN 0x63ff7c OUT 0x10 RKey 0x183000 VAddr 0x007f0b3f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.082005            0.081847            5.115458
 4          32000            0.17               0.17   		     5.254153
 8          32000            0.34               0.34   		     5.246074
 16         32000            0.68               0.67   		     5.268357
 32         32000            1.35               1.35   		     5.263600
 64         32000            2.69               2.68   		     5.231613
 128        32000            5.40               5.37   		     5.242619
 256        32000            10.79              10.77  		     5.258643
 512        32000            21.58              21.48  		     5.244217
 1024       32000            43.07              42.92  		     5.239692
 2048       32000            85.73              85.65  		     5.227434
 4096       32000            171.86             171.41 		     5.231160
 8192       32000            208.57             208.32 		     3.178684
 16384      32000            209.01             208.99 		     1.594485
 32768      32000            209.01             208.96 		     0.797112
 65536      32000            209.16             209.14 		     0.398907
 131072     32000            209.23             209.22 		     0.199523
 262144     32000            209.24             209.23 		     0.099770
 524288     32000            209.29             209.28 		     0.049897
 1048576    32000            186.75             186.74 		     0.022262
 2097152    32000            171.26             171.26 		     0.010208
 4194304    32000            171.24             171.24 		     0.005103
 8388608    32000            171.20             171.20 		     0.002551
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007ff3c0000000
destroying current CUDA Ctx
