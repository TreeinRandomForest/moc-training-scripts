initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 25876, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fbd40000000 pointer=0x7fbd40000000
using DMA-BUF for GPU buffer address at 0x7fbd40000000 aligned at 0x7fbd40000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fbd40000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0dd4 PSN 0x1de612 OUT 0x10 RKey 0x183000 VAddr 0x007fbd50000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0dd5 PSN 0xce8b94 OUT 0x10 RKey 0x183000 VAddr 0x007fbd50800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0dd6 PSN 0x39e74e OUT 0x10 RKey 0x183000 VAddr 0x007fbd51000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0dd7 PSN 0x862f85 OUT 0x10 RKey 0x183000 VAddr 0x007fbd51800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0dd8 PSN 0xe16fb4 OUT 0x10 RKey 0x183000 VAddr 0x007fbd52000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0dd9 PSN 0xe09d06 OUT 0x10 RKey 0x183000 VAddr 0x007fbd52800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0dda PSN 0x2800ed OUT 0x10 RKey 0x183000 VAddr 0x007fbd53000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ddb PSN 0x1e8ee2 OUT 0x10 RKey 0x183000 VAddr 0x007fbd53800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ddc PSN 0x88bbde OUT 0x10 RKey 0x183000 VAddr 0x007fbd54000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ddd PSN 0x6fef08 OUT 0x10 RKey 0x183000 VAddr 0x007fbd54800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0dde PSN 0xdb2c0c OUT 0x10 RKey 0x183000 VAddr 0x007fbd55000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ddf PSN 0x2f49af OUT 0x10 RKey 0x183000 VAddr 0x007fbd55800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0de0 PSN 0xb2876f OUT 0x10 RKey 0x183000 VAddr 0x007fbd56000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0de1 PSN 0x514df0 OUT 0x10 RKey 0x183000 VAddr 0x007fbd56800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0de2 PSN 0x6353ee OUT 0x10 RKey 0x183000 VAddr 0x007fbd57000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0de3 PSN 0x64601a OUT 0x10 RKey 0x183000 VAddr 0x007fbd57800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0de4 PSN 0x30c227 OUT 0x10 RKey 0x183000 VAddr 0x007fbd58000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0de5 PSN 0x894c55 OUT 0x10 RKey 0x183000 VAddr 0x007fbd58800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0de6 PSN 0x491d0c OUT 0x10 RKey 0x183000 VAddr 0x007fbd59000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0de7 PSN 0x8c8f09 OUT 0x10 RKey 0x183000 VAddr 0x007fbd59800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0de8 PSN 0x715636 OUT 0x10 RKey 0x183000 VAddr 0x007fbd5a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0de9 PSN 0x6734cd OUT 0x10 RKey 0x183000 VAddr 0x007fbd5a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0dea PSN 0x1320ad OUT 0x10 RKey 0x183000 VAddr 0x007fbd5b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0deb PSN 0xd80cb1 OUT 0x10 RKey 0x183000 VAddr 0x007fbd5b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0dec PSN 0x379e5e OUT 0x10 RKey 0x183000 VAddr 0x007fbd5c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ded PSN 0x5e15d1 OUT 0x10 RKey 0x183000 VAddr 0x007fbd5c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0dee PSN 0xb5081e OUT 0x10 RKey 0x183000 VAddr 0x007fbd5d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0def PSN 0x153c48 OUT 0x10 RKey 0x183000 VAddr 0x007fbd5d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0df0 PSN 0xfed4c7 OUT 0x10 RKey 0x183000 VAddr 0x007fbd5e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0df1 PSN 0xaf69bd OUT 0x10 RKey 0x183000 VAddr 0x007fbd5e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0df2 PSN 0x2e18f OUT 0x10 RKey 0x183000 VAddr 0x007fbd5f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0df3 PSN 0xffaad2 OUT 0x10 RKey 0x183000 VAddr 0x007fbd5f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0dd4 PSN 0x5b0cec OUT 0x10 RKey 0x183100 VAddr 0x007efbb0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0dd5 PSN 0xb7f266 OUT 0x10 RKey 0x183100 VAddr 0x007efbb0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0dd6 PSN 0x935ab8 OUT 0x10 RKey 0x183100 VAddr 0x007efbb1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0dd7 PSN 0x58fa7 OUT 0x10 RKey 0x183100 VAddr 0x007efbb1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0dd8 PSN 0xd3ea2e OUT 0x10 RKey 0x183100 VAddr 0x007efbb2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0dd9 PSN 0xa05ef8 OUT 0x10 RKey 0x183100 VAddr 0x007efbb2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0dda PSN 0x2500f7 OUT 0x10 RKey 0x183100 VAddr 0x007efbb3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ddb PSN 0x188f24 OUT 0x10 RKey 0x183100 VAddr 0x007efbb3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ddc PSN 0xe23f8 OUT 0x10 RKey 0x183100 VAddr 0x007efbb4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ddd PSN 0xbc9e1a OUT 0x10 RKey 0x183100 VAddr 0x007efbb4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0dde PSN 0x63e2b6 OUT 0x10 RKey 0x183100 VAddr 0x007efbb5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ddf PSN 0x39cc11 OUT 0x10 RKey 0x183100 VAddr 0x007efbb5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0de0 PSN 0xa81729 OUT 0x10 RKey 0x183100 VAddr 0x007efbb6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0de1 PSN 0x789c22 OUT 0x10 RKey 0x183100 VAddr 0x007efbb6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0de2 PSN 0x788b38 OUT 0x10 RKey 0x183100 VAddr 0x007efbb7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0de3 PSN 0x51669c OUT 0x10 RKey 0x183100 VAddr 0x007efbb7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0de4 PSN 0xcd5381 OUT 0x10 RKey 0x183100 VAddr 0x007efbb8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0de5 PSN 0xc20ba7 OUT 0x10 RKey 0x183100 VAddr 0x007efbb8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0de6 PSN 0xee3ef6 OUT 0x10 RKey 0x183100 VAddr 0x007efbb9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0de7 PSN 0xc3bab OUT 0x10 RKey 0x183100 VAddr 0x007efbb9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0de8 PSN 0x3f6330 OUT 0x10 RKey 0x183100 VAddr 0x007efbba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0de9 PSN 0x43573f OUT 0x10 RKey 0x183100 VAddr 0x007efbba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0dea PSN 0xd83737 OUT 0x10 RKey 0x183100 VAddr 0x007efbbb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0deb PSN 0x3aa173 OUT 0x10 RKey 0x183100 VAddr 0x007efbbb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0dec PSN 0xaf40f8 OUT 0x10 RKey 0x183100 VAddr 0x007efbbc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ded PSN 0x5cad63 OUT 0x10 RKey 0x183100 VAddr 0x007efbbc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0dee PSN 0xe0bd48 OUT 0x10 RKey 0x183100 VAddr 0x007efbbd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0def PSN 0x2d1b2a OUT 0x10 RKey 0x183100 VAddr 0x007efbbd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0df0 PSN 0xbfc701 OUT 0x10 RKey 0x183100 VAddr 0x007efbbe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0df1 PSN 0xeea86f OUT 0x10 RKey 0x183100 VAddr 0x007efbbe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0df2 PSN 0x5c7f59 OUT 0x10 RKey 0x183100 VAddr 0x007efbbf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0df3 PSN 0x2355d4 OUT 0x10 RKey 0x183100 VAddr 0x007efbbf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.080537            0.079975            4.998422
 4          32000            0.17               0.16   		     5.139721
 8          32000            0.33               0.33   		     5.143504
 16         32000            0.66               0.66   		     5.161748
 32         32000            1.33               1.32   		     5.170213
 64         32000            2.65               2.64   		     5.157422
 128        32000            5.28               5.26   		     5.140645
 256        32000            10.59              10.55  		     5.151552
 512        32000            21.14              21.07  		     5.143520
 1024       32000            42.28              42.06  		     5.134813
 2048       32000            83.97              83.66  		     5.106177
 4096       32000            166.05             164.93 		     5.033243
 8192       32000            200.89             200.77 		     3.063476
 16384      32000            197.79             197.70 		     1.508320
 32768      32000            200.96             200.92 		     0.766450
 65536      32000            198.90             198.89 		     0.379347
 131072     32000            199.52             199.51 		     0.190268
 262144     32000            199.63             199.63 		     0.095189
 524288     32000            199.86             199.86 		     0.047650
 1048576    32000            182.95             182.95 		     0.021809
 2097152    32000            169.52             168.12 		     0.010021
 4194304    32000            167.45             167.35 		     0.004988
 8388608    32000            167.37             167.24 		     0.002492
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fbd40000000
destroying current CUDA Ctx
