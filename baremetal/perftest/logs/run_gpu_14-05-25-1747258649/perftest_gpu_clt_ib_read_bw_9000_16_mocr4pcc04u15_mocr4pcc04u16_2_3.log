initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 18235, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007fc4d6000000 pointer=0x7fc4d6000000
using DMA-BUF for GPU buffer address at 0x7fc4d6000000 aligned at 0x7fc4d6000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7fc4d6000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x07dc PSN 0xc4043b OUT 0x10 RKey 0x183000 VAddr 0x007fc4de000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07dd PSN 0xe4ac40 OUT 0x10 RKey 0x183000 VAddr 0x007fc4de800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07de PSN 0x19e554 OUT 0x10 RKey 0x183000 VAddr 0x007fc4df000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07df PSN 0x3048dc OUT 0x10 RKey 0x183000 VAddr 0x007fc4df800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07e0 PSN 0xbcd6f6 OUT 0x10 RKey 0x183000 VAddr 0x007fc4e0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07e1 PSN 0x726cea OUT 0x10 RKey 0x183000 VAddr 0x007fc4e0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07e2 PSN 0xbde9cb OUT 0x10 RKey 0x183000 VAddr 0x007fc4e1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07e3 PSN 0x5bb632 OUT 0x10 RKey 0x183000 VAddr 0x007fc4e1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07e4 PSN 0x2de5b8 OUT 0x10 RKey 0x183000 VAddr 0x007fc4e2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07e5 PSN 0xde29a3 OUT 0x10 RKey 0x183000 VAddr 0x007fc4e2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07e6 PSN 0xcbd541 OUT 0x10 RKey 0x183000 VAddr 0x007fc4e3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07e7 PSN 0xff6677 OUT 0x10 RKey 0x183000 VAddr 0x007fc4e3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07e8 PSN 0x140561 OUT 0x10 RKey 0x183000 VAddr 0x007fc4e4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07e9 PSN 0x9ce6c3 OUT 0x10 RKey 0x183000 VAddr 0x007fc4e4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07ea PSN 0xdb6afb OUT 0x10 RKey 0x183000 VAddr 0x007fc4e5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x07eb PSN 0xae51d9 OUT 0x10 RKey 0x183000 VAddr 0x007fc4e5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x07dc PSN 0x95e2 OUT 0x10 RKey 0x182f00 VAddr 0x007f34fe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07dd PSN 0x84724 OUT 0x10 RKey 0x182f00 VAddr 0x007f34fe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07de PSN 0x12239e OUT 0x10 RKey 0x182f00 VAddr 0x007f34ff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07df PSN 0x87bd95 OUT 0x10 RKey 0x182f00 VAddr 0x007f34ff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07e0 PSN 0xed4c84 OUT 0x10 RKey 0x182f00 VAddr 0x007f3500000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07e1 PSN 0x108196 OUT 0x10 RKey 0x182f00 VAddr 0x007f3500800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07e2 PSN 0xa5b23d OUT 0x10 RKey 0x182f00 VAddr 0x007f3501000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07e3 PSN 0xb0edf2 OUT 0x10 RKey 0x182f00 VAddr 0x007f3501800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07e4 PSN 0x395ae OUT 0x10 RKey 0x182f00 VAddr 0x007f3502000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07e5 PSN 0x2f8c98 OUT 0x10 RKey 0x182f00 VAddr 0x007f3502800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07e6 PSN 0xc0a25c OUT 0x10 RKey 0x182f00 VAddr 0x007f3503000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07e7 PSN 0xee89bf OUT 0x10 RKey 0x182f00 VAddr 0x007f3503800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07e8 PSN 0x6f2e3f OUT 0x10 RKey 0x182f00 VAddr 0x007f3504000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07e9 PSN 0x433480 OUT 0x10 RKey 0x182f00 VAddr 0x007f3504800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07ea PSN 0x47df3e OUT 0x10 RKey 0x182f00 VAddr 0x007f3505000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x07eb PSN 0x9d912a OUT 0x10 RKey 0x182f00 VAddr 0x007f3505800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.078947            0.078500            4.906244
 4          16000            0.16               0.16   		     4.977710
 8          16000            0.32               0.32   		     4.981537
 16         16000            0.64               0.64   		     4.998108
 32         16000            1.28               1.28   		     4.985262
 64         16000            2.55               2.55   		     4.986086
 128        16000            5.14               5.12   		     4.998485
 256        16000            10.24              10.19  		     4.976672
 512        16000            20.39              20.32  		     4.960210
 1024       16000            40.87              40.75  		     4.974598
 2048       16000            81.74              81.32  		     4.963595
 4096       16000            163.12             162.57 		     4.961148
 8192       16000            196.86             196.51 		     2.998570
 16384      16000            197.66             197.63 		     1.507805
 32768      16000            198.06             198.02 		     0.755372
 65536      16000            198.09             198.09 		     0.377823
 131072     16000            198.14             198.14 		     0.188962
 262144     16000            198.19             198.19 		     0.094503
 524288     16000            198.21             198.20 		     0.047256
 1048576    16000            198.25             198.25 		     0.023633
 2097152    16000            185.40             185.40 		     0.011051
 4194304    16000            163.72             163.72 		     0.004879
 8388608    16000            163.73             163.73 		     0.002440
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fc4d6000000
destroying current CUDA Ctx
