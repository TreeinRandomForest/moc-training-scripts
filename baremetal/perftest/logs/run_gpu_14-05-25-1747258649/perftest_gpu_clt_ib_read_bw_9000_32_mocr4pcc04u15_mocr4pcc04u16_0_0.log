initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 10215, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fb400000000 pointer=0x7fb400000000
using DMA-BUF for GPU buffer address at 0x7fb400000000 aligned at 0x7fb400000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fb400000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0282 PSN 0x2c9670 OUT 0x10 RKey 0x183100 VAddr 0x007fb410000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0283 PSN 0xa28ad1 OUT 0x10 RKey 0x183100 VAddr 0x007fb410800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0284 PSN 0x93ef11 OUT 0x10 RKey 0x183100 VAddr 0x007fb411000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0285 PSN 0x223c55 OUT 0x10 RKey 0x183100 VAddr 0x007fb411800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0286 PSN 0xc377b OUT 0x10 RKey 0x183100 VAddr 0x007fb412000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0287 PSN 0x92038b OUT 0x10 RKey 0x183100 VAddr 0x007fb412800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0288 PSN 0xf1b258 OUT 0x10 RKey 0x183100 VAddr 0x007fb413000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0289 PSN 0x92c83b OUT 0x10 RKey 0x183100 VAddr 0x007fb413800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x028a PSN 0x20a98d OUT 0x10 RKey 0x183100 VAddr 0x007fb414000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x028b PSN 0x88e954 OUT 0x10 RKey 0x183100 VAddr 0x007fb414800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x028c PSN 0xe4799e OUT 0x10 RKey 0x183100 VAddr 0x007fb415000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x028d PSN 0xe4f010 OUT 0x10 RKey 0x183100 VAddr 0x007fb415800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x028e PSN 0x7b1186 OUT 0x10 RKey 0x183100 VAddr 0x007fb416000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x028f PSN 0x825084 OUT 0x10 RKey 0x183100 VAddr 0x007fb416800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0290 PSN 0x78d828 OUT 0x10 RKey 0x183100 VAddr 0x007fb417000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0291 PSN 0x483c02 OUT 0x10 RKey 0x183100 VAddr 0x007fb417800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0292 PSN 0x1e4726 OUT 0x10 RKey 0x183100 VAddr 0x007fb418000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0293 PSN 0xc593b1 OUT 0x10 RKey 0x183100 VAddr 0x007fb418800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0294 PSN 0x569a6f OUT 0x10 RKey 0x183100 VAddr 0x007fb419000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0295 PSN 0xbf70f9 OUT 0x10 RKey 0x183100 VAddr 0x007fb419800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0296 PSN 0xcf9c9c OUT 0x10 RKey 0x183100 VAddr 0x007fb41a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0297 PSN 0x494572 OUT 0x10 RKey 0x183100 VAddr 0x007fb41a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0298 PSN 0xee01b8 OUT 0x10 RKey 0x183100 VAddr 0x007fb41b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0299 PSN 0xe74d2a OUT 0x10 RKey 0x183100 VAddr 0x007fb41b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x029a PSN 0xb854ad OUT 0x10 RKey 0x183100 VAddr 0x007fb41c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x029b PSN 0x543c3e OUT 0x10 RKey 0x183100 VAddr 0x007fb41c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x029c PSN 0xedf51 OUT 0x10 RKey 0x183100 VAddr 0x007fb41d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x029d PSN 0x3b3bc9 OUT 0x10 RKey 0x183100 VAddr 0x007fb41d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x029e PSN 0x30117d OUT 0x10 RKey 0x183100 VAddr 0x007fb41e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x029f PSN 0x703a72 OUT 0x10 RKey 0x183100 VAddr 0x007fb41e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02a0 PSN 0x3e969 OUT 0x10 RKey 0x183100 VAddr 0x007fb41f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02a1 PSN 0xec51db OUT 0x10 RKey 0x183100 VAddr 0x007fb41f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0282 PSN 0xe41b5c OUT 0x10 RKey 0x183000 VAddr 0x007f1790000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0283 PSN 0xc22b4d OUT 0x10 RKey 0x183000 VAddr 0x007f1790800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0284 PSN 0x8aabdd OUT 0x10 RKey 0x183000 VAddr 0x007f1791000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0285 PSN 0xdfe731 OUT 0x10 RKey 0x183000 VAddr 0x007f1791800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0286 PSN 0x1f9f27 OUT 0x10 RKey 0x183000 VAddr 0x007f1792000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0287 PSN 0x89afc7 OUT 0x10 RKey 0x183000 VAddr 0x007f1792800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0288 PSN 0x73efe4 OUT 0x10 RKey 0x183000 VAddr 0x007f1793000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0289 PSN 0x62c4d7 OUT 0x10 RKey 0x183000 VAddr 0x007f1793800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x028a PSN 0x735ff9 OUT 0x10 RKey 0x183000 VAddr 0x007f1794000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x028b PSN 0x359d50 OUT 0x10 RKey 0x183000 VAddr 0x007f1794800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x028c PSN 0x7183ea OUT 0x10 RKey 0x183000 VAddr 0x007f1795000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x028d PSN 0x429a6c OUT 0x10 RKey 0x183000 VAddr 0x007f1795800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x028e PSN 0x3b42b2 OUT 0x10 RKey 0x183000 VAddr 0x007f1796000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x028f PSN 0x14c840 OUT 0x10 RKey 0x183000 VAddr 0x007f1796800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0290 PSN 0xb8bb34 OUT 0x10 RKey 0x183000 VAddr 0x007f1797000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0291 PSN 0x88b01e OUT 0x10 RKey 0x183000 VAddr 0x007f1797800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0292 PSN 0xb0df12 OUT 0x10 RKey 0x183000 VAddr 0x007f1798000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0293 PSN 0x3e4b2d OUT 0x10 RKey 0x183000 VAddr 0x007f1798800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0294 PSN 0xe6223b OUT 0x10 RKey 0x183000 VAddr 0x007f1799000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0295 PSN 0xed8ad5 OUT 0x10 RKey 0x183000 VAddr 0x007f1799800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0296 PSN 0x7c4748 OUT 0x10 RKey 0x183000 VAddr 0x007f179a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0297 PSN 0xb478ae OUT 0x10 RKey 0x183000 VAddr 0x007f179a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0298 PSN 0xeaba44 OUT 0x10 RKey 0x183000 VAddr 0x007f179b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0299 PSN 0x5fa8c6 OUT 0x10 RKey 0x183000 VAddr 0x007f179b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x029a PSN 0x157e19 OUT 0x10 RKey 0x183000 VAddr 0x007f179c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x029b PSN 0xc5e73a OUT 0x10 RKey 0x183000 VAddr 0x007f179c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x029c PSN 0x63149d OUT 0x10 RKey 0x183000 VAddr 0x007f179d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x029d PSN 0x83525 OUT 0x10 RKey 0x183000 VAddr 0x007f179d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x029e PSN 0x4ee5a9 OUT 0x10 RKey 0x183000 VAddr 0x007f179e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x029f PSN 0xc0192e OUT 0x10 RKey 0x183000 VAddr 0x007f179e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02a0 PSN 0x72a775 OUT 0x10 RKey 0x183000 VAddr 0x007f179f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02a1 PSN 0xe204f7 OUT 0x10 RKey 0x183000 VAddr 0x007f179f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.080537            0.080367            5.022949
 4          32000            0.17               0.17   		     5.179606
 8          32000            0.33               0.33   		     5.190339
 16         32000            0.67               0.66   		     5.175967
 32         32000            1.32               1.32   		     5.153551
 64         32000            2.65               2.64   		     5.152207
 128        32000            5.32               5.30   		     5.171793
 256        32000            10.59              10.54  		     5.147624
 512        32000            21.19              21.11  		     5.153220
 1024       32000            42.37              42.30  		     5.163781
 2048       32000            84.16              83.92  		     5.122074
 4096       32000            169.88             168.95 		     5.155819
 8192       32000            208.57             208.31 		     3.178497
 16384      32000            209.16             209.02 		     1.594671
 32768      32000            209.23             209.21 		     0.798054
 65536      32000            209.12             209.10 		     0.398834
 131072     32000            209.27             209.26 		     0.199570
 262144     32000            209.24             209.24 		     0.099774
 524288     32000            209.25             209.25 		     0.049890
 1048576    32000            186.55             186.55 		     0.022238
 2097152    32000            171.29             171.29 		     0.010210
 4194304    32000            171.22             171.22 		     0.005103
 8388608    32000            171.21             171.21 		     0.002551
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fb400000000
destroying current CUDA Ctx
