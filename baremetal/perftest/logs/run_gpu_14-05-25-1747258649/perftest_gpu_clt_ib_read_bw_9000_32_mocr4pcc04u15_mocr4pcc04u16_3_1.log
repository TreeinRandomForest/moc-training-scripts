initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 19655, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fb4e0000000 pointer=0x7fb4e0000000
using DMA-BUF for GPU buffer address at 0x7fb4e0000000 aligned at 0x7fb4e0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fb4e0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x08e8 PSN 0x713066 OUT 0x10 RKey 0x183100 VAddr 0x007fb4f0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08e9 PSN 0xf31c8f OUT 0x10 RKey 0x183100 VAddr 0x007fb4f0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08ea PSN 0xfab0f7 OUT 0x10 RKey 0x183100 VAddr 0x007fb4f1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08eb PSN 0x1f6f43 OUT 0x10 RKey 0x183100 VAddr 0x007fb4f1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08ec PSN 0x4bad1 OUT 0x10 RKey 0x183100 VAddr 0x007fb4f2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08ed PSN 0xa93329 OUT 0x10 RKey 0x183100 VAddr 0x007fb4f2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08ee PSN 0x40ec9e OUT 0x10 RKey 0x183100 VAddr 0x007fb4f3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08ef PSN 0x317c09 OUT 0x10 RKey 0x183100 VAddr 0x007fb4f3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08f0 PSN 0x264c43 OUT 0x10 RKey 0x183100 VAddr 0x007fb4f4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08f1 PSN 0xe6b4d2 OUT 0x10 RKey 0x183100 VAddr 0x007fb4f4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08f2 PSN 0xcf5244 OUT 0x10 RKey 0x183100 VAddr 0x007fb4f5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08f3 PSN 0x9052be OUT 0x10 RKey 0x183100 VAddr 0x007fb4f5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08f4 PSN 0x84699c OUT 0x10 RKey 0x183100 VAddr 0x007fb4f6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08f5 PSN 0xe895e2 OUT 0x10 RKey 0x183100 VAddr 0x007fb4f6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08f6 PSN 0xfed52e OUT 0x10 RKey 0x183100 VAddr 0x007fb4f7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08f7 PSN 0x305b90 OUT 0x10 RKey 0x183100 VAddr 0x007fb4f7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08f8 PSN 0x354a9c OUT 0x10 RKey 0x183100 VAddr 0x007fb4f8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08f9 PSN 0x7610ef OUT 0x10 RKey 0x183100 VAddr 0x007fb4f8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08fa PSN 0x29a1d5 OUT 0x10 RKey 0x183100 VAddr 0x007fb4f9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08fb PSN 0x473b67 OUT 0x10 RKey 0x183100 VAddr 0x007fb4f9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08fc PSN 0xe7a172 OUT 0x10 RKey 0x183100 VAddr 0x007fb4fa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08fd PSN 0x239890 OUT 0x10 RKey 0x183100 VAddr 0x007fb4fa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08fe PSN 0x38597e OUT 0x10 RKey 0x183100 VAddr 0x007fb4fb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x08ff PSN 0xf29078 OUT 0x10 RKey 0x183100 VAddr 0x007fb4fb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0900 PSN 0xe410e3 OUT 0x10 RKey 0x183100 VAddr 0x007fb4fc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0901 PSN 0xd3e33c OUT 0x10 RKey 0x183100 VAddr 0x007fb4fc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0902 PSN 0x992d77 OUT 0x10 RKey 0x183100 VAddr 0x007fb4fd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0903 PSN 0x5ca5f7 OUT 0x10 RKey 0x183100 VAddr 0x007fb4fd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0904 PSN 0x379b13 OUT 0x10 RKey 0x183100 VAddr 0x007fb4fe000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0905 PSN 0x8a9350 OUT 0x10 RKey 0x183100 VAddr 0x007fb4fe800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0906 PSN 0xbb33ef OUT 0x10 RKey 0x183100 VAddr 0x007fb4ff000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0907 PSN 0x7370e9 OUT 0x10 RKey 0x183100 VAddr 0x007fb4ff800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x08e8 PSN 0x93d239 OUT 0x10 RKey 0x183000 VAddr 0x007f6090000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08e9 PSN 0x999566 OUT 0x10 RKey 0x183000 VAddr 0x007f6090800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08ea PSN 0xa14e82 OUT 0x10 RKey 0x183000 VAddr 0x007f6091000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08eb PSN 0xbf6572 OUT 0x10 RKey 0x183000 VAddr 0x007f6091800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08ec PSN 0xa2c6d4 OUT 0x10 RKey 0x183000 VAddr 0x007f6092000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08ed PSN 0x830270 OUT 0x10 RKey 0x183000 VAddr 0x007f6092800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08ee PSN 0xabf7d9 OUT 0x10 RKey 0x183000 VAddr 0x007f6093000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08ef PSN 0x404628 OUT 0x10 RKey 0x183000 VAddr 0x007f6093800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08f0 PSN 0x9e3576 OUT 0x10 RKey 0x183000 VAddr 0x007f6094000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08f1 PSN 0x7cd189 OUT 0x10 RKey 0x183000 VAddr 0x007f6094800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08f2 PSN 0x39f62f OUT 0x10 RKey 0x183000 VAddr 0x007f6095000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08f3 PSN 0xe13fcd OUT 0x10 RKey 0x183000 VAddr 0x007f6095800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08f4 PSN 0xc8d2ff OUT 0x10 RKey 0x183000 VAddr 0x007f6096000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08f5 PSN 0xfc6709 OUT 0x10 RKey 0x183000 VAddr 0x007f6096800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08f6 PSN 0x4becc9 OUT 0x10 RKey 0x183000 VAddr 0x007f6097000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08f7 PSN 0x1caa8f OUT 0x10 RKey 0x183000 VAddr 0x007f6097800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08f8 PSN 0xe0072f OUT 0x10 RKey 0x183000 VAddr 0x007f6098000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08f9 PSN 0x186d86 OUT 0x10 RKey 0x183000 VAddr 0x007f6098800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08fa PSN 0xaeb820 OUT 0x10 RKey 0x183000 VAddr 0x007f6099000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08fb PSN 0x1d1b56 OUT 0x10 RKey 0x183000 VAddr 0x007f6099800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08fc PSN 0x7cb435 OUT 0x10 RKey 0x183000 VAddr 0x007f609a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08fd PSN 0x3bc797 OUT 0x10 RKey 0x183000 VAddr 0x007f609a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08fe PSN 0x38a979 OUT 0x10 RKey 0x183000 VAddr 0x007f609b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x08ff PSN 0x542057 OUT 0x10 RKey 0x183000 VAddr 0x007f609b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0900 PSN 0x44acd6 OUT 0x10 RKey 0x183000 VAddr 0x007f609c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0901 PSN 0x169bb3 OUT 0x10 RKey 0x183000 VAddr 0x007f609c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0902 PSN 0x70a222 OUT 0x10 RKey 0x183000 VAddr 0x007f609d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0903 PSN 0x8ef4c6 OUT 0x10 RKey 0x183000 VAddr 0x007f609d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0904 PSN 0x452336 OUT 0x10 RKey 0x183000 VAddr 0x007f609e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0905 PSN 0xe0fc37 OUT 0x10 RKey 0x183000 VAddr 0x007f609e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0906 PSN 0xb9684a OUT 0x10 RKey 0x183000 VAddr 0x007f609f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0907 PSN 0x9d7da8 OUT 0x10 RKey 0x183000 VAddr 0x007f609f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.085308            0.084874            5.304653
 4          32000            0.18               0.18   		     5.474390
 8          32000            0.35               0.35   		     5.494345
 16         32000            0.70               0.70   		     5.482560
 32         32000            1.41               1.40   		     5.480090
 64         32000            2.82               2.81   		     5.491441
 128        32000            5.62               5.60   		     5.468739
 256        32000            11.16              11.14  		     5.437050
 512        32000            22.37              22.28  		     5.439578
 1024       32000            46.31              46.19  		     5.637842
 2048       32000            95.75              94.80  		     5.786315
 4096       32000            195.56             194.74 		     5.943007
 8192       32000            197.13             196.92 		     3.004751
 16384      32000            197.27             197.24 		     1.504812
 32768      32000            197.40             197.35 		     0.752814
 65536      32000            197.27             197.24 		     0.376198
 131072     32000            197.33             197.33 		     0.188188
 262144     32000            197.36             197.36 		     0.094107
 524288     32000            197.39             197.39 		     0.047062
 1048576    32000            178.24             178.24 		     0.021248
 2097152    32000            163.76             163.76 		     0.009761
 4194304    32000            163.73             163.73 		     0.004879
 8388608    32000            163.72             163.72 		     0.002440
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fb4e0000000
destroying current CUDA Ctx
