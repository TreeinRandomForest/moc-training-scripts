initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 27438, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f16f8000000 pointer=0x7f16f8000000
using DMA-BUF for GPU buffer address at 0x7f16f8000000 aligned at 0x7f16f8000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f16f8000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0ec0 PSN 0x9c53e9 OUT 0x10 RKey 0x182f00 VAddr 0x007f1700000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ec1 PSN 0x867a1f OUT 0x10 RKey 0x182f00 VAddr 0x007f1700800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ec2 PSN 0xff5a7d OUT 0x10 RKey 0x182f00 VAddr 0x007f1701000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ec3 PSN 0x687488 OUT 0x10 RKey 0x182f00 VAddr 0x007f1701800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ec4 PSN 0xfd83fb OUT 0x10 RKey 0x182f00 VAddr 0x007f1702000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ec5 PSN 0x810941 OUT 0x10 RKey 0x182f00 VAddr 0x007f1702800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ec6 PSN 0x17180c OUT 0x10 RKey 0x182f00 VAddr 0x007f1703000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ec7 PSN 0x454115 OUT 0x10 RKey 0x182f00 VAddr 0x007f1703800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ec8 PSN 0x206d95 OUT 0x10 RKey 0x182f00 VAddr 0x007f1704000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ec9 PSN 0x6503f3 OUT 0x10 RKey 0x182f00 VAddr 0x007f1704800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0eca PSN 0xa4361b OUT 0x10 RKey 0x182f00 VAddr 0x007f1705000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ecb PSN 0xa60c12 OUT 0x10 RKey 0x182f00 VAddr 0x007f1705800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ecc PSN 0x2c3d96 OUT 0x10 RKey 0x182f00 VAddr 0x007f1706000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ecd PSN 0xbee68b OUT 0x10 RKey 0x182f00 VAddr 0x007f1706800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ece PSN 0xc8fed OUT 0x10 RKey 0x182f00 VAddr 0x007f1707000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ecf PSN 0x6e05ad OUT 0x10 RKey 0x182f00 VAddr 0x007f1707800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0ec0 PSN 0x83522c OUT 0x10 RKey 0x183000 VAddr 0x007f8fee000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ec1 PSN 0x14eea6 OUT 0x10 RKey 0x183000 VAddr 0x007f8fee800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ec2 PSN 0xcc41f8 OUT 0x10 RKey 0x183000 VAddr 0x007f8fef000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ec3 PSN 0x385e7 OUT 0x10 RKey 0x183000 VAddr 0x007f8fef800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ec4 PSN 0x33436e OUT 0x10 RKey 0x183000 VAddr 0x007f8ff0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ec5 PSN 0x68df38 OUT 0x10 RKey 0x183000 VAddr 0x007f8ff0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ec6 PSN 0xbd1c37 OUT 0x10 RKey 0x183000 VAddr 0x007f8ff1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ec7 PSN 0x57a964 OUT 0x10 RKey 0x183000 VAddr 0x007f8ff1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ec8 PSN 0x81d138 OUT 0x10 RKey 0x183000 VAddr 0x007f8ff2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ec9 PSN 0xa4e25a OUT 0x10 RKey 0x183000 VAddr 0x007f8ff2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0eca PSN 0x9a71f6 OUT 0x10 RKey 0x183000 VAddr 0x007f8ff3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ecb PSN 0x284a51 OUT 0x10 RKey 0x183000 VAddr 0x007f8ff3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ecc PSN 0xa15869 OUT 0x10 RKey 0x183000 VAddr 0x007f8ff4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ecd PSN 0x38e462 OUT 0x10 RKey 0x183000 VAddr 0x007f8ff4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ece PSN 0x40ce78 OUT 0x10 RKey 0x183000 VAddr 0x007f8ff5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ecf PSN 0x188dc OUT 0x10 RKey 0x183000 VAddr 0x007f8ff5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.058728            0.055442            3.465116
 4          16000            0.12               0.12   		     3.794184
 8          16000            0.24               0.24   		     3.783830
 16         16000            0.49               0.48   		     3.782882
 32         16000            0.97               0.97   		     3.772882
 64         16000            1.94               1.93   		     3.763812
 128        16000            3.89               3.86   		     3.774386
 256        16000            7.74               7.72   		     3.768403
 512        16000            15.84              15.72  		     3.839094
 1024       16000            31.45              31.32  		     3.822913
 2048       16000            63.12              62.70  		     3.826836
 4096       16000            74.54              69.13  		     2.109659
 8192       16000            189.78             189.44 		     2.890586
 16384      16000            187.25             137.29 		     1.047406
 32768      16000            189.53             174.87 		     0.667062
 65536      16000            198.12             198.12 		     0.377878
 131072     16000            198.11             198.10 		     0.188927
 262144     16000            197.99             197.98 		     0.094405
 524288     16000            195.42             195.42 		     0.046592
 1048576    16000            197.91             197.91 		     0.023592
 2097152    16000            185.47             185.38 		     0.011050
 4194304    16000            163.63             163.63 		     0.004876
 8388608    16000            163.67             163.67 		     0.002439
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f16f8000000
destroying current CUDA Ctx
