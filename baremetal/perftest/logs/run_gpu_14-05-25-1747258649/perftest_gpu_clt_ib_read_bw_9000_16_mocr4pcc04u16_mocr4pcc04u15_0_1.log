initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 21502, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f5fa0000000 pointer=0x7f5fa0000000
using DMA-BUF for GPU buffer address at 0x7f5fa0000000 aligned at 0x7f5fa0000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f5fa0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0ad0 PSN 0x9ae7d8 OUT 0x10 RKey 0x182f00 VAddr 0x007f5fa8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ad1 PSN 0x2830e2 OUT 0x10 RKey 0x182f00 VAddr 0x007f5fa8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ad2 PSN 0xd15d84 OUT 0x10 RKey 0x182f00 VAddr 0x007f5fa9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ad3 PSN 0x0883 OUT 0x10 RKey 0x182f00 VAddr 0x007f5fa9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ad4 PSN 0xdf07da OUT 0x10 RKey 0x182f00 VAddr 0x007f5faa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ad5 PSN 0x948934 OUT 0x10 RKey 0x182f00 VAddr 0x007f5faa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ad6 PSN 0x5ce483 OUT 0x10 RKey 0x182f00 VAddr 0x007f5fab000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ad7 PSN 0x6439c0 OUT 0x10 RKey 0x182f00 VAddr 0x007f5fab800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ad8 PSN 0x5df064 OUT 0x10 RKey 0x182f00 VAddr 0x007f5fac000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ad9 PSN 0xefb016 OUT 0x10 RKey 0x182f00 VAddr 0x007f5fac800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ada PSN 0x9af302 OUT 0x10 RKey 0x182f00 VAddr 0x007f5fad000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0adb PSN 0x60046d OUT 0x10 RKey 0x182f00 VAddr 0x007f5fad800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0adc PSN 0x60be55 OUT 0x10 RKey 0x182f00 VAddr 0x007f5fae000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0add PSN 0xd951de OUT 0x10 RKey 0x182f00 VAddr 0x007f5fae800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0ade PSN 0x3cd444 OUT 0x10 RKey 0x182f00 VAddr 0x007f5faf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0adf PSN 0x9548b8 OUT 0x10 RKey 0x182f00 VAddr 0x007f5faf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0ad0 PSN 0x400bca OUT 0x10 RKey 0x183000 VAddr 0x007f1440000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ad1 PSN 0xdbeaec OUT 0x10 RKey 0x183000 VAddr 0x007f1440800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ad2 PSN 0xb48fc6 OUT 0x10 RKey 0x183000 VAddr 0x007f1441000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ad3 PSN 0xbbba9d OUT 0x10 RKey 0x183000 VAddr 0x007f1441800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ad4 PSN 0xc538ec OUT 0x10 RKey 0x183000 VAddr 0x007f1442000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ad5 PSN 0x4599de OUT 0x10 RKey 0x183000 VAddr 0x007f1442800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ad6 PSN 0x71b8e5 OUT 0x10 RKey 0x183000 VAddr 0x007f1443000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ad7 PSN 0x6ab37a OUT 0x10 RKey 0x183000 VAddr 0x007f1443800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ad8 PSN 0xf4e096 OUT 0x10 RKey 0x183000 VAddr 0x007f1444000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ad9 PSN 0x18e160 OUT 0x10 RKey 0x183000 VAddr 0x007f1444800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ada PSN 0xa56b84 OUT 0x10 RKey 0x183000 VAddr 0x007f1445000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0adb PSN 0xf21fc7 OUT 0x10 RKey 0x183000 VAddr 0x007f1445800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0adc PSN 0x213fa7 OUT 0x10 RKey 0x183000 VAddr 0x007f1446000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0add PSN 0x980dc8 OUT 0x10 RKey 0x183000 VAddr 0x007f1446800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0ade PSN 0xff12e6 OUT 0x10 RKey 0x183000 VAddr 0x007f1447000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0adf PSN 0xe77fb2 OUT 0x10 RKey 0x183000 VAddr 0x007f1447800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.084706            0.084241            5.265081
 4          16000            0.17               0.17   		     5.349346
 8          16000            0.34               0.34   		     5.313433
 16         16000            0.69               0.68   		     5.333529
 32         16000            1.36               1.36   		     5.300382
 64         16000            2.76               2.72   		     5.321767
 128        16000            5.50               5.47   		     5.337212
 256        16000            10.92              10.87  		     5.306553
 512        16000            21.79              21.69  		     5.294472
 1024       16000            44.74              44.61  		     5.445659
 2048       16000            94.04              93.70  		     5.719147
 4096       16000            202.55             201.19 		     6.139937
 8192       16000            200.08             199.56 		     3.045061
 16384      16000            204.94             204.89 		     1.563166
 32768      16000            207.17             207.17 		     0.790301
 65536      16000            206.12             206.11 		     0.393117
 131072     16000            207.90             207.89 		     0.198263
 262144     16000            208.49             208.49 		     0.099416
 524288     16000            209.43             209.42 		     0.049930
 1048576    16000            209.35             209.34 		     0.024956
 2097152    16000            194.59             194.59 		     0.011598
 4194304    16000            171.11             171.11 		     0.005099
 8388608    16000            171.10             171.10 		     0.002550
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f5fa0000000
destroying current CUDA Ctx
