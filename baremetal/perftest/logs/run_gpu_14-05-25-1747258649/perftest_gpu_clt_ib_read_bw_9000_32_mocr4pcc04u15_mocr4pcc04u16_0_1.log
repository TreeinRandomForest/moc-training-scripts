initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 10910, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fa5a0000000 pointer=0x7fa5a0000000
using DMA-BUF for GPU buffer address at 0x7fa5a0000000 aligned at 0x7fa5a0000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fa5a0000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0300 PSN 0xc5a615 OUT 0x10 RKey 0x183100 VAddr 0x007fa5b0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0301 PSN 0x81fedb OUT 0x10 RKey 0x183100 VAddr 0x007fa5b0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0302 PSN 0xa7c689 OUT 0x10 RKey 0x183100 VAddr 0x007fa5b1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0303 PSN 0x413da4 OUT 0x10 RKey 0x183100 VAddr 0x007fa5b1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0304 PSN 0xca4ce7 OUT 0x10 RKey 0x183100 VAddr 0x007fa5b2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0305 PSN 0xc69dbd OUT 0x10 RKey 0x183100 VAddr 0x007fa5b2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0306 PSN 0x6eb8d8 OUT 0x10 RKey 0x183100 VAddr 0x007fa5b3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0307 PSN 0x1bfff1 OUT 0x10 RKey 0x183100 VAddr 0x007fa5b3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0308 PSN 0xd95941 OUT 0x10 RKey 0x183100 VAddr 0x007fa5b4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0309 PSN 0x6de42f OUT 0x10 RKey 0x183100 VAddr 0x007fa5b4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x030a PSN 0x3197a7 OUT 0x10 RKey 0x183100 VAddr 0x007fa5b5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x030b PSN 0x8c5cae OUT 0x10 RKey 0x183100 VAddr 0x007fa5b5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x030c PSN 0x78b802 OUT 0x10 RKey 0x183100 VAddr 0x007fa5b6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x030d PSN 0xdc0e87 OUT 0x10 RKey 0x183100 VAddr 0x007fa5b6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x030e PSN 0xb2fe39 OUT 0x10 RKey 0x183100 VAddr 0x007fa5b7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x030f PSN 0x734409 OUT 0x10 RKey 0x183100 VAddr 0x007fa5b7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0310 PSN 0xa488ea OUT 0x10 RKey 0x183100 VAddr 0x007fa5b8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0311 PSN 0x2c1f5c OUT 0x10 RKey 0x183100 VAddr 0x007fa5b8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0312 PSN 0xa94107 OUT 0x10 RKey 0x183100 VAddr 0x007fa5b9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0313 PSN 0x3362e8 OUT 0x10 RKey 0x183100 VAddr 0x007fa5b9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0314 PSN 0x67e629 OUT 0x10 RKey 0x183100 VAddr 0x007fa5ba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0315 PSN 0xbad144 OUT 0x10 RKey 0x183100 VAddr 0x007fa5ba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0316 PSN 0xf3a958 OUT 0x10 RKey 0x183100 VAddr 0x007fa5bb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0317 PSN 0xdfdf80 OUT 0x10 RKey 0x183100 VAddr 0x007fa5bb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0318 PSN 0xc65a81 OUT 0x10 RKey 0x183100 VAddr 0x007fa5bc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0319 PSN 0x6fa2b8 OUT 0x10 RKey 0x183100 VAddr 0x007fa5bc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x031a PSN 0xb99079 OUT 0x10 RKey 0x183100 VAddr 0x007fa5bd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x031b PSN 0x690d07 OUT 0x10 RKey 0x183100 VAddr 0x007fa5bd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x031c PSN 0x4e501a OUT 0x10 RKey 0x183100 VAddr 0x007fa5be000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x031d PSN 0xd77e14 OUT 0x10 RKey 0x183100 VAddr 0x007fa5be800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x031e PSN 0x8db49a OUT 0x10 RKey 0x183100 VAddr 0x007fa5bf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x031f PSN 0xdb6881 OUT 0x10 RKey 0x183100 VAddr 0x007fa5bf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0300 PSN 0xb7553c OUT 0x10 RKey 0x183000 VAddr 0x007f3250000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0301 PSN 0x310fad OUT 0x10 RKey 0x183000 VAddr 0x007f3250800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0302 PSN 0x7028bd OUT 0x10 RKey 0x183000 VAddr 0x007f3251000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0303 PSN 0x475291 OUT 0x10 RKey 0x183000 VAddr 0x007f3251800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0304 PSN 0x209707 OUT 0x10 RKey 0x183000 VAddr 0x007f3252000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0305 PSN 0x267a27 OUT 0x10 RKey 0x183000 VAddr 0x007f3252800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0306 PSN 0x885ac4 OUT 0x10 RKey 0x183000 VAddr 0x007f3253000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0307 PSN 0x998637 OUT 0x10 RKey 0x183000 VAddr 0x007f3253800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0308 PSN 0xfff5d9 OUT 0x10 RKey 0x183000 VAddr 0x007f3254000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0309 PSN 0x38adb0 OUT 0x10 RKey 0x183000 VAddr 0x007f3254800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x030a PSN 0xf5bcca OUT 0x10 RKey 0x183000 VAddr 0x007f3255000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x030b PSN 0x2811cc OUT 0x10 RKey 0x183000 VAddr 0x007f3255800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x030c PSN 0xaf5692 OUT 0x10 RKey 0x183000 VAddr 0x007f3256000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x030d PSN 0xdc7ea0 OUT 0x10 RKey 0x183000 VAddr 0x007f3256800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x030e PSN 0x1ba214 OUT 0x10 RKey 0x183000 VAddr 0x007f3257000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x030f PSN 0x923d7e OUT 0x10 RKey 0x183000 VAddr 0x007f3257800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0310 PSN 0x4650f2 OUT 0x10 RKey 0x183000 VAddr 0x007f3258000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0311 PSN 0xaf078d OUT 0x10 RKey 0x183000 VAddr 0x007f3258800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0312 PSN 0xa4971b OUT 0x10 RKey 0x183000 VAddr 0x007f3259000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0313 PSN 0x868e35 OUT 0x10 RKey 0x183000 VAddr 0x007f3259800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0314 PSN 0x2af728 OUT 0x10 RKey 0x183000 VAddr 0x007f325a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0315 PSN 0x989b0e OUT 0x10 RKey 0x183000 VAddr 0x007f325a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0316 PSN 0x6f9d24 OUT 0x10 RKey 0x183000 VAddr 0x007f325b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0317 PSN 0x498226 OUT 0x10 RKey 0x183000 VAddr 0x007f325b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0318 PSN 0x734bf9 OUT 0x10 RKey 0x183000 VAddr 0x007f325c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0319 PSN 0x2dcf9a OUT 0x10 RKey 0x183000 VAddr 0x007f325c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x031a PSN 0xe7457d OUT 0x10 RKey 0x183000 VAddr 0x007f325d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x031b PSN 0xba4485 OUT 0x10 RKey 0x183000 VAddr 0x007f325d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x031c PSN 0x6fb189 OUT 0x10 RKey 0x183000 VAddr 0x007f325e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x031d PSN 0x62278e OUT 0x10 RKey 0x183000 VAddr 0x007f325e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x031e PSN 0xdd0655 OUT 0x10 RKey 0x183000 VAddr 0x007f325f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x031f PSN 0xe9aa57 OUT 0x10 RKey 0x183000 VAddr 0x007f325f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.081448            0.080892            5.055764
 4          32000            0.17               0.17   		     5.213195
 8          32000            0.33               0.33   		     5.211625
 16         32000            0.67               0.67   		     5.232495
 32         32000            1.35               1.34   		     5.235534
 64         32000            2.69               2.68   		     5.241434
 128        32000            5.36               5.34   		     5.215209
 256        32000            10.72              10.68  		     5.213233
 512        32000            21.43              21.39  		     5.222921
 1024       32000            43.68              43.61  		     5.323990
 2048       32000            89.04              87.76  		     5.356222
 4096       32000            199.26             198.16 		     6.047423
 8192       32000            208.57             208.46 		     3.180788
 16384      32000            209.16             209.05 		     1.594939
 32768      32000            209.23             209.20 		     0.798017
 65536      32000            209.12             209.12 		     0.398863
 131072     32000            209.25             209.25 		     0.199552
 262144     32000            209.25             209.25 		     0.099776
 524288     32000            209.30             209.30 		     0.049901
 1048576    32000            186.80             186.80 		     0.022269
 2097152    32000            171.28             171.28 		     0.010209
 4194304    32000            171.22             171.22 		     0.005103
 8388608    32000            171.24             171.24 		     0.002552
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fa5a0000000
destroying current CUDA Ctx
