initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 23611, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 536870912 bytes GPU buffer
allocated GPU buffer address at 00007fe720000000 pointer=0x7fe720000000
using DMA-BUF for GPU buffer address at 0x7fe720000000 aligned at 0x7fe720000000 with aligned size 536870912
Calling ibv_reg_dmabuf_mr(offset=0, size=536870912, addr=0x7fe720000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 32		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 5
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0c5a PSN 0x7bea74 OUT 0x10 RKey 0x183000 VAddr 0x007fe730000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c5b PSN 0x94e885 OUT 0x10 RKey 0x183000 VAddr 0x007fe730800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c5c PSN 0xe58cb5 OUT 0x10 RKey 0x183000 VAddr 0x007fe731000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c5d PSN 0xb3b329 OUT 0x10 RKey 0x183000 VAddr 0x007fe731800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c5e PSN 0x2e47bf OUT 0x10 RKey 0x183000 VAddr 0x007fe732000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c5f PSN 0x60087f OUT 0x10 RKey 0x183000 VAddr 0x007fe732800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c60 PSN 0xd063c OUT 0x10 RKey 0x183000 VAddr 0x007fe733000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c61 PSN 0xc4584f OUT 0x10 RKey 0x183000 VAddr 0x007fe733800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c62 PSN 0x1cfa11 OUT 0x10 RKey 0x183000 VAddr 0x007fe734000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c63 PSN 0xfdc988 OUT 0x10 RKey 0x183000 VAddr 0x007fe734800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c64 PSN 0x6a7c2 OUT 0x10 RKey 0x183000 VAddr 0x007fe735000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c65 PSN 0x16ed64 OUT 0x10 RKey 0x183000 VAddr 0x007fe735800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c66 PSN 0xcd664a OUT 0x10 RKey 0x183000 VAddr 0x007fe736000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c67 PSN 0x687ff8 OUT 0x10 RKey 0x183000 VAddr 0x007fe736800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c68 PSN 0xd448c OUT 0x10 RKey 0x183000 VAddr 0x007fe737000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c69 PSN 0xc3a96 OUT 0x10 RKey 0x183000 VAddr 0x007fe737800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c6a PSN 0xbaa42a OUT 0x10 RKey 0x183000 VAddr 0x007fe738000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c6b PSN 0x9ac665 OUT 0x10 RKey 0x183000 VAddr 0x007fe738800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c6c PSN 0x9ae913 OUT 0x10 RKey 0x183000 VAddr 0x007fe739000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c6d PSN 0xac44cd OUT 0x10 RKey 0x183000 VAddr 0x007fe739800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c6e PSN 0x6645e0 OUT 0x10 RKey 0x183000 VAddr 0x007fe73a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c6f PSN 0x326f66 OUT 0x10 RKey 0x183000 VAddr 0x007fe73a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c70 PSN 0xd6169c OUT 0x10 RKey 0x183000 VAddr 0x007fe73b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c71 PSN 0xad0a3e OUT 0x10 RKey 0x183000 VAddr 0x007fe73b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c72 PSN 0x39ce31 OUT 0x10 RKey 0x183000 VAddr 0x007fe73c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c73 PSN 0x519172 OUT 0x10 RKey 0x183000 VAddr 0x007fe73c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c74 PSN 0x68de75 OUT 0x10 RKey 0x183000 VAddr 0x007fe73d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c75 PSN 0xf7361d OUT 0x10 RKey 0x183000 VAddr 0x007fe73d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c76 PSN 0x911f41 OUT 0x10 RKey 0x183000 VAddr 0x007fe73e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c77 PSN 0xd12ee6 OUT 0x10 RKey 0x183000 VAddr 0x007fe73e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c78 PSN 0xdc36cd OUT 0x10 RKey 0x183000 VAddr 0x007fe73f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0c79 PSN 0xbd1d6f OUT 0x10 RKey 0x183000 VAddr 0x007fe73f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0c5a PSN 0xc3227d OUT 0x10 RKey 0x183100 VAddr 0x007fe4b0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c5b PSN 0x156723 OUT 0x10 RKey 0x183100 VAddr 0x007fe4b0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c5c PSN 0x7bdd31 OUT 0x10 RKey 0x183100 VAddr 0x007fe4b1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c5d PSN 0xc9d32c OUT 0x10 RKey 0x183100 VAddr 0x007fe4b1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c5e PSN 0xaa27cf OUT 0x10 RKey 0x183100 VAddr 0x007fe4b2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c5f PSN 0xa34285 OUT 0x10 RKey 0x183100 VAddr 0x007fe4b2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c60 PSN 0xcc9200 OUT 0x10 RKey 0x183100 VAddr 0x007fe4b3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c61 PSN 0xb65f9 OUT 0x10 RKey 0x183100 VAddr 0x007fe4b3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c62 PSN 0xd2faa9 OUT 0x10 RKey 0x183100 VAddr 0x007fe4b4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c63 PSN 0x9b0d77 OUT 0x10 RKey 0x183100 VAddr 0x007fe4b4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c64 PSN 0xe2db4f OUT 0x10 RKey 0x183100 VAddr 0x007fe4b5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c65 PSN 0xaf1b36 OUT 0x10 RKey 0x183100 VAddr 0x007fe4b5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c66 PSN 0xd207ea OUT 0x10 RKey 0x183100 VAddr 0x007fe4b6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c67 PSN 0x8d844f OUT 0x10 RKey 0x183100 VAddr 0x007fe4b6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c68 PSN 0x73d461 OUT 0x10 RKey 0x183100 VAddr 0x007fe4b7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c69 PSN 0xd66311 OUT 0x10 RKey 0x183100 VAddr 0x007fe4b7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c6a PSN 0x19ef52 OUT 0x10 RKey 0x183100 VAddr 0x007fe4b8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c6b PSN 0xa29a4 OUT 0x10 RKey 0x183100 VAddr 0x007fe4b8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c6c PSN 0xd051af OUT 0x10 RKey 0x183100 VAddr 0x007fe4b9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c6d PSN 0xac6a70 OUT 0x10 RKey 0x183100 VAddr 0x007fe4b9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c6e PSN 0x144b11 OUT 0x10 RKey 0x183100 VAddr 0x007fe4ba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c6f PSN 0xaa380c OUT 0x10 RKey 0x183100 VAddr 0x007fe4ba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c70 PSN 0x9a1c80 OUT 0x10 RKey 0x183100 VAddr 0x007fe4bb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c71 PSN 0x14d788 OUT 0x10 RKey 0x183100 VAddr 0x007fe4bb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c72 PSN 0x8b25e9 OUT 0x10 RKey 0x183100 VAddr 0x007fe4bc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c73 PSN 0xd9ae00 OUT 0x10 RKey 0x183100 VAddr 0x007fe4bc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c74 PSN 0x630e21 OUT 0x10 RKey 0x183100 VAddr 0x007fe4bd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c75 PSN 0x587d8f OUT 0x10 RKey 0x183100 VAddr 0x007fe4bd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c76 PSN 0xbb6a02 OUT 0x10 RKey 0x183100 VAddr 0x007fe4be000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c77 PSN 0x71f5dc OUT 0x10 RKey 0x183100 VAddr 0x007fe4be800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c78 PSN 0x5064c2 OUT 0x10 RKey 0x183100 VAddr 0x007fe4bf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0c79 PSN 0xe45989 OUT 0x10 RKey 0x183100 VAddr 0x007fe4bf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          32000           0.081633            0.081260            5.078728
 4          32000            0.17               0.17   		     5.221890
 8          32000            0.34               0.34   		     5.241554
 16         32000            0.67               0.67   		     5.231442
 32         32000            1.34               1.34   		     5.220816
 64         32000            2.69               2.68   		     5.237376
 128        32000            5.37               5.35   		     5.226350
 256        32000            10.72              10.68  		     5.216017
 512        32000            21.43              21.37  		     5.217113
 1024       32000            42.77              42.66  		     5.206927
 2048       32000            83.97              83.21  		     5.078505
 4096       32000            166.42             165.75 		     5.058147
 8192       32000            196.61             196.40 		     2.996763
 16384      32000            193.77             193.74 		     1.478102
 32768      32000            200.89             200.89 		     0.766340
 65536      32000            199.64             199.63 		     0.380761
 131072     32000            199.89             199.89 		     0.190626
 262144     32000            199.69             199.68 		     0.095217
 524288     32000            202.75             202.75 		     0.048339
 1048576    32000            182.75             182.06 		     0.021703
 2097152    32000            167.50             167.47 		     0.009982
 4194304    32000            167.22             167.06 		     0.004979
 8388608    32000            167.58             167.31 		     0.002493
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fe720000000
destroying current CUDA Ctx
