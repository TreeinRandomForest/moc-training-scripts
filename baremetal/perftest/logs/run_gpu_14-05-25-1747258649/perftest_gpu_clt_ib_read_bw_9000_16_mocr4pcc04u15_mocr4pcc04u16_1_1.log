initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 13593, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007fb904000000 pointer=0x7fb904000000
using DMA-BUF for GPU buffer address at 0x7fb904000000 aligned at 0x7fb904000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7fb904000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x04e8 PSN 0x52a503 OUT 0x10 RKey 0x183000 VAddr 0x007fb90c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04e9 PSN 0x72d168 OUT 0x10 RKey 0x183000 VAddr 0x007fb90c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04ea PSN 0xe1a75c OUT 0x10 RKey 0x183000 VAddr 0x007fb90d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04eb PSN 0xf11644 OUT 0x10 RKey 0x183000 VAddr 0x007fb90d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04ec PSN 0x3fbc3e OUT 0x10 RKey 0x183000 VAddr 0x007fb90e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04ed PSN 0x8cbc92 OUT 0x10 RKey 0x183000 VAddr 0x007fb90e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04ee PSN 0x62c453 OUT 0x10 RKey 0x183000 VAddr 0x007fb90f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04ef PSN 0x42f21a OUT 0x10 RKey 0x183000 VAddr 0x007fb90f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04f0 PSN 0x54d780 OUT 0x10 RKey 0x183000 VAddr 0x007fb910000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04f1 PSN 0xccbcb OUT 0x10 RKey 0x183000 VAddr 0x007fb910800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04f2 PSN 0x36d049 OUT 0x10 RKey 0x183000 VAddr 0x007fb911000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04f3 PSN 0x7578df OUT 0x10 RKey 0x183000 VAddr 0x007fb911800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04f4 PSN 0xc34ba9 OUT 0x10 RKey 0x183000 VAddr 0x007fb912000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04f5 PSN 0xc2836b OUT 0x10 RKey 0x183000 VAddr 0x007fb912800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04f6 PSN 0x7e0e83 OUT 0x10 RKey 0x183000 VAddr 0x007fb913000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x04f7 PSN 0x3a22c1 OUT 0x10 RKey 0x183000 VAddr 0x007fb913800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04e8 PSN 0xc3edfc OUT 0x10 RKey 0x182f00 VAddr 0x007f6e2c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04e9 PSN 0xca996d OUT 0x10 RKey 0x182f00 VAddr 0x007f6e2c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04ea PSN 0x924f7d OUT 0x10 RKey 0x182f00 VAddr 0x007f6e2d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04eb PSN 0xa25251 OUT 0x10 RKey 0x182f00 VAddr 0x007f6e2d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04ec PSN 0xa5fbc7 OUT 0x10 RKey 0x182f00 VAddr 0x007f6e2e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04ed PSN 0x76dfe7 OUT 0x10 RKey 0x182f00 VAddr 0x007f6e2e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04ee PSN 0x2e2d84 OUT 0x10 RKey 0x182f00 VAddr 0x007f6e2f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04ef PSN 0x8cc1f7 OUT 0x10 RKey 0x182f00 VAddr 0x007f6e2f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04f0 PSN 0x3ee699 OUT 0x10 RKey 0x182f00 VAddr 0x007f6e30000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04f1 PSN 0x51af70 OUT 0x10 RKey 0x182f00 VAddr 0x007f6e30800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04f2 PSN 0x2dfb8a OUT 0x10 RKey 0x182f00 VAddr 0x007f6e31000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04f3 PSN 0x7b498c OUT 0x10 RKey 0x182f00 VAddr 0x007f6e31800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04f4 PSN 0x349352 OUT 0x10 RKey 0x182f00 VAddr 0x007f6e32000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04f5 PSN 0x2bdc60 OUT 0x10 RKey 0x182f00 VAddr 0x007f6e32800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04f6 PSN 0x210cd4 OUT 0x10 RKey 0x182f00 VAddr 0x007f6e33000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04f7 PSN 0xc9313e OUT 0x10 RKey 0x182f00 VAddr 0x007f6e33800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.086331            0.085703            5.356455
 4          16000            0.18               0.17   		     5.463361
 8          16000            0.35               0.35   		     5.490998
 16         16000            0.71               0.70   		     5.494209
 32         16000            1.41               1.41   		     5.497904
 64         16000            2.82               2.82   		     5.500285
 128        16000            5.61               5.59   		     5.457771
 256        16000            11.16              11.13  		     5.436205
 512        16000            22.21              22.13  		     5.403361
 1024       16000            46.08              45.96  		     5.610295
 2048       16000            95.01              94.90  		     5.792085
 4096       16000            198.19             196.02 		     5.982091
 8192       16000            201.99             201.73 		     3.078101
 16384      16000            202.55             202.46 		     1.544671
 32768      16000            202.76             202.74 		     0.773401
 65536      16000            202.79             202.78 		     0.386767
 131072     16000            202.86             202.86 		     0.193460
 262144     16000            202.88             202.88 		     0.096739
 524288     16000            202.92             202.92 		     0.048380
 1048576    16000            202.95             202.94 		     0.024193
 2097152    16000            189.75             189.75 		     0.011310
 4194304    16000            169.92             169.92 		     0.005064
 8388608    16000            169.95             169.95 		     0.002532
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fb904000000
destroying current CUDA Ctx
