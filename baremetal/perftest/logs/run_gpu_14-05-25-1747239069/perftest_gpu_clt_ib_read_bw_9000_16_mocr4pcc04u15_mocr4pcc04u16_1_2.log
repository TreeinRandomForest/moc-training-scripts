initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 25112, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f0140000000 pointer=0x7f0140000000
using DMA-BUF for GPU buffer address at 0x7f0140000000 aligned at 0x7f0140000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f0140000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x01f8 PSN 0x36136e OUT 0x10 RKey 0x182e00 VAddr 0x007f0148000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x01f9 PSN 0xaa83c0 OUT 0x10 RKey 0x182e00 VAddr 0x007f0148800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x01fa PSN 0x6a1a0a OUT 0x10 RKey 0x182e00 VAddr 0x007f0149000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x01fb PSN 0xf0b191 OUT 0x10 RKey 0x182e00 VAddr 0x007f0149800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x01fc PSN 0x2196d0 OUT 0x10 RKey 0x182e00 VAddr 0x007f014a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x01fd PSN 0x246bf2 OUT 0x10 RKey 0x182e00 VAddr 0x007f014a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x01fe PSN 0x7f2369 OUT 0x10 RKey 0x182e00 VAddr 0x007f014b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x01ff PSN 0x83a5ae OUT 0x10 RKey 0x182e00 VAddr 0x007f014b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0200 PSN 0x1eb8ba OUT 0x10 RKey 0x182e00 VAddr 0x007f014c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0201 PSN 0x4a40b4 OUT 0x10 RKey 0x182e00 VAddr 0x007f014c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0202 PSN 0xc07a48 OUT 0x10 RKey 0x182e00 VAddr 0x007f014d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0203 PSN 0x6b813b OUT 0x10 RKey 0x182e00 VAddr 0x007f014d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0204 PSN 0x4df60b OUT 0x10 RKey 0x182e00 VAddr 0x007f014e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0205 PSN 0xaf8e5c OUT 0x10 RKey 0x182e00 VAddr 0x007f014e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0206 PSN 0xf5c9ea OUT 0x10 RKey 0x182e00 VAddr 0x007f014f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0207 PSN 0x110466 OUT 0x10 RKey 0x182e00 VAddr 0x007f014f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x01f8 PSN 0x79c12e OUT 0x10 RKey 0x182e00 VAddr 0x007fd41c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x01f9 PSN 0x95fe80 OUT 0x10 RKey 0x182e00 VAddr 0x007fd41c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x01fa PSN 0xf5ddca OUT 0x10 RKey 0x182e00 VAddr 0x007fd41d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x01fb PSN 0x518a51 OUT 0x10 RKey 0x182e00 VAddr 0x007fd41d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x01fc PSN 0x1a6090 OUT 0x10 RKey 0x182e00 VAddr 0x007fd41e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x01fd PSN 0x54d2b2 OUT 0x10 RKey 0x182e00 VAddr 0x007fd41e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x01fe PSN 0x6b6329 OUT 0x10 RKey 0x182e00 VAddr 0x007fd41f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x01ff PSN 0x614a6e OUT 0x10 RKey 0x182e00 VAddr 0x007fd41f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0200 PSN 0x825e7a OUT 0x10 RKey 0x182e00 VAddr 0x007fd420000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0201 PSN 0xa25374 OUT 0x10 RKey 0x182e00 VAddr 0x007fd420800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0202 PSN 0x18f608 OUT 0x10 RKey 0x182e00 VAddr 0x007fd421000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0203 PSN 0x46b1fb OUT 0x10 RKey 0x182e00 VAddr 0x007fd421800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0204 PSN 0x6e37cb OUT 0x10 RKey 0x182e00 VAddr 0x007fd422000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0205 PSN 0x7e0d1c OUT 0x10 RKey 0x182e00 VAddr 0x007fd422800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0206 PSN 0xc241aa OUT 0x10 RKey 0x182e00 VAddr 0x007fd423000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0207 PSN 0xb68126 OUT 0x10 RKey 0x182e00 VAddr 0x007fd423800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.080717            0.080155            5.009690
 4          16000            0.17               0.16   		     5.134162
 8          16000            0.33               0.33   		     5.135595
 16         16000            0.66               0.66   		     5.122672
 32         16000            1.32               1.31   		     5.127588
 64         16000            2.64               2.63   		     5.135447
 128        16000            5.27               5.25   		     5.127055
 256        16000            10.52              10.48  		     5.119198
 512        16000            21.04              20.94  		     5.112376
 1024       16000            42.08              41.95  		     5.120344
 2048       16000            83.59              83.36  		     5.087699
 4096       16000            167.18             166.35 		     5.076593
 8192       16000            201.72             201.49 		     3.074505
 16384      16000            202.69             202.65 		     1.546083
 32768      16000            202.97             202.94 		     0.774151
 65536      16000            203.04             203.02 		     0.387233
 131072     16000            203.11             203.10 		     0.193692
 262144     16000            203.16             203.16 		     0.096872
 524288     16000            203.15             203.15 		     0.048434
 1048576    16000            203.16             203.16 		     0.024219
 2097152    16000            189.46             189.44 		     0.011291
 4194304    16000            169.86             169.86 		     0.005062
 8388608    16000            169.81             169.81 		     0.002530
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f0140000000
destroying current CUDA Ctx
