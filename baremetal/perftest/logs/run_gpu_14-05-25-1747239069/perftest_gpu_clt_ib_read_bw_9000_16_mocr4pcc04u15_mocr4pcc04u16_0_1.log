initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 24537, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f5890000000 pointer=0x7f5890000000
using DMA-BUF for GPU buffer address at 0x7f5890000000 aligned at 0x7f5890000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f5890000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0158 PSN 0x870c43 OUT 0x10 RKey 0x182e00 VAddr 0x007f5898000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0159 PSN 0xfd471 OUT 0x10 RKey 0x182e00 VAddr 0x007f5898800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x015a PSN 0x387b67 OUT 0x10 RKey 0x182e00 VAddr 0x007f5899000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x015b PSN 0x5b42a OUT 0x10 RKey 0x182e00 VAddr 0x007f5899800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x015c PSN 0x7527f5 OUT 0x10 RKey 0x182e00 VAddr 0x007f589a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x015d PSN 0x3c76b3 OUT 0x10 RKey 0x182e00 VAddr 0x007f589a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x015e PSN 0x511d96 OUT 0x10 RKey 0x182e00 VAddr 0x007f589b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x015f PSN 0x2b98d7 OUT 0x10 RKey 0x182e00 VAddr 0x007f589b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0160 PSN 0xe4172f OUT 0x10 RKey 0x182e00 VAddr 0x007f589c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0161 PSN 0xc9685 OUT 0x10 RKey 0x182e00 VAddr 0x007f589c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0162 PSN 0x44ca45 OUT 0x10 RKey 0x182e00 VAddr 0x007f589d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0163 PSN 0xdaddf4 OUT 0x10 RKey 0x182e00 VAddr 0x007f589d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0164 PSN 0x92a6d0 OUT 0x10 RKey 0x182e00 VAddr 0x007f589e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0165 PSN 0x5bd03d OUT 0x10 RKey 0x182e00 VAddr 0x007f589e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0166 PSN 0xe9fcb7 OUT 0x10 RKey 0x182e00 VAddr 0x007f589f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0167 PSN 0xaad3af OUT 0x10 RKey 0x182e00 VAddr 0x007f589f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0158 PSN 0xb462a1 OUT 0x10 RKey 0x182e00 VAddr 0x007f9c54000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0159 PSN 0x9e0e77 OUT 0x10 RKey 0x182e00 VAddr 0x007f9c54800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x015a PSN 0x7093f5 OUT 0x10 RKey 0x182e00 VAddr 0x007f9c55000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x015b PSN 0xdfbca0 OUT 0x10 RKey 0x182e00 VAddr 0x007f9c55800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x015c PSN 0xacc633 OUT 0x10 RKey 0x182e00 VAddr 0x007f9c56000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x015d PSN 0x3e8b19 OUT 0x10 RKey 0x182e00 VAddr 0x007f9c56800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x015e PSN 0x8f7104 OUT 0x10 RKey 0x182e00 VAddr 0x007f9c57000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x015f PSN 0x11f2ad OUT 0x10 RKey 0x182e00 VAddr 0x007f9c57800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0160 PSN 0xf69b4d OUT 0x10 RKey 0x182e00 VAddr 0x007f9c58000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0161 PSN 0x49cb4b OUT 0x10 RKey 0x182e00 VAddr 0x007f9c58800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0162 PSN 0x462693 OUT 0x10 RKey 0x182e00 VAddr 0x007f9c59000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0163 PSN 0x453f2a OUT 0x10 RKey 0x182e00 VAddr 0x007f9c59800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0164 PSN 0xfc8ece OUT 0x10 RKey 0x182e00 VAddr 0x007f9c5a000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0165 PSN 0x9cb63 OUT 0x10 RKey 0x182e00 VAddr 0x007f9c5a800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0166 PSN 0xaa0fe5 OUT 0x10 RKey 0x182e00 VAddr 0x007f9c5b000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0167 PSN 0x165245 OUT 0x10 RKey 0x182e00 VAddr 0x007f9c5b800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.083141            0.082568            5.160508
 4          16000            0.17               0.17   		     5.273462
 8          16000            0.34               0.34   		     5.275862
 16         16000            0.68               0.68   		     5.279936
 32         16000            1.36               1.35   		     5.277563
 64         16000            2.71               2.70   		     5.266155
 128        16000            5.41               5.38   		     5.258332
 256        16000            10.79              10.74  		     5.245953
 512        16000            21.58              21.50  		     5.249861
 1024       16000            44.10              43.91  		     5.360314
 2048       16000            91.47              91.02  		     5.555581
 4096       16000            189.53             187.44 		     5.720292
 8192       16000            208.27             208.24 		     3.177484
 16384      16000            209.16             209.11 		     1.595351
 32768      16000            209.53             209.50 		     0.799172
 65536      16000            209.31             209.28 		     0.399168
 131072     16000            209.51             209.50 		     0.199793
 262144     16000            209.56             209.56 		     0.099924
 524288     16000            209.60             209.60 		     0.049973
 1048576    16000            209.60             209.60 		     0.024987
 2097152    16000            192.60             192.60 		     0.011480
 4194304    16000            171.26             171.26 		     0.005104
 8388608    16000            171.23             171.23 		     0.002552
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f5890000000
destroying current CUDA Ctx
