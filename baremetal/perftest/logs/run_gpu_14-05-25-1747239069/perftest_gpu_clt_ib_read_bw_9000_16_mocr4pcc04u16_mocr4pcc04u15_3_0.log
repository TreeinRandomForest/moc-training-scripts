initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 32731, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f7e88000000 pointer=0x7f7e88000000
using DMA-BUF for GPU buffer address at 0x7f7e88000000 aligned at 0x7f7e88000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f7e88000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x04b8 PSN 0x6b3041 OUT 0x10 RKey 0x182e00 VAddr 0x007f7e90000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04b9 PSN 0xb15b97 OUT 0x10 RKey 0x182e00 VAddr 0x007f7e90800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04ba PSN 0x732a95 OUT 0x10 RKey 0x182e00 VAddr 0x007f7e91000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04bb PSN 0xcd9ec0 OUT 0x10 RKey 0x182e00 VAddr 0x007f7e91800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04bc PSN 0x9ecdd3 OUT 0x10 RKey 0x182e00 VAddr 0x007f7e92000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04bd PSN 0xa58a39 OUT 0x10 RKey 0x182e00 VAddr 0x007f7e92800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04be PSN 0x20d1a4 OUT 0x10 RKey 0x182e00 VAddr 0x007f7e93000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04bf PSN 0x47d6cd OUT 0x10 RKey 0x182e00 VAddr 0x007f7e93800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04c0 PSN 0x5d7ced OUT 0x10 RKey 0x182e00 VAddr 0x007f7e94000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04c1 PSN 0x4d9c6b OUT 0x10 RKey 0x182e00 VAddr 0x007f7e94800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04c2 PSN 0x48f133 OUT 0x10 RKey 0x182e00 VAddr 0x007f7e95000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04c3 PSN 0x1454a OUT 0x10 RKey 0x182e00 VAddr 0x007f7e95800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04c4 PSN 0xbea6e OUT 0x10 RKey 0x182e00 VAddr 0x007f7e96000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04c5 PSN 0x658e83 OUT 0x10 RKey 0x182e00 VAddr 0x007f7e96800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04c6 PSN 0x8ae485 OUT 0x10 RKey 0x182e00 VAddr 0x007f7e97000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04c7 PSN 0x589a65 OUT 0x10 RKey 0x182e00 VAddr 0x007f7e97800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04b8 PSN 0x260c18 OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04b9 PSN 0xf82022 OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04ba PSN 0x4dbbc4 OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04bb PSN 0xa1a9c3 OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04bc PSN 0x90301a OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04bd PSN 0x2c2c74 OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04be PSN 0x98e6c3 OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04bf PSN 0xf6af00 OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04c0 PSN 0x115ca4 OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04c1 PSN 0x964756 OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04c2 PSN 0x6cd942 OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04c3 PSN 0x9c8dad OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04c4 PSN 0x76ae95 OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04c5 PSN 0xa1d1e OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04c6 PSN 0x9ede84 OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04c7 PSN 0x8925f8 OUT 0x10 RKey 0x182e00 VAddr 0x007f4ee7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.078768            0.078461            4.903790
 4          16000            0.16               0.16   		     4.983678
 8          16000            0.32               0.32   		     4.930176
 16         16000            0.64               0.64   		     4.973391
 32         16000            1.28               1.27   		     4.960133
 64         16000            2.55               2.53   		     4.947281
 128        16000            5.10               5.09   		     4.968806
 256        16000            10.15              10.11  		     4.936641
 512        16000            20.30              20.20  		     4.931878
 1024       16000            40.51              40.40  		     4.931740
 2048       16000            81.02              80.79  		     4.930881
 4096       16000            160.63             160.54 		     4.899244
 8192       16000            155.87             120.42 		     1.837408
 16384      16000            187.25             137.66 		     1.050286
 32768      16000            188.80             159.23 		     0.607407
 65536      16000            190.75             177.32 		     0.338203
 131072     16000            196.80             196.79 		     0.187677
 262144     16000            191.77             191.77 		     0.091443
 524288     16000            194.61             194.61 		     0.046398
 1048576    16000            195.90             195.90 		     0.023353
 2097152    16000            185.58             185.34 		     0.011047
 4194304    16000            163.13             163.13 		     0.004862
 8388608    16000            163.06             163.06 		     0.002430
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f7e88000000
destroying current CUDA Ctx
