initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 32508, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f7fd2000000 pointer=0x7f7fd2000000
using DMA-BUF for GPU buffer address at 0x7f7fd2000000 aligned at 0x7f7fd2000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f7fd2000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0478 PSN 0x3bbcc8 OUT 0x10 RKey 0x182e00 VAddr 0x007f7fda000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0479 PSN 0x327b12 OUT 0x10 RKey 0x182e00 VAddr 0x007f7fda800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x047a PSN 0x1a13f4 OUT 0x10 RKey 0x182e00 VAddr 0x007f7fdb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x047b PSN 0x1e5633 OUT 0x10 RKey 0x182e00 VAddr 0x007f7fdb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x047c PSN 0xd23bca OUT 0x10 RKey 0x182e00 VAddr 0x007f7fdc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x047d PSN 0xb4664 OUT 0x10 RKey 0x182e00 VAddr 0x007f7fdc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x047e PSN 0x2491f3 OUT 0x10 RKey 0x182e00 VAddr 0x007f7fdd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x047f PSN 0x7bb270 OUT 0x10 RKey 0x182e00 VAddr 0x007f7fdd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0480 PSN 0xa7354 OUT 0x10 RKey 0x182e00 VAddr 0x007f7fde000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0481 PSN 0x471046 OUT 0x10 RKey 0x182e00 VAddr 0x007f7fde800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0482 PSN 0x7a0772 OUT 0x10 RKey 0x182e00 VAddr 0x007f7fdf000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0483 PSN 0xf8581d OUT 0x10 RKey 0x182e00 VAddr 0x007f7fdf800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0484 PSN 0xac8045 OUT 0x10 RKey 0x182e00 VAddr 0x007f7fe0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0485 PSN 0x98850e OUT 0x10 RKey 0x182e00 VAddr 0x007f7fe0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0486 PSN 0xe2bfb4 OUT 0x10 RKey 0x182e00 VAddr 0x007f7fe1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0487 PSN 0x12768 OUT 0x10 RKey 0x182e00 VAddr 0x007f7fe1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0478 PSN 0x44e549 OUT 0x10 RKey 0x182e00 VAddr 0x007fe3f4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0479 PSN 0x689fff OUT 0x10 RKey 0x182e00 VAddr 0x007fe3f4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x047a PSN 0xd0badd OUT 0x10 RKey 0x182e00 VAddr 0x007fe3f5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x047b PSN 0xa4bd68 OUT 0x10 RKey 0x182e00 VAddr 0x007fe3f5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x047c PSN 0xa1cb5b OUT 0x10 RKey 0x182e00 VAddr 0x007fe3f6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x047d PSN 0x13ad21 OUT 0x10 RKey 0x182e00 VAddr 0x007fe3f6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x047e PSN 0x421e6c OUT 0x10 RKey 0x182e00 VAddr 0x007fe3f7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x047f PSN 0xd137f5 OUT 0x10 RKey 0x182e00 VAddr 0x007fe3f7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0480 PSN 0x5caf5 OUT 0x10 RKey 0x182e00 VAddr 0x007fe3f8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0481 PSN 0x7205d3 OUT 0x10 RKey 0x182e00 VAddr 0x007fe3f8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0482 PSN 0x5d427b OUT 0x10 RKey 0x182e00 VAddr 0x007fe3f9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0483 PSN 0xe90f2 OUT 0x10 RKey 0x182e00 VAddr 0x007fe3f9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0484 PSN 0x8e10f6 OUT 0x10 RKey 0x182e00 VAddr 0x007fe3fa000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0485 PSN 0xce266b OUT 0x10 RKey 0x182e00 VAddr 0x007fe3fa800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0486 PSN 0x6e024d OUT 0x10 RKey 0x182e00 VAddr 0x007fe3fb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0487 PSN 0x2df88d OUT 0x10 RKey 0x182e00 VAddr 0x007fe3fb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.056604            0.056371            3.523197
 4          16000            0.11               0.11   		     3.559788
 8          16000            0.23               0.23   		     3.574397
 16         16000            0.46               0.46   		     3.572114
 32         16000            0.92               0.91   		     3.566485
 64         16000            1.84               1.82   		     3.560588
 128        16000            3.67               3.63   		     3.543084
 256        16000            7.33               7.29   		     3.558568
 512        16000            14.68              14.60  		     3.565348
 1024       16000            29.12              28.91  		     3.529352
 2048       16000            58.15              57.97  		     3.538508
 4096       16000            65.54              65.50  		     1.998926
 8192       16000            186.18             185.91 		     2.836693
 16384      16000            184.32             149.86 		     1.143376
 32768      16000            196.02             195.97 		     0.747580
 65536      16000            191.41             177.90 		     0.339323
 131072     16000            197.48             197.47 		     0.188318
 262144     16000            192.62             192.61 		     0.091845
 524288     16000            195.30             195.30 		     0.046563
 1048576    16000            198.06             198.06 		     0.023611
 2097152    16000            185.06             185.06 		     0.011030
 4194304    16000            163.53             163.53 		     0.004874
 8388608    16000            163.69             163.69 		     0.002439
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f7fd2000000
destroying current CUDA Ctx
