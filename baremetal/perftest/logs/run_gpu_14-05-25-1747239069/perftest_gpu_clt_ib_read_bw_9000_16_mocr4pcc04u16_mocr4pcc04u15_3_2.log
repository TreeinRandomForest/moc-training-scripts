initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 2
[pid = 32955, dev = 2] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f7c24000000 pointer=0x7f7c24000000
using DMA-BUF for GPU buffer address at 0x7f7c24000000 aligned at 0x7f7c24000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f7c24000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x04f8 PSN 0x98f5a3 OUT 0x10 RKey 0x182e00 VAddr 0x007f7c2c000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04f9 PSN 0x52e588 OUT 0x10 RKey 0x182e00 VAddr 0x007f7c2c800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04fa PSN 0xdef8fc OUT 0x10 RKey 0x182e00 VAddr 0x007f7c2d000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04fb PSN 0xa29764 OUT 0x10 RKey 0x182e00 VAddr 0x007f7c2d800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04fc PSN 0x5676de OUT 0x10 RKey 0x182e00 VAddr 0x007f7c2e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04fd PSN 0x65f2b2 OUT 0x10 RKey 0x182e00 VAddr 0x007f7c2e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04fe PSN 0xff8ff3 OUT 0x10 RKey 0x182e00 VAddr 0x007f7c2f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x04ff PSN 0x77653a OUT 0x10 RKey 0x182e00 VAddr 0x007f7c2f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0500 PSN 0x989c20 OUT 0x10 RKey 0x182e00 VAddr 0x007f7c30000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0501 PSN 0xf43eb OUT 0x10 RKey 0x182e00 VAddr 0x007f7c30800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0502 PSN 0xb0b5e9 OUT 0x10 RKey 0x182e00 VAddr 0x007f7c31000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0503 PSN 0x29fdff OUT 0x10 RKey 0x182e00 VAddr 0x007f7c31800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0504 PSN 0xbaba49 OUT 0x10 RKey 0x182e00 VAddr 0x007f7c32000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0505 PSN 0x5d8b OUT 0x10 RKey 0x182e00 VAddr 0x007f7c32800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0506 PSN 0x4cae23 OUT 0x10 RKey 0x182e00 VAddr 0x007f7c33000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0507 PSN 0x1dd9e1 OUT 0x10 RKey 0x182e00 VAddr 0x007f7c33800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x04f8 PSN 0x9b1bdd OUT 0x10 RKey 0x182e00 VAddr 0x007f84b6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04f9 PSN 0x96d503 OUT 0x10 RKey 0x182e00 VAddr 0x007f84b6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04fa PSN 0xcee591 OUT 0x10 RKey 0x182e00 VAddr 0x007f84b7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04fb PSN 0x2aa40c OUT 0x10 RKey 0x182e00 VAddr 0x007f84b7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04fc PSN 0xc572f OUT 0x10 RKey 0x182e00 VAddr 0x007f84b8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04fd PSN 0x81ae65 OUT 0x10 RKey 0x182e00 VAddr 0x007f84b8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04fe PSN 0xebc060 OUT 0x10 RKey 0x182e00 VAddr 0x007f84b9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x04ff PSN 0x7c64d9 OUT 0x10 RKey 0x182e00 VAddr 0x007f84b9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0500 PSN 0x6cc009 OUT 0x10 RKey 0x182e00 VAddr 0x007f84ba000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0501 PSN 0xe85757 OUT 0x10 RKey 0x182e00 VAddr 0x007f84ba800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0502 PSN 0xaa8faf OUT 0x10 RKey 0x182e00 VAddr 0x007f84bb000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0503 PSN 0x452816 OUT 0x10 RKey 0x182e00 VAddr 0x007f84bb800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0504 PSN 0xc6c34a OUT 0x10 RKey 0x182e00 VAddr 0x007f84bc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0505 PSN 0x998c2f OUT 0x10 RKey 0x182e00 VAddr 0x007f84bc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0506 PSN 0x266ec1 OUT 0x10 RKey 0x182e00 VAddr 0x007f84bd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0507 PSN 0x145df1 OUT 0x10 RKey 0x182e00 VAddr 0x007f84bd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.056162            0.055471            3.466963
 4          16000            0.11               0.11   		     3.533819
 8          16000            0.23               0.23   		     3.537006
 16         16000            0.45               0.45   		     3.542809
 32         16000            0.91               0.90   		     3.531907
 64         16000            1.82               1.81   		     3.534896
 128        16000            3.62               3.61   		     3.525891
 256        16000            7.29               7.25   		     3.540849
 512        16000            14.51              14.45  		     3.528239
 1024       16000            28.98              28.88  		     3.525083
 2048       16000            57.42              57.35  		     3.500351
 4096       16000            83.59              70.07  		     2.138489
 8192       16000            147.75             120.25 		     1.834833
 16384      16000            193.26             193.18 		     1.473814
 32768      16000            197.07             197.02 		     0.751578
 65536      16000            196.18             196.17 		     0.374172
 131072     16000            190.88             186.27 		     0.177642
 262144     16000            191.72             191.71 		     0.091416
 524288     16000            194.51             194.51 		     0.046374
 1048576    16000            195.93             195.93 		     0.023357
 2097152    16000            184.37             184.37 		     0.010989
 4194304    16000            163.06             163.06 		     0.004859
 8388608    16000            163.12             163.12 		     0.002431
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f7c24000000
destroying current CUDA Ctx
