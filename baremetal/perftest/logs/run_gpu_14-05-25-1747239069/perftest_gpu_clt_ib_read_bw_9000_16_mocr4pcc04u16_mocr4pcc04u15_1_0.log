initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 31834, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007ff5d8000000 pointer=0x7ff5d8000000
using DMA-BUF for GPU buffer address at 0x7ff5d8000000 aligned at 0x7ff5d8000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7ff5d8000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x03b8 PSN 0x4bd2b0 OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03b9 PSN 0x9a3eda OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03ba PSN 0x8e201c OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03bb PSN 0x53733b OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03bc PSN 0xe4c832 OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03bd PSN 0xf67eac OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03be PSN 0x3c389b OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03bf PSN 0x2897f8 OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03c0 PSN 0x405e3c OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03c1 PSN 0x28850e OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03c2 PSN 0xc4709a OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03c3 PSN 0x10e25 OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03c4 PSN 0x4d31ad OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03c5 PSN 0x477e56 OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03c6 PSN 0xb9935c OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x03c7 PSN 0x8235f0 OUT 0x10 RKey 0x182e00 VAddr 0x007ff5e7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x03b8 PSN 0x93c951 OUT 0x10 RKey 0x182e00 VAddr 0x007f995e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03b9 PSN 0x3ee767 OUT 0x10 RKey 0x182e00 VAddr 0x007f995e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03ba PSN 0x149225 OUT 0x10 RKey 0x182e00 VAddr 0x007f995f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03bb PSN 0x521710 OUT 0x10 RKey 0x182e00 VAddr 0x007f995f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03bc PSN 0xdde7e3 OUT 0x10 RKey 0x182e00 VAddr 0x007f9960000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03bd PSN 0xae0309 OUT 0x10 RKey 0x182e00 VAddr 0x007f9960800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03be PSN 0x72234 OUT 0x10 RKey 0x182e00 VAddr 0x007f9961000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03bf PSN 0x79841d OUT 0x10 RKey 0x182e00 VAddr 0x007f9961800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03c0 PSN 0xfa27fd OUT 0x10 RKey 0x182e00 VAddr 0x007f9962000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03c1 PSN 0x72d23b OUT 0x10 RKey 0x182e00 VAddr 0x007f9962800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03c2 PSN 0x39bac3 OUT 0x10 RKey 0x182e00 VAddr 0x007f9963000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03c3 PSN 0x5e779a OUT 0x10 RKey 0x182e00 VAddr 0x007f9963800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03c4 PSN 0xae367e OUT 0x10 RKey 0x182e00 VAddr 0x007f9964000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03c5 PSN 0x965153 OUT 0x10 RKey 0x182e00 VAddr 0x007f9964800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03c6 PSN 0x14b715 OUT 0x10 RKey 0x182e00 VAddr 0x007f9965000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x03c7 PSN 0xf4a1b5 OUT 0x10 RKey 0x182e00 VAddr 0x007f9965800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.056867            0.056317            3.519800
 4          16000            0.11               0.11   		     3.560588
 8          16000            0.23               0.23   		     3.585346
 16         16000            0.46               0.46   		     3.579362
 32         16000            0.92               0.92   		     3.597688
 64         16000            1.82               1.82   		     3.551499
 128        16000            3.66               3.64   		     3.557453
 256        16000            7.37               7.35   		     3.590698
 512        16000            14.63              14.58  		     3.559788
 1024       16000            29.40              29.29  		     3.575195
 2048       16000            58.51              58.36  		     3.561888
 4096       16000            117.03             116.91 		     3.567726
 8192       16000            200.08             199.69 		     3.047015
 16384      16000            198.46             198.45 		     1.514065
 32768      16000            195.82             195.78 		     0.746842
 65536      16000            201.82             201.80 		     0.384900
 131072     16000            200.65             200.26 		     0.190985
 262144     16000            200.14             200.14 		     0.095434
 524288     16000            200.79             200.45 		     0.047792
 1048576    16000            200.74             200.74 		     0.023930
 2097152    16000            188.68             187.99 		     0.011205
 4194304    16000            166.98             166.98 		     0.004976
 8388608    16000            167.29             167.04 		     0.002489
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007ff5d8000000
destroying current CUDA Ctx
