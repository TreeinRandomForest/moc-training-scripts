initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 3
[pid = 25225, dev = 3] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007fb3ce000000 pointer=0x7fb3ce000000
using DMA-BUF for GPU buffer address at 0x7fb3ce000000 aligned at 0x7fb3ce000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7fb3ce000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0218 PSN 0x65639b OUT 0x10 RKey 0x182e00 VAddr 0x007fb3d6000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0219 PSN 0xca8820 OUT 0x10 RKey 0x182e00 VAddr 0x007fb3d6800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x021a PSN 0x3c3b4 OUT 0x10 RKey 0x182e00 VAddr 0x007fb3d7000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x021b PSN 0xe37bc OUT 0x10 RKey 0x182e00 VAddr 0x007fb3d7800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x021c PSN 0x58cc56 OUT 0x10 RKey 0x182e00 VAddr 0x007fb3d8000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x021d PSN 0xce26ca OUT 0x10 RKey 0x182e00 VAddr 0x007fb3d8800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x021e PSN 0x4b4e2b OUT 0x10 RKey 0x182e00 VAddr 0x007fb3d9000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x021f PSN 0x3db312 OUT 0x10 RKey 0x182e00 VAddr 0x007fb3d9800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0220 PSN 0x17d118 OUT 0x10 RKey 0x182e00 VAddr 0x007fb3da000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0221 PSN 0x6fa183 OUT 0x10 RKey 0x182e00 VAddr 0x007fb3da800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0222 PSN 0xef1fa1 OUT 0x10 RKey 0x182e00 VAddr 0x007fb3db000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0223 PSN 0x585157 OUT 0x10 RKey 0x182e00 VAddr 0x007fb3db800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0224 PSN 0x7546c1 OUT 0x10 RKey 0x182e00 VAddr 0x007fb3dc000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0225 PSN 0x41fca3 OUT 0x10 RKey 0x182e00 VAddr 0x007fb3dc800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0226 PSN 0x4cfb5b OUT 0x10 RKey 0x182e00 VAddr 0x007fb3dd000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x0227 PSN 0x3f0ab9 OUT 0x10 RKey 0x182e00 VAddr 0x007fb3dd800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0218 PSN 0xd22c6b OUT 0x10 RKey 0x182e00 VAddr 0x007f1060000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0219 PSN 0xd07579 OUT 0x10 RKey 0x182e00 VAddr 0x007f1060800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x021a PSN 0x4a3bcf OUT 0x10 RKey 0x182e00 VAddr 0x007f1061000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x021b PSN 0x521072 OUT 0x10 RKey 0x182e00 VAddr 0x007f1061800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x021c PSN 0x41229d OUT 0x10 RKey 0x182e00 VAddr 0x007f1062000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x021d PSN 0x29203b OUT 0x10 RKey 0x182e00 VAddr 0x007f1062800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x021e PSN 0xc57c7e OUT 0x10 RKey 0x182e00 VAddr 0x007f1063000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x021f PSN 0xdc719f OUT 0x10 RKey 0x182e00 VAddr 0x007f1063800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0220 PSN 0x541457 OUT 0x10 RKey 0x182e00 VAddr 0x007f1064000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0221 PSN 0xd508d OUT 0x10 RKey 0x182e00 VAddr 0x007f1064800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0222 PSN 0x172fad OUT 0x10 RKey 0x182e00 VAddr 0x007f1065000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0223 PSN 0x6b7b3c OUT 0x10 RKey 0x182e00 VAddr 0x007f1065800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0224 PSN 0xd44e78 OUT 0x10 RKey 0x182e00 VAddr 0x007f1066000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0225 PSN 0xd122c5 OUT 0x10 RKey 0x182e00 VAddr 0x007f1066800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0226 PSN 0x64509f OUT 0x10 RKey 0x182e00 VAddr 0x007f1067000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0227 PSN 0x2fd77 OUT 0x10 RKey 0x182e00 VAddr 0x007f1067800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.082569            0.082248            5.140512
 4          16000            0.17               0.17   		     5.219717
 8          16000            0.34               0.34   		     5.241176
 16         16000            0.67               0.67   		     5.241880
 32         16000            1.35               1.34   		     5.231442
 64         16000            2.68               2.67   		     5.205351
 128        16000            5.36               5.34   		     5.215974
 256        16000            10.74              10.72  		     5.235020
 512        16000            21.43              21.41  		     5.228039
 1024       16000            42.87              42.73  		     5.215838
 2048       16000            83.59              82.86  		     5.057433
 4096       16000            170.27             170.01 		     5.188185
 8192       16000            201.99             201.81 		     3.079422
 16384      16000            202.69             202.60 		     1.545686
 32768      16000            203.04             203.02 		     0.774473
 65536      16000            203.07             203.06 		     0.387308
 131072     16000            203.07             203.07 		     0.193660
 262144     16000            203.13             203.13 		     0.096858
 524288     16000            203.20             203.20 		     0.048446
 1048576    16000            203.19             203.18 		     0.024221
 2097152    16000            189.93             189.92 		     0.011320
 4194304    16000            169.79             169.79 		     0.005060
 8388608    16000            169.86             169.86 		     0.002531
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fb3ce000000
destroying current CUDA Ctx
