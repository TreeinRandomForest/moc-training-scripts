initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 1
[pid = 25916, dev = 1] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007f0f36000000 pointer=0x7f0f36000000
using DMA-BUF for GPU buffer address at 0x7f0f36000000 aligned at 0x7f0f36000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7f0f36000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x02d8 PSN 0xb66e3e OUT 0x10 RKey 0x182e00 VAddr 0x007f0f3e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02d9 PSN 0xa80e50 OUT 0x10 RKey 0x182e00 VAddr 0x007f0f3e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02da PSN 0x9b795a OUT 0x10 RKey 0x182e00 VAddr 0x007f0f3f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02db PSN 0x5826a1 OUT 0x10 RKey 0x182e00 VAddr 0x007f0f3f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02dc PSN 0x1acea0 OUT 0x10 RKey 0x182e00 VAddr 0x007f0f40000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02dd PSN 0x260f82 OUT 0x10 RKey 0x182e00 VAddr 0x007f0f40800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02de PSN 0xe527b9 OUT 0x10 RKey 0x182e00 VAddr 0x007f0f41000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02df PSN 0x935bbe OUT 0x10 RKey 0x182e00 VAddr 0x007f0f41800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02e0 PSN 0x219d8a OUT 0x10 RKey 0x182e00 VAddr 0x007f0f42000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02e1 PSN 0xd88d44 OUT 0x10 RKey 0x182e00 VAddr 0x007f0f42800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02e2 PSN 0xe07398 OUT 0x10 RKey 0x182e00 VAddr 0x007f0f43000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02e3 PSN 0xc6884b OUT 0x10 RKey 0x182e00 VAddr 0x007f0f43800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02e4 PSN 0x2857db OUT 0x10 RKey 0x182e00 VAddr 0x007f0f44000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02e5 PSN 0x4c13ec OUT 0x10 RKey 0x182e00 VAddr 0x007f0f44800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02e6 PSN 0x5a083a OUT 0x10 RKey 0x182e00 VAddr 0x007f0f45000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 local address: LID 0000 QPN 0x02e7 PSN 0x7b6c76 OUT 0x10 RKey 0x182e00 VAddr 0x007f0f45800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x02d8 PSN 0x6afe0a OUT 0x10 RKey 0x182e00 VAddr 0x007f2330000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02d9 PSN 0xca902c OUT 0x10 RKey 0x182e00 VAddr 0x007f2330800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02da PSN 0xc86c06 OUT 0x10 RKey 0x182e00 VAddr 0x007f2331000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02db PSN 0x1201dd OUT 0x10 RKey 0x182e00 VAddr 0x007f2331800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02dc PSN 0x850f2c OUT 0x10 RKey 0x182e00 VAddr 0x007f2332000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02dd PSN 0x71531e OUT 0x10 RKey 0x182e00 VAddr 0x007f2332800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02de PSN 0x7f1925 OUT 0x10 RKey 0x182e00 VAddr 0x007f2333000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02df PSN 0x962eba OUT 0x10 RKey 0x182e00 VAddr 0x007f2333800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02e0 PSN 0x33dad6 OUT 0x10 RKey 0x182e00 VAddr 0x007f2334000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02e1 PSN 0xbeeea0 OUT 0x10 RKey 0x182e00 VAddr 0x007f2334800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02e2 PSN 0x408fc4 OUT 0x10 RKey 0x182e00 VAddr 0x007f2335000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02e3 PSN 0x920f07 OUT 0x10 RKey 0x182e00 VAddr 0x007f2335800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02e4 PSN 0x2d9de7 OUT 0x10 RKey 0x182e00 VAddr 0x007f2336000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02e5 PSN 0x89af08 OUT 0x10 RKey 0x182e00 VAddr 0x007f2336800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02e6 PSN 0xc03b26 OUT 0x10 RKey 0x182e00 VAddr 0x007f2337000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x02e7 PSN 0x4f22f2 OUT 0x10 RKey 0x182e00 VAddr 0x007f2337800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.084906            0.084687            5.292949
 4          16000            0.18               0.18   		     5.491809
 8          16000            0.35               0.35   		     5.473211
 16         16000            0.70               0.70   		     5.456449
 32         16000            1.41               1.41   		     5.493241
 64         16000            2.80               2.80   		     5.468029
 128        16000            5.61               5.59   		     5.456468
 256        16000            11.24              11.18  		     5.459912
 512        16000            22.26              22.24  		     5.428715
 1024       16000            46.31              46.26  		     5.647085
 2048       16000            97.27              96.24  		     5.873801
 4096       16000            190.51             189.39 		     5.779824
 8192       16000            196.35             196.25 		     2.994572
 16384      16000            197.00             196.94 		     1.502514
 32768      16000            197.27             197.26 		     0.752486
 65536      16000            197.10             197.07 		     0.375890
 131072     16000            197.27             197.25 		     0.188115
 262144     16000            197.27             197.27 		     0.094066
 524288     16000            197.34             197.34 		     0.047049
 1048576    16000            197.32             197.31 		     0.023522
 2097152    16000            185.53             185.53 		     0.011059
 4194304    16000            163.19             163.19 		     0.004863
 8388608    16000            163.24             163.24 		     0.002432
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007f0f36000000
destroying current CUDA Ctx
