initializing CUDA
Listing all CUDA devices in system:
CUDA device 0: PCIe address is 06:00
CUDA device 1: PCIe address is 26:00
CUDA device 2: PCIe address is A6:00
CUDA device 3: PCIe address is C6:00

Picking device No. 0
[pid = 31382, dev = 0] device name = [NVIDIA H100 80GB HBM3]
creating CUDA Ctx
making it the current CUDA Ctx
CUDA device integrated: 0
cuMemAlloc() of a 268435456 bytes GPU buffer
allocated GPU buffer address at 00007fb0a6000000 pointer=0x7fb0a6000000
using DMA-BUF for GPU buffer address at 0x7fb0a6000000 aligned at 0x7fb0a6000000 with aligned size 268435456
Calling ibv_reg_dmabuf_mr(offset=0, size=268435456, addr=0x7fb0a6000000, fd=55) for QP #0
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF		Device         : mlx5_2
 Number of qps   : 16		Transport type : IB
 Connection type : RC		Using SRQ      : OFF
 PCIe relax order: ON		Lock-free      : OFF
 ibv_wr* API     : ON		Using DDP      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 CQE Poll Batch  : 16
 Mtu             : 4096[B]
 Link type       : Ethernet
 GID index       : 3
 Outstand reads  : 16
 rdma_cm QPs	 : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0338 PSN 0xf5289d OUT 0x10 RKey 0x182e00 VAddr 0x007fb0ae000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0339 PSN 0x62c2c3 OUT 0x10 RKey 0x182e00 VAddr 0x007fb0ae800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x033a PSN 0x3da051 OUT 0x10 RKey 0x182e00 VAddr 0x007fb0af000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x033b PSN 0x18a7cc OUT 0x10 RKey 0x182e00 VAddr 0x007fb0af800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x033c PSN 0xc26fef OUT 0x10 RKey 0x182e00 VAddr 0x007fb0b0000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x033d PSN 0x46b825 OUT 0x10 RKey 0x182e00 VAddr 0x007fb0b0800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x033e PSN 0x936720 OUT 0x10 RKey 0x182e00 VAddr 0x007fb0b1000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x033f PSN 0xaee499 OUT 0x10 RKey 0x182e00 VAddr 0x007fb0b1800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0340 PSN 0xb3a4c9 OUT 0x10 RKey 0x182e00 VAddr 0x007fb0b2000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0341 PSN 0x9c3d17 OUT 0x10 RKey 0x182e00 VAddr 0x007fb0b2800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0342 PSN 0xade26f OUT 0x10 RKey 0x182e00 VAddr 0x007fb0b3000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0343 PSN 0x7e3d6 OUT 0x10 RKey 0x182e00 VAddr 0x007fb0b3800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0344 PSN 0x5f340a OUT 0x10 RKey 0x182e00 VAddr 0x007fb0b4000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0345 PSN 0xce0def OUT 0x10 RKey 0x182e00 VAddr 0x007fb0b4800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0346 PSN 0x142d81 OUT 0x10 RKey 0x182e00 VAddr 0x007fb0b5000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 local address: LID 0000 QPN 0x0347 PSN 0xaf15b1 OUT 0x10 RKey 0x182e00 VAddr 0x007fb0b5800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:174
 remote address: LID 0000 QPN 0x0338 PSN 0x61f2f4 OUT 0x10 RKey 0x182e00 VAddr 0x007f181e000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0339 PSN 0xb313ce OUT 0x10 RKey 0x182e00 VAddr 0x007f181e800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x033a PSN 0x640400 OUT 0x10 RKey 0x182e00 VAddr 0x007f181f000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x033b PSN 0x54534f OUT 0x10 RKey 0x182e00 VAddr 0x007f181f800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x033c PSN 0x628b6 OUT 0x10 RKey 0x182e00 VAddr 0x007f1820000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x033d PSN 0x932ee0 OUT 0x10 RKey 0x182e00 VAddr 0x007f1820800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x033e PSN 0x31f6bf OUT 0x10 RKey 0x182e00 VAddr 0x007f1821000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x033f PSN 0xcee54c OUT 0x10 RKey 0x182e00 VAddr 0x007f1821800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0340 PSN 0xf8c300 OUT 0x10 RKey 0x182e00 VAddr 0x007f1822000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0341 PSN 0xe38482 OUT 0x10 RKey 0x182e00 VAddr 0x007f1822800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0342 PSN 0xd56cfe OUT 0x10 RKey 0x182e00 VAddr 0x007f1823000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0343 PSN 0x2e5cb9 OUT 0x10 RKey 0x182e00 VAddr 0x007f1823800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0344 PSN 0xa09eb1 OUT 0x10 RKey 0x182e00 VAddr 0x007f1824000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0345 PSN 0x6e810a OUT 0x10 RKey 0x182e00 VAddr 0x007f1824800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0346 PSN 0xb37200 OUT 0x10 RKey 0x182e00 VAddr 0x007f1825000000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
 remote address: LID 0000 QPN 0x0347 PSN 0x1d59c4 OUT 0x10 RKey 0x182e00 VAddr 0x007f1825800000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:60:83
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]
 2          16000           0.058065            0.056886            3.555398
 4          16000            0.12               0.12   		     3.644165
 8          16000            0.23               0.23   		     3.651451
 16         16000            0.47               0.47   		     3.655973
 32         16000            0.94               0.93   		     3.649644
 64         16000            1.88               1.87   		     3.661729
 128        16000            3.75               3.74   		     3.649111
 256        16000            7.50               7.47   		     3.648944
 512        16000            15.03              14.97  		     3.654679
 1024       16000            29.87              29.80  		     3.637951
 2048       16000            58.98              58.78  		     3.587734
 4096       16000            118.53             117.79 		     3.594787
 8192       16000            200.35             200.15 		     3.054117
 16384      16000            204.94             204.87 		     1.563027
 32768      16000            207.17             207.15 		     0.790219
 65536      16000            208.34             208.32 		     0.397339
 131072     16000            208.92             208.91 		     0.199227
 262144     16000            208.69             208.68 		     0.099507
 524288     16000            209.09             209.09 		     0.049851
 1048576    16000            209.54             209.54 		     0.024979
 2097152    16000            195.11             195.05 		     0.011626
 4194304    16000            170.99             170.99 		     0.005096
 8388608    16000            170.96             170.96 		     0.002547
---------------------------------------------------------------------------------------
deallocating GPU buffer 00007fb0a6000000
destroying current CUDA Ctx
