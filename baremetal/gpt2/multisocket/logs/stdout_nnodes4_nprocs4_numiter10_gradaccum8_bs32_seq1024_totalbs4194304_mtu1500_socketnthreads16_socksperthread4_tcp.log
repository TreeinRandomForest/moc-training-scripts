Running pytorch 2.7.0+cu126
using device: cuda:0
total desired batch size: 4194304
=> calculated gradient accumulation steps: 8
using device: cuda:3
using device: cuda:1
using device: cuda:2
compiling the model...
DataLoader: total number of tokens: 1,661,249,667 across 103 files
MOC-R4PCC04U05:642069:642069 [0] NCCL INFO NCCL_SOCKET_IFNAME set to eno7np0
MOC-R4PCC04U05:642069:642069 [0] NCCL INFO NCCL version 2.26.2+cuda12.2
MOC-R4PCC04U05:642069:642173 [0] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
MOC-R4PCC04U05:642069:642173 [0] NCCL INFO NET/Socket : Using [0]eno7np0:192.168.50.193<0>
MOC-R4PCC04U05:642070:642070 [1] NCCL INFO NCCL_SOCKET_IFNAME set to eno7np0
MOC-R4PCC04U05:642071:642071 [2] NCCL INFO NCCL_SOCKET_IFNAME set to eno7np0
MOC-R4PCC04U05:642070:642070 [1] NCCL INFO NCCL version 2.26.2+cuda12.2
MOC-R4PCC04U05:642071:642071 [2] NCCL INFO NCCL version 2.26.2+cuda12.2
MOC-R4PCC04U05:642072:642072 [3] NCCL INFO NCCL_SOCKET_IFNAME set to eno7np0
MOC-R4PCC04U05:642072:642072 [3] NCCL INFO NCCL version 2.26.2+cuda12.2
MOC-R4PCC04U05:642072:642197 [3] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
MOC-R4PCC04U05:642071:642196 [2] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
MOC-R4PCC04U05:642070:642195 [1] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
MOC-R4PCC04U05:642071:642196 [2] NCCL INFO NET/Socket : Using [0]eno7np0:192.168.50.193<0>
MOC-R4PCC04U05:642072:642197 [3] NCCL INFO NET/Socket : Using [0]eno7np0:192.168.50.193<0>
MOC-R4PCC04U05:642070:642195 [1] NCCL INFO NET/Socket : Using [0]eno7np0:192.168.50.193<0>
MOC-R4PCC04U05:642070:642195 [1] NCCL INFO NET/Socket : GPU Direct RDMA Disabled for HCA 0 'eno7np0'
MOC-R4PCC04U05:642071:642196 [2] NCCL INFO NET/Socket : GPU Direct RDMA Disabled for HCA 0 'eno7np0'
MOC-R4PCC04U05:642069:642173 [0] NCCL INFO NET/Socket : GPU Direct RDMA Disabled for HCA 0 'eno7np0'
MOC-R4PCC04U05:642072:642197 [3] NCCL INFO NET/Socket : GPU Direct RDMA Disabled for HCA 0 'eno7np0'
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy recv connection 0 from local rank 1, transport 0
MOC-R4PCC04U05:642070:642281 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60004f30
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy recv connection 1 from local rank 1, transport 0
MOC-R4PCC04U05:642070:642281 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60004fa8
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy recv connection 0 from local rank 2, transport 0
MOC-R4PCC04U05:642071:642282 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f04004f30
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy recv connection 1 from local rank 2, transport 0
MOC-R4PCC04U05:642071:642282 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f04004fa8
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy recv connection 0 from local rank 3, transport 0
MOC-R4PCC04U05:642072:642283 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678004f30
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy recv connection 1 from local rank 3, transport 0
MOC-R4PCC04U05:642072:642283 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678004fa8
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy send connection 0 from local rank 0, transport 0
MOC-R4PCC04U05:642069:642284 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c004f30
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy send connection 1 from local rank 0, transport 0
MOC-R4PCC04U05:642069:642284 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c004fa8
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy send connection 2 from local rank 0, transport 0
MOC-R4PCC04U05:642069:642284 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c005020
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy send connection 3 from local rank 0, transport 0
MOC-R4PCC04U05:642069:642284 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c005098
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy send connection 2 from local rank 3, transport 2
MOC-R4PCC04U05:642072:642283 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005020
MOC-R4PCC04U05:642072:642283 [3] NCCL INFO Channel 00/0 : 3[3] -> 6[2] [send] via NET/Socket/0
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy send connection 3 from local rank 3, transport 2
MOC-R4PCC04U05:642072:642283 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005098
MOC-R4PCC04U05:642072:642283 [3] NCCL INFO Channel 02/0 : 3[3] -> 6[2] [send] via NET/Socket/0
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy recv connection 4 from local rank 0, transport 0
MOC-R4PCC04U05:642069:642284 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c005110
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy recv connection 5 from local rank 0, transport 0
MOC-R4PCC04U05:642069:642284 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c005188
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy recv connection 4 from local rank 3, transport 2
MOC-R4PCC04U05:642072:642283 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005110
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy recv connection 6 from local rank 0, transport 0
MOC-R4PCC04U05:642069:642284 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c005200
MOC-R4PCC04U05:642072:642283 [3] NCCL INFO Channel 01/0 : 14[2] -> 3[3] [receive] via NET/Socket/0
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy recv connection 5 from local rank 3, transport 2
MOC-R4PCC04U05:642072:642283 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005188
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy recv connection 7 from local rank 0, transport 0
MOC-R4PCC04U05:642069:642284 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c005278
MOC-R4PCC04U05:642072:642283 [3] NCCL INFO Channel 03/0 : 14[2] -> 3[3] [receive] via NET/Socket/0
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy recv connection 2 from local rank 2, transport 2
MOC-R4PCC04U05:642071:642282 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f04005020
MOC-R4PCC04U05:642071:642282 [2] NCCL INFO Channel 00/0 : 15[3] -> 2[2] [receive] via NET/Socket/0
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy recv connection 3 from local rank 2, transport 2
MOC-R4PCC04U05:642071:642282 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f04005098
MOC-R4PCC04U05:642071:642282 [2] NCCL INFO Channel 02/0 : 15[3] -> 2[2] [receive] via NET/Socket/0
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy send connection 4 from local rank 2, transport 2
MOC-R4PCC04U05:642071:642282 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f04005110
MOC-R4PCC04U05:642071:642282 [2] NCCL INFO Channel 01/0 : 2[2] -> 7[3] [send] via NET/Socket/0
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy send connection 5 from local rank 2, transport 2
MOC-R4PCC04U05:642071:642282 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f04005188
MOC-R4PCC04U05:642071:642282 [2] NCCL INFO Channel 03/0 : 2[2] -> 7[3] [send] via NET/Socket/0
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy send connection 6 from local rank 3, transport 0
MOC-R4PCC04U05:642072:642283 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005200
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy send connection 7 from local rank 3, transport 0
MOC-R4PCC04U05:642072:642283 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005278
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy recv connection 2 from local rank 1, transport 0
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy send connection 8 from local rank 3, transport 0
MOC-R4PCC04U05:642070:642281 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60005020
MOC-R4PCC04U05:642072:642283 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c0052f0
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy recv connection 3 from local rank 1, transport 0
MOC-R4PCC04U05:642070:642281 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60005098
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy send connection 6 from local rank 2, transport 0
MOC-R4PCC04U05:642071:642282 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f04005200
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy send connection 4 from local rank 1, transport 0
MOC-R4PCC04U05:642070:642281 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60005110
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy send connection 5 from local rank 1, transport 0
MOC-R4PCC04U05:642070:642281 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60005188
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy send connection 7 from local rank 2, transport 0
MOC-R4PCC04U05:642071:642282 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f04005278
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy send connection 6 from local rank 1, transport 0
MOC-R4PCC04U05:642070:642281 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60005200
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy send connection 7 from local rank 1, transport 0
MOC-R4PCC04U05:642070:642281 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60005278
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy send connection 9 from local rank 2, transport 0
MOC-R4PCC04U05:642071:642282 [2] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c005368
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy send connection 8 from local rank 0, transport 0
MOC-R4PCC04U05:642069:642284 [0] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f040052f0
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy send connection 8 from local rank 3, transport 0
MOC-R4PCC04U05:642072:642283 [3] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a600052f0
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy send connection 8 from local rank 1, transport 0
MOC-R4PCC04U05:642070:642281 [1] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe6780052f0
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy send connection 9 from local rank 2, transport 0
MOC-R4PCC04U05:642071:642282 [2] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60005368
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy send connection 9 from local rank 0, transport 0
MOC-R4PCC04U05:642069:642284 [0] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005368
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy send connection 10 from local rank 1, transport 0
MOC-R4PCC04U05:642070:642281 [1] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c0053e0
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy send connection 10 from local rank 0, transport 0
MOC-R4PCC04U05:642069:642284 [0] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a600053e0
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy send connection 9 from local rank 1, transport 0
MOC-R4PCC04U05:642070:642281 [1] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f04005368
num decayed parameter tensors: 50, with 124,318,464 parameters
num non-decayed parameter tensors: 98, with 121,344 parameters
using fused AdamW: False
using regular AdamW
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy send connection 11 from local rank 0, transport 0
MOC-R4PCC04U05:642069:643038 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c005458
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy send connection 12 from local rank 0, transport 0
MOC-R4PCC04U05:642069:643038 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c0054d0
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy send connection 13 from local rank 0, transport 0
MOC-R4PCC04U05:642069:643038 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c005548
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy send connection 14 from local rank 0, transport 0
MOC-R4PCC04U05:642069:643038 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c0055c0
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy recv connection 11 from local rank 1, transport 0
MOC-R4PCC04U05:642070:643039 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60005458
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy recv connection 12 from local rank 1, transport 0
MOC-R4PCC04U05:642070:643039 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a600054d0
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy recv connection 13 from local rank 1, transport 0
MOC-R4PCC04U05:642070:643039 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60005548
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy recv connection 14 from local rank 1, transport 0
MOC-R4PCC04U05:642070:643039 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a600055c0
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy send connection 15 from local rank 1, transport 0
MOC-R4PCC04U05:642070:643039 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60005638
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy send connection 16 from local rank 1, transport 0
MOC-R4PCC04U05:642070:643039 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a600056b0
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy send connection 17 from local rank 1, transport 0
MOC-R4PCC04U05:642070:643039 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60005728
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy send connection 18 from local rank 1, transport 0
MOC-R4PCC04U05:642070:643039 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a600057a0
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy send connection 15 from local rank 0, transport 0
MOC-R4PCC04U05:642069:643038 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c005638
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy send connection 16 from local rank 0, transport 0
MOC-R4PCC04U05:642069:643038 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c0056b0
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy recv connection 10 from local rank 2, transport 0
MOC-R4PCC04U05:642071:643040 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f040053e0
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy recv connection 11 from local rank 2, transport 0
MOC-R4PCC04U05:642071:643040 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f04005458
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy recv connection 12 from local rank 2, transport 0
MOC-R4PCC04U05:642071:643040 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f040054d0
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy recv connection 13 from local rank 2, transport 0
MOC-R4PCC04U05:642071:643040 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f04005548
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy send connection 14 from local rank 2, transport 0
MOC-R4PCC04U05:642071:643040 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f040055c0
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy recv connection 19 from local rank 1, transport 0
MOC-R4PCC04U05:642070:643039 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60005818
MOC-R4PCC04U05:642071:642242 [2] NCCL INFO New proxy send connection 15 from local rank 2, transport 0
MOC-R4PCC04U05:642071:643040 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x7f2f04005638
MOC-R4PCC04U05:642070:642244 [1] NCCL INFO New proxy recv connection 20 from local rank 1, transport 0
MOC-R4PCC04U05:642070:643039 [1] NCCL INFO Connected to proxy localRank 1 -> connection 0x7f8a60005890
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy recv connection 10 from local rank 3, transport 0
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe6780053e0
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy recv connection 11 from local rank 3, transport 0
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005458
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy send connection 12 from local rank 3, transport 2
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe6780054d0
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Channel 02/0 : 3[3] -> 7[3] [send] via NET/Socket/0
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy send connection 13 from local rank 3, transport 2
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005548
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Channel 03/0 : 3[3] -> 7[3] [send] via NET/Socket/0
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy recv connection 17 from local rank 0, transport 0
MOC-R4PCC04U05:642069:643038 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c005728
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy recv connection 14 from local rank 3, transport 2
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe6780055c0
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy recv connection 18 from local rank 0, transport 0
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Channel 00/0 : 11[3] -> 3[3] [receive] via NET/Socket/0
MOC-R4PCC04U05:642069:643038 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c0057a0
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy recv connection 15 from local rank 3, transport 2
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005638
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy recv connection 19 from local rank 0, transport 0
MOC-R4PCC04U05:642069:643038 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c005818
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Channel 01/0 : 11[3] -> 3[3] [receive] via NET/Socket/0
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy send connection 16 from local rank 3, transport 2
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe6780056b0
MOC-R4PCC04U05:642069:642243 [0] NCCL INFO New proxy recv connection 20 from local rank 0, transport 0
MOC-R4PCC04U05:642069:643038 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x7fdf4c005890
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Channel 00/0 : 3[3] -> 11[3] [send] via NET/Socket/0
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy send connection 17 from local rank 3, transport 2
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005728
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Channel 01/0 : 3[3] -> 11[3] [send] via NET/Socket/0
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy recv connection 18 from local rank 3, transport 2
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe6780057a0
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Channel 02/0 : 7[3] -> 3[3] [receive] via NET/Socket/0
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy recv connection 19 from local rank 3, transport 2
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005818
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Channel 03/0 : 7[3] -> 3[3] [receive] via NET/Socket/0
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy send connection 20 from local rank 3, transport 0
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005890
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy send connection 21 from local rank 3, transport 0
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005908
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy send connection 22 from local rank 3, transport 0
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe678005980
MOC-R4PCC04U05:642072:642241 [3] NCCL INFO New proxy send connection 23 from local rank 3, transport 0
MOC-R4PCC04U05:642072:643041 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x7fe6780059f8
step    1/10 | train loss 11.010080 | norm 15.3560 | lr 1.00e-04 | (15012.54 ms | 279387 tok/s)
step    2/10 | train loss 10.138498 | norm 5.7509 | lr 1.00e-04 | (740.56 ms | 5663725 tok/s)
step    3/10 | train loss 9.798905 | norm 2.6008 | lr 1.00e-04 | (729.00 ms | 5753508 tok/s)
step    4/10 | train loss 9.629969 | norm 2.1074 | lr 1.00e-04 | (728.04 ms | 5761109 tok/s)
step    5/10 | train loss 9.547398 | norm 2.1023 | lr 1.00e-04 | (730.97 ms | 5738032 tok/s)
step    6/10 | train loss 9.467024 | norm 1.9934 | lr 1.00e-04 | (945.74 ms | 4434923 tok/s)
step    7/10 | train loss 9.382396 | norm 1.9432 | lr 1.00e-04 | (731.09 ms | 5737070 tok/s)
step    8/10 | train loss 9.291874 | norm 1.9119 | lr 1.00e-04 | (738.50 ms | 5679473 tok/s)
step    9/10 | train loss 9.197285 | norm 1.8625 | lr 1.00e-04 | (736.31 ms | 5696357 tok/s)
step   10/10 | train loss 9.110220 | norm 1.7873 | lr 1.00e-04 | (756.39 ms | 5545162 tok/s)
final 9 iters avg: 759.622ms
peak memory consumption: 16601 MiB
